1 1 public final class ActiveInactiveColors @ColorInt
1 1 private final int activeColor @ColorInt
1 1 private final int inactiveColor
1 1 private ActiveInactiveColors @ColorInt int activeColor @ColorInt int inactiveColor this activeColor activeColor this inactiveColor inactiveColor
1 1 public static ActiveInactiveColors create @ColorInt int activeColor @ColorInt int inactiveColor return new ActiveInactiveColors activeColor inactiveColor @ColorInt
1 1 public int activeColor return activeColor @ColorInt
1 1 public int inactiveColor return inactiveColor
1 1 public ColorStateList toEnabledSl return new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled new int activeColor
1 2 public class Aesthetic
1 2 private static final String PREFS_NAME aesthetic prefs
1 2 private static final String KEY_FIRST_TIME first_time
1 2 private static final String KEY_ACTIVITY_THEME activity_theme_ s
1 2 private static final String KEY_IS_DARK is_dark
1 2 private static final String KEY_PRIMARY_COLOR primary_color
1 2 private static final String KEY_PRIMARY_DARK_COLOR primary_dark_color
1 2 private static final String KEY_ACCENT_COLOR accent_color
1 2 private static final String KEY_PRIMARY_TEXT_COLOR primary_text
1 2 private static final String KEY_SECONDARY_TEXT_COLOR secondary_text
1 2 private static final String KEY_PRIMARY_TEXT_INVERSE_COLOR primary_text_inverse
1 2 private static final String KEY_SECONDARY_TEXT_INVERSE_COLOR secondary_text_inverse
1 2 private static final String KEY_WINDOW_BG_COLOR window_bg_color
1 2 private static final String KEY_STATUS_BAR_COLOR status_bar_color_ s
1 2 private static final String KEY_NAV_BAR_COLOR nav_bar_color_ S
1 2 private static final String KEY_LIGHT_STATUS_MODE light_status_mode
1 2 private static final String KEY_TAB_LAYOUT_BG_MODE tab_layout_bg_mode
1 2 private static final String KEY_TAB_LAYOUT_INDICATOR_MODE tab_layout_indicator_mode
1 2 private static final String KEY_NAV_VIEW_MODE nav_view_mode
1 2 private static final String KEY_BOTTOM_NAV_BG_MODE bottom_nav_bg_mode
1 2 private static final String KEY_BOTTOM_NAV_ICONTEXT_MODE bottom_nav_icontext_mode
1 2 private static final String KEY_CARD_VIEW_BG_COLOR card_view_bg_color
1 2 private static final String KEY_ICON_TITLE_ACTIVE_COLOR icon_title_active_color
1 2 private static final String KEY_ICON_TITLE_INACTIVE_COLOR icon_title_inactive_color
1 2 private static final String KEY_SNACKBAR_TEXT snackbar_text_color
1 2 private static final String KEY_SNACKBAR_ACTION_TEXT snackbar_action_text_color @SuppressLint StaticFieldLeak
1 2 private static Aesthetic instance
1 2 private final ArrayMap String List ViewObservablePair backgroundSubscriberViews
1 2 private final ArrayMap String Integer lastActivityThemes
1 2 private CompositeDisposable backgroundSubscriptions
1 2 private CompositeDisposable subs
1 2 private AppCompatActivity context
1 2 private SharedPreferences prefs
1 2 private SharedPreferences Editor editor
1 2 private RxSharedPreferences rxPrefs
1 2 private boolean isResumed @SuppressLint CommitPrefEdits
1 2 private Aesthetic AppCompatActivity context this context context prefs context getApplicationContext getSharedPreferences PREFS_NAME Context MODE_PRIVATE editor prefs edit rxPrefs RxSharedPreferences create prefs backgroundSubscriberViews new ArrayMap 0 lastActivityThemes new ArrayMap 2
1 2 private static String key @Nullable AppCompatActivity activity String key if activity instanceof AestheticKeyProvider key AestheticKeyProvider activity key else key default if key null key default return key @NonNull
1 2 public static Aesthetic attach @NonNull AppCompatActivity activity if instance null instance new Aesthetic activity instance isResumed false instance context activity LayoutInflater li activity getLayoutInflater Util setInflaterFactory li activity String activityThemeKey String format KEY_ACTIVITY_THEME key activity int latestActivityTheme instance prefs getInt activityThemeKey 0 instance lastActivityThemes put instance context getClass getName latestActivityTheme if latestActivityTheme 0 activity setTheme latestActivityTheme return instance
1 2 private static int getLastActivityTheme @Nullable Context forContext if forContext null instance null return 0 Integer lastActivityTheme instance lastActivityThemes get forContext getClass getName if lastActivityTheme null return 0 return lastActivityTheme @NonNull @CheckResult
1 2 public static Aesthetic get if instance null throw new IllegalStateException Not attached return instance
1 2 public static void pause @NonNull AppCompatActivity activity if instance null return instance isResumed false if instance subs null instance subs clear if instance backgroundSubscriptions null instance backgroundSubscriptions clear if activity isFinishing instance backgroundSubscriberViews remove activity getClass getName if instance context null instance context getClass getName equals activity getClass getName instance context null
1 2 public static void resume @NonNull AppCompatActivity activity if instance null return instance context activity instance isResumed true if instance subs null instance subs clear instance subs new CompositeDisposable subscribeBackgroundListeners instance subs add instance colorPrimary compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 2 public void accept @io reactivex annotations NonNull Integer color Util setTaskDescriptionColor instance context color onErrorLogAndRethrow instance subs add instance activityTheme compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 2 public void accept @io reactivex annotations NonNull Integer themeId if getLastActivityTheme instance context themeId return instance lastActivityThemes put instance context getClass getName themeId instance context recreate onErrorLogAndRethrow instance subs add Observable combineLatest instance colorStatusBar instance lightStatusBarMode new BiFunction Integer Integer Pair Integer Integer @Override
1 2 public Pair Integer Integer apply Integer integer Integer integer2 return Pair create integer integer2 compose Rx Pair Integer Integer distinctToMainThread subscribe new Consumer Pair Integer Integer @Override
1 2 public void accept @io reactivex annotations NonNull Pair Integer Integer result instance invalidateStatusBar onErrorLogAndRethrow instance subs add instance colorNavigationBar compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 2 public void accept @io reactivex annotations NonNull Integer color setNavBarColorCompat instance context color onErrorLogAndRethrow instance subs add instance colorWindowBackground compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 2 public void accept @io reactivex annotations NonNull Integer color instance context getWindow setBackgroundDrawable new ColorDrawable color onErrorLogAndRethrow
1 2 public static boolean isFirstTime boolean firstTime instance prefs getBoolean KEY_FIRST_TIME true instance editor putBoolean KEY_FIRST_TIME false commit return firstTime
1 2 private static void subscribeBackgroundListeners if instance backgroundSubscriptions null instance backgroundSubscriptions clear instance backgroundSubscriptions new CompositeDisposable if instance backgroundSubscriberViews size 0 List ViewObservablePair pairs instance backgroundSubscriberViews get instance context getClass getName if pairs null for ViewObservablePair pair pairs instance backgroundSubscriptions add pair observable compose Rx Integer distinctToMainThread subscribeWith ViewBackgroundSubscriber create pair view void addBackgroundSubscriber @NonNull View view @NonNull Observable Integer colorObservable List ViewObservablePair subscribers backgroundSubscriberViews get instance context getClass getName if subscribers null subscribers new ArrayList 1 backgroundSubscriberViews put instance context getClass getName subscribers subscribers add ViewObservablePair create view colorObservable if isResumed instance backgroundSubscriptions add colorObservable compose Rx Integer distinctToMainThread subscribeWith ViewBackgroundSubscriber create view
1 2 private void invalidateStatusBar String key String format KEY_STATUS_BAR_COLOR key context final int color prefs getInt key resolveColor context R attr colorPrimaryDark ViewGroup rootView Util getRootView context if rootView instanceof DrawerLayout setLightStatusBarCompat context false Util setStatusBarColorCompat context ContextCompat getColor context android R color transparent DrawerLayout rootView setStatusBarBackgroundColor color else Util setStatusBarColorCompat context color final int mode prefs getInt KEY_LIGHT_STATUS_MODE AutoSwitchMode AUTO switch mode case AutoSwitchMode OFF setLightStatusBarCompat context false break case AutoSwitchMode ON setLightStatusBarCompat context true break default setLightStatusBarCompat context isColorLight color break @CheckResult
1 2 public Aesthetic activityTheme @StyleRes int theme String key String format KEY_ACTIVITY_THEME key context editor putInt key theme return this @CheckResult
1 2 public Observable Integer activityTheme String key String format KEY_ACTIVITY_THEME key context return rxPrefs getInteger key 0 asObservable filter new Predicate Integer @Override
1 2 public boolean test @io reactivex annotations NonNull Integer next throws Exception return next 0 next getLastActivityTheme instance context @CheckResult
1 2 public Aesthetic isDark boolean isDark editor putBoolean KEY_IS_DARK isDark commit return this @CheckResult
1 2 public Observable Boolean isDark return rxPrefs getBoolean KEY_IS_DARK false asObservable @CheckResult
1 2 public Aesthetic colorPrimary @ColorInt int color editor putInt KEY_PRIMARY_COLOR color commit return this @CheckResult
1 2 public Aesthetic colorPrimaryRes @ColorRes int color return colorPrimary ContextCompat getColor context color @CheckResult
1 2 public Observable Integer colorPrimary return rxPrefs getInteger KEY_PRIMARY_COLOR resolveColor context R attr colorPrimary asObservable @CheckResult
1 2 public Aesthetic colorPrimaryDark @ColorInt int color editor putInt KEY_PRIMARY_DARK_COLOR color commit return this @CheckResult
1 2 public Aesthetic colorPrimaryDarkRes @ColorRes int color return colorPrimaryDark ContextCompat getColor context color @CheckResult
1 2 public Observable Integer colorPrimaryDark return rxPrefs getInteger KEY_PRIMARY_DARK_COLOR resolveColor context R attr colorPrimaryDark asObservable @CheckResult
1 2 public Aesthetic colorAccent @ColorInt int color editor putInt KEY_ACCENT_COLOR color commit return this @CheckResult
1 2 public Aesthetic colorAccentRes @ColorRes int color return colorAccent ContextCompat getColor context color @CheckResult
1 2 public Observable Integer colorAccent return rxPrefs getInteger KEY_ACCENT_COLOR resolveColor context R attr colorAccent asObservable @CheckResult
1 2 public Aesthetic textColorPrimary @ColorInt int color editor putInt KEY_PRIMARY_TEXT_COLOR color return this @CheckResult
1 2 public Aesthetic textColorPrimaryRes @ColorRes int color return textColorPrimary ContextCompat getColor context color @CheckResult
1 2 public Observable Integer textColorPrimary return rxPrefs getInteger KEY_PRIMARY_TEXT_COLOR resolveColor context android R attr textColorPrimary asObservable @CheckResult
1 2 public Aesthetic textColorSecondary @ColorInt int color editor putInt KEY_SECONDARY_TEXT_COLOR color return this @CheckResult
1 2 public Aesthetic textColorSecondaryRes @ColorRes int color return textColorSecondary ContextCompat getColor context color @CheckResult
1 2 public Observable Integer textColorSecondary return rxPrefs getInteger KEY_SECONDARY_TEXT_COLOR resolveColor context android R attr textColorSecondary asObservable @CheckResult
1 2 public Aesthetic textColorPrimaryInverse @ColorInt int color editor putInt KEY_PRIMARY_TEXT_INVERSE_COLOR color return this @CheckResult
1 2 public Aesthetic textColorPrimaryInverseRes @ColorRes int color return textColorPrimaryInverse ContextCompat getColor context color @CheckResult
1 2 public Observable Integer textColorPrimaryInverse return rxPrefs getInteger KEY_PRIMARY_TEXT_INVERSE_COLOR resolveColor context android R attr textColorPrimaryInverse asObservable @CheckResult
1 2 public Aesthetic textColorSecondaryInverse @ColorInt int color editor putInt KEY_SECONDARY_TEXT_INVERSE_COLOR color return this @CheckResult
1 2 public Aesthetic textColorSecondaryInverseRes @ColorRes int color return textColorSecondaryInverse ContextCompat getColor context color @CheckResult
1 2 public Observable Integer textColorSecondaryInverse return rxPrefs getInteger KEY_SECONDARY_TEXT_INVERSE_COLOR resolveColor context android R attr textColorSecondaryInverse asObservable @CheckResult
1 2 public Aesthetic colorWindowBackground @ColorInt int color editor putInt KEY_WINDOW_BG_COLOR color commit return this @CheckResult
1 2 public Aesthetic colorWindowBackgroundRes @ColorRes int color return colorWindowBackground ContextCompat getColor context color @CheckResult
1 2 public Observable Integer colorWindowBackground return rxPrefs getInteger KEY_WINDOW_BG_COLOR resolveColor context android R attr windowBackground asObservable @CheckResult
1 2 public Aesthetic colorStatusBar @ColorInt int color String key String format KEY_STATUS_BAR_COLOR key context editor putInt key color return this @CheckResult
1 2 public Aesthetic colorStatusBarRes @ColorRes int color return colorStatusBar ContextCompat getColor context color @CheckResult
1 2 public Aesthetic colorStatusBarAuto String key String format KEY_STATUS_BAR_COLOR key context editor putInt key Util darkenColor prefs getInt KEY_PRIMARY_COLOR resolveColor context R attr colorPrimary return this @CheckResult
1 2 public Observable Integer colorStatusBar return colorPrimaryDark flatMap new Function Integer ObservableSource Integer @Override
1 2 public ObservableSource Integer apply @io reactivex annotations NonNull Integer primaryDarkColor throws Exception String key String format KEY_STATUS_BAR_COLOR key context return rxPrefs getInteger key primaryDarkColor asObservable @CheckResult
1 2 public Aesthetic colorNavigationBar @ColorInt int color String key String format KEY_NAV_BAR_COLOR key context editor putInt key color return this @CheckResult
1 2 public Aesthetic colorNavigationBarRes @ColorRes int color return colorNavigationBar ContextCompat getColor context color @CheckResult
1 2 public Aesthetic colorNavigationBarAuto int color prefs getInt KEY_PRIMARY_COLOR resolveColor context R attr colorPrimary String key String format KEY_NAV_BAR_COLOR key context editor putInt key isColorLight color Color BLACK color return this @CheckResult
1 2 public Observable Integer colorNavigationBar String key String format KEY_NAV_BAR_COLOR key context return rxPrefs getInteger key Color BLACK asObservable @CheckResult
1 2 public Aesthetic lightStatusBarMode @AutoSwitchMode int mode editor putInt KEY_LIGHT_STATUS_MODE mode return this @CheckResult
1 2 public Observable Integer lightStatusBarMode return rxPrefs getInteger KEY_LIGHT_STATUS_MODE AutoSwitchMode AUTO asObservable @CheckResult
1 2 public Aesthetic tabLayoutIndicatorMode @TabLayoutIndicatorMode int mode editor putInt KEY_TAB_LAYOUT_INDICATOR_MODE mode commit return this @CheckResult
1 2 public Observable Integer tabLayoutIndicatorMode return rxPrefs getInteger KEY_TAB_LAYOUT_INDICATOR_MODE TabLayoutIndicatorMode ACCENT asObservable @CheckResult
1 2 public Aesthetic tabLayoutBackgroundMode @TabLayoutBgMode int mode editor putInt KEY_TAB_LAYOUT_BG_MODE mode commit return this @CheckResult
1 2 public Observable Integer tabLayoutBackgroundMode return rxPrefs getInteger KEY_TAB_LAYOUT_BG_MODE TabLayoutBgMode PRIMARY asObservable @CheckResult
1 2 public Aesthetic navigationViewMode @NavigationViewMode int mode editor putInt KEY_NAV_VIEW_MODE mode commit return this @CheckResult
1 2 public Observable Integer navigationViewMode return rxPrefs getInteger KEY_NAV_VIEW_MODE NavigationViewMode SELECTED_PRIMARY asObservable @CheckResult
1 2 public Aesthetic bottomNavigationBackgroundMode @BottomNavBgMode int mode editor putInt KEY_BOTTOM_NAV_BG_MODE mode commit return this @CheckResult
1 2 public Observable Integer bottomNavigationBackgroundMode return rxPrefs getInteger KEY_BOTTOM_NAV_BG_MODE BottomNavBgMode BLACK_WHITE_AUTO asObservable @CheckResult
1 2 public Aesthetic bottomNavigationIconTextMode @BottomNavIconTextMode int mode editor putInt KEY_BOTTOM_NAV_ICONTEXT_MODE mode commit return this @CheckResult
1 2 public Observable Integer bottomNavigationIconTextMode return rxPrefs getInteger KEY_BOTTOM_NAV_ICONTEXT_MODE BottomNavIconTextMode SELECTED_ACCENT asObservable @CheckResult
1 2 public Observable Integer colorCardViewBackground return isDark flatMap new Function Boolean ObservableSource Integer @Override
1 2 public ObservableSource Integer apply @io reactivex annotations NonNull Boolean isDark throws Exception return rxPrefs getInteger KEY_CARD_VIEW_BG_COLOR ContextCompat getColor context isDark R color ate_cardview_bg_dark R color ate_cardview_bg_light asObservable @CheckResult
1 2 public Aesthetic colorCardViewBackground @ColorInt int color editor putInt KEY_CARD_VIEW_BG_COLOR color return this @CheckResult
1 2 public Aesthetic colorCardViewBackgroundRes @ColorRes int color return colorCardViewBackground ContextCompat getColor context color @CheckResult
1 2 public Observable ActiveInactiveColors colorIconTitle @Nullable Observable Integer backgroundObservable if backgroundObservable null backgroundObservable Aesthetic get colorPrimary return backgroundObservable flatMap new Function Integer ObservableSource ActiveInactiveColors @Override
1 2 public ObservableSource ActiveInactiveColors apply @io reactivex annotations NonNull Integer primaryColor throws Exception final boolean isDark isColorLight primaryColor return Observable zip rxPrefs getInteger KEY_ICON_TITLE_ACTIVE_COLOR ContextCompat getColor context isDark R color ate_icon_dark R color ate_icon_light asObservable rxPrefs getInteger KEY_ICON_TITLE_INACTIVE_COLOR ContextCompat getColor context isDark R color ate_icon_dark_inactive R color ate_icon_light_inactive asObservable new BiFunction Integer Integer ActiveInactiveColors @Override
1 2 public ActiveInactiveColors apply @io reactivex annotations NonNull Integer integer @io reactivex annotations NonNull Integer integer2 throws Exception return ActiveInactiveColors create integer integer2 @CheckResult
1 2 public Aesthetic colorIconTitleActive @ColorInt int color editor putInt KEY_ICON_TITLE_ACTIVE_COLOR color return this @CheckResult
1 2 public Aesthetic colorIconTitleActiveRes @ColorRes int color return colorIconTitleActive ContextCompat getColor context color @CheckResult
1 2 public Aesthetic colorIconTitleInactive @ColorInt int color editor putInt KEY_ICON_TITLE_INACTIVE_COLOR color return this @CheckResult
1 2 public Aesthetic colorIconTitleInactiveRes @ColorRes int color return colorIconTitleActive ContextCompat getColor context color @CheckResult
1 2 public Observable Integer snackbarTextColor return isDark flatMap new Function Boolean ObservableSource Integer @Override
1 2 public ObservableSource Integer apply @io reactivex annotations NonNull Boolean isDark throws Exception return isDark textColorPrimary textColorPrimaryInverse flatMap new Function Integer ObservableSource Integer @Override
1 2 public ObservableSource Integer apply @io reactivex annotations NonNull Integer defaultTextColor throws Exception return rxPrefs getInteger KEY_SNACKBAR_TEXT defaultTextColor asObservable @CheckResult
1 2 public Aesthetic snackbarTextColor @ColorInt int color editor putInt KEY_SNACKBAR_TEXT color return this @CheckResult
1 2 public Aesthetic snackbarTextColorRes @ColorRes int color return colorCardViewBackground ContextCompat getColor context color @CheckResult
1 2 public Observable Integer snackbarActionTextColor return colorAccent flatMap new Function Integer ObservableSource Integer @Override
1 2 public ObservableSource Integer apply @io reactivex annotations NonNull Integer accentColor throws Exception return rxPrefs getInteger KEY_SNACKBAR_ACTION_TEXT accentColor asObservable @CheckResult
1 2 public Aesthetic snackbarActionTextColor @ColorInt int color editor putInt KEY_SNACKBAR_ACTION_TEXT color return this @CheckResult
1 2 public Aesthetic snackbarActionTextColorRes @ColorRes int color return colorCardViewBackground ContextCompat getColor context color
1 2 public void apply editor
1 3 private Drawable icon
1 3 private Disposable subscription
1 3 public AestheticActionMenuItemView Context context super context
1 3 public AestheticActionMenuItemView Context context AttributeSet attrs super context attrs
1 3 public AestheticActionMenuItemView Context context AttributeSet attrs int defStyle super context attrs defStyle @Override
1 3 public void setIcon final Drawable icon super setIcon icon Aesthetic get colorIconTitle null observeOn AndroidSchedulers mainThread take 1 subscribe new Consumer ActiveInactiveColors @Override
1 3 public void accept @NonNull ActiveInactiveColors colors setIcon icon colors toEnabledSl onErrorLogAndRethrow
1 3 public void setIcon final Drawable icon ColorStateList colors this icon icon super setIcon createTintedDrawable icon colors @Override
1 3 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorIconTitle null compose Rx ActiveInactiveColors distinctToMainThread subscribe new Consumer ActiveInactiveColors @Override
1 3 public void accept @NonNull ActiveInactiveColors colors if icon null setIcon icon colors toEnabledSl onErrorLogAndRethrow @Override
1 3 protected void onDetachedFromWindow subscription dispose super
1 4 public class AestheticActivity extends AppCompatActivity implements AestheticKeyProvider @Override
1 4 protected void onCreate @Nullable Bundle savedInstanceState Aesthetic attach this super onCreate savedInstanceState @Override
1 4 protected void onResume super onResume Aesthetic resume this @Override
1 4 protected void onPause Aesthetic pause this super onPause @Nullable @Override
1 4 public String key return
1 5 public class AestheticBottomNavigationView extends BottomNavigationView
1 5 private Disposable modesSubscription
1 5 private CompositeDisposable colorSubscriptions
1 5 private int lastTextIconColor
1 5 public AestheticBottomNavigationView Context context super context
1 5 public AestheticBottomNavigationView Context context AttributeSet attrs super context attrs
1 5 public AestheticBottomNavigationView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 5 private void invalidateIconTextColor int backgroundColor int selectedColor int baseColor ContextCompat getColor getContext Util isColorLight backgroundColor R color ate_icon_light R color ate_icon_dark int unselectedIconTextColor Util adjustAlpha baseColor 87f ColorStateList iconColor new ColorStateList new int new int android R attr state_checked new int android R attr state_checked new int unselectedIconTextColor selectedColor ColorStateList textColor new ColorStateList new int new int android R attr state_checked new int android R attr state_checked new int unselectedIconTextColor selectedColor setItemIconTintList iconColor setItemTextColor textColor @Override
1 5 public void setBackgroundColor @ColorInt int color super setBackgroundColor color if lastTextIconColor Color TRANSPARENT lastTextIconColor Util isColorLight color Color BLACK Color WHITE invalidateIconTextColor color lastTextIconColor
1 5 private void onState State state if colorSubscriptions null colorSubscriptions clear colorSubscriptions new CompositeDisposable switch state iconTextMode case BottomNavIconTextMode SELECTED_PRIMARY colorSubscriptions add Aesthetic get colorPrimary compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 5 public void accept @NonNull Integer color lastTextIconColor color onErrorLogAndRethrow break case BottomNavIconTextMode SELECTED_ACCENT colorSubscriptions add Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 5 public void accept @NonNull Integer color lastTextIconColor color onErrorLogAndRethrow break case BottomNavIconTextMode BLACK_WHITE_AUTO lastTextIconColor Color TRANSPARENT break default throw new IllegalStateException Unknown bottom nav icon text mode state iconTextMode switch state bgMode case BottomNavBgMode PRIMARY colorSubscriptions add Aesthetic get colorPrimary compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create this onErrorLogAndRethrow break case BottomNavBgMode PRIMARY_DARK colorSubscriptions add Aesthetic get colorStatusBar compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create this onErrorLogAndRethrow break case BottomNavBgMode ACCENT colorSubscriptions add Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create this onErrorLogAndRethrow break case BottomNavBgMode BLACK_WHITE_AUTO setBackgroundColor ContextCompat getColor getContext state isDark R color ate_bottom_nav_default_dark_bg R color ate_bottom_nav_default_light_bg break default throw new IllegalStateException Unknown bottom nav bg mode state bgMode @Override
1 5 protected void onAttachedToWindow super onAttachedToWindow modesSubscription Observable combineLatest Aesthetic get bottomNavigationBackgroundMode Aesthetic get bottomNavigationIconTextMode Aesthetic get isDark State creator compose Rx State distinctToMainThread subscribe new Consumer State @Override
1 5 public void accept @android support annotation NonNull State state onState state onErrorLogAndRethrow @Override
1 5 protected void onDetachedFromWindow modesSubscription dispose colorSubscriptions clear super onDetachedFromWindow
1 5 private static class State @BottomNavBgMode
1 5 private final int bgMode @BottomNavIconTextMode
1 5 private final int iconTextMode
1 5 private final boolean isDark
1 5 private State int bgMode int iconTextMode boolean isDark this bgMode bgMode this iconTextMode iconTextMode this isDark isDark static State create @BottomNavBgMode int bgMode @BottomNavIconTextMode int iconTextMode boolean isDark return new State bgMode iconTextMode isDark static Function3 Integer Integer Boolean State creator return new Function3 Integer Integer Boolean State @Override
1 5 public State apply Integer integer Integer integer2 Boolean aBoolean return State create integer integer2
1 6 public class AestheticButton extends AppCompatButton
1 6 private Disposable subscription
1 6 private int backgroundResId
1 6 public AestheticButton Context context super context
1 6 public AestheticButton Context context AttributeSet attrs super context attrs init context attrs
1 6 public AestheticButton Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 6 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 6 private void invalidateColors ColorIsDarkState state TintHelper setTintAuto this state color true state isDark ColorStateList textColorSl new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled new int Util isColorLight state color Color BLACK Color WHITE state isDark Color WHITE Color BLACK setTextColor textColorSl @Override
1 6 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 6 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 6 protected void onDetachedFromWindow subscription dispose super
1 7 public class AestheticCardView extends CardView
1 7 private Disposable bgSubscription
1 7 private int backgroundResId
1 7 public AestheticCardView Context context super context
1 7 public AestheticCardView Context context @Nullable AttributeSet attrs super context attrs init context attrs
1 7 public AestheticCardView Context context @Nullable AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 7 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs R attr cardBackgroundColor @Override
1 7 protected void onAttachedToWindow super onAttachedToWindow Observable Integer obs ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorCardViewBackground bgSubscription obs compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 7 public void accept @NonNull Integer bgColor throws Exception setCardBackgroundColor bgColor onErrorLogAndRethrow @Override
1 7 protected void onDetachedFromWindow if bgSubscription null bgSubscription dispose super
1 8 public class AestheticCheckBox extends AppCompatCheckBox
1 8 private CompositeDisposable subscriptions
1 8 private int backgroundResId
1 8 public AestheticCheckBox Context context super context
1 8 public AestheticCheckBox Context context AttributeSet attrs super context attrs init context attrs
1 8 public AestheticCheckBox Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 8 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 8 private void invalidateColors ColorIsDarkState state TintHelper setTint this state color state isDark @Override
1 8 protected void onAttachedToWindow super onAttachedToWindow subscriptions new CompositeDisposable subscriptions add Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 8 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow subscriptions add Aesthetic get textColorPrimary compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this @Override
1 8 protected void onDetachedFromWindow subscriptions clear super
1 9 public class AestheticCoordinatorLayout extends CoordinatorLayout implements AppBarLayout OnOffsetChangedListener
1 9 private Disposable toolbarColorSubscription
1 9 private Disposable statusBarColorSubscription
1 9 private AppBarLayout appBarLayout
1 9 private View colorView
1 9 private AestheticToolbar toolbar
1 9 private CollapsingToolbarLayout collapsingToolbarLayout
1 9 private int toolbarColor
1 9 private ActiveInactiveColors iconTextColors
1 9 private int lastOffset 1
1 9 public AestheticCoordinatorLayout Context context super context
1 9 public AestheticCoordinatorLayout Context context AttributeSet attrs super context attrs
1 9 public AestheticCoordinatorLayout Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr @SuppressWarnings unchecked
1 9 private static void tintMenu @NonNull AestheticToolbar toolbar @Nullable Menu menu final ActiveInactiveColors colors if toolbar getNavigationIcon null toolbar setNavigationIcon toolbar getNavigationIcon colors activeColor Util setOverflowButtonColor toolbar colors activeColor try final Field field Toolbar class getDeclaredField mCollapseIcon field setAccessible true Drawable collapseIcon Drawable field get toolbar if collapseIcon null field set toolbar TintHelper createTintedDrawable collapseIcon colors toEnabledSl catch Exception e e printStackTrace final PorterDuffColorFilter colorFilter new PorterDuffColorFilter colors activeColor PorterDuff Mode SRC_IN for int i 0 i toolbar getChildCount i final View v toolbar getChildAt i if v instanceof ActionMenuView for int j 0 j ActionMenuView v getChildCount j final View innerView ActionMenuView v getChildAt j if innerView instanceof ActionMenuItemView int drawablesCount ActionMenuItemView innerView getCompoundDrawables length for int k 0 k drawablesCount k if ActionMenuItemView innerView getCompoundDrawables k null ActionMenuItemView innerView getCompoundDrawables k setColorFilter colorFilter if menu null menu toolbar getMenu ViewUtil tintToolbarMenu toolbar menu colors @Override
1 9 public void onAttachedToWindow super onAttachedToWindow if getChildCount 0 getChildAt 0 instanceof AppBarLayout appBarLayout AppBarLayout getChildAt 0 if appBarLayout getChildCount 0 appBarLayout getChildAt 0 instanceof CollapsingToolbarLayout collapsingToolbarLayout CollapsingToolbarLayout appBarLayout getChildAt 0 for int i 0 i collapsingToolbarLayout getChildCount i if this toolbar null this colorView null break View child collapsingToolbarLayout getChildAt i if child instanceof AestheticToolbar this toolbar AestheticToolbar child else if child getBackground null child getBackground instanceof ColorDrawable this colorView child if toolbar null colorView null this appBarLayout addOnOffsetChangedListener this toolbarColorSubscription Observable combineLatest toolbar colorUpdated Aesthetic get colorIconTitle toolbar colorUpdated new BiFunction Integer ActiveInactiveColors Pair Integer ActiveInactiveColors @Override
1 9 public Pair Integer ActiveInactiveColors apply Integer integer ActiveInactiveColors activeInactiveColors return Pair create integer activeInactiveColors compose Rx Pair Integer ActiveInactiveColors distinctToMainThread subscribe new Consumer Pair Integer ActiveInactiveColors @Override
1 9 public void accept @NonNull Pair Integer ActiveInactiveColors result toolbarColor result first iconTextColors result second invalidateColors onErrorLogAndRethrow if collapsingToolbarLayout null statusBarColorSubscription Aesthetic get colorStatusBar compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 9 public void accept @io reactivex annotations NonNull Integer color collapsingToolbarLayout setContentScrimColor color collapsingToolbarLayout setStatusBarScrimColor color onErrorLogAndRethrow @Override
1 9 public void onDetachedFromWindow if toolbarColorSubscription null toolbarColorSubscription dispose if statusBarColorSubscription null statusBarColorSubscription dispose if this appBarLayout null this appBarLayout removeOnOffsetChangedListener this this appBarLayout null this toolbar null this colorView null super onDetachedFromWindow @Override
1 9 public void onOffsetChanged AppBarLayout appBarLayout int verticalOffset if lastOffset Math abs verticalOffset return lastOffset Math abs verticalOffset invalidateColors
1 9 private void invalidateColors if iconTextColors null return final int maxOffset appBarLayout getMeasuredHeight toolbar getMeasuredHeight final float ratio float lastOffset float maxOffset final int colorViewColor ColorDrawable colorView getBackground getColor final int blendedColor Util blendColors colorViewColor toolbarColor ratio final int collapsedTitleColor iconTextColors activeColor final int expandedTitleColor Util isColorLight colorViewColor Color BLACK Color WHITE final int blendedTitleColor Util blendColors expandedTitleColor collapsedTitleColor ratio toolbar setBackgroundColor blendedColor collapsingToolbarLayout setCollapsedTitleTextColor collapsedTitleColor collapsingToolbarLayout setExpandedTitleColor expandedTitleColor tintMenu toolbar toolbar getMenu ActiveInactiveColors create blendedTitleColor Util adjustAlpha blendedColor 0
1 10 private Disposable subscription
1 10 public AestheticDialogButton Context context super context
1 10 public AestheticDialogButton Context context AttributeSet attrs super context attrs
1 10 public AestheticDialogButton Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr @Override
1 10 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this @Override
1 10 protected void onDetachedFromWindow subscription dispose super
1 11 public class AestheticDrawerLayout extends DrawerLayout
1 11 private ActiveInactiveColors lastState
1 11 private DrawerArrowDrawable arrowDrawable
1 11 private Disposable subscription
1 11 public AestheticDrawerLayout Context context super context
1 11 public AestheticDrawerLayout Context context AttributeSet attrs super context attrs
1 11 public AestheticDrawerLayout Context context AttributeSet attrs int defStyle super context attrs defStyle
1 11 private void invalidateColor ActiveInactiveColors colors if colors null return this lastState colors if this arrowDrawable null this arrowDrawable setColor lastState activeColor @Override
1 11 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorIconTitle null compose Rx ActiveInactiveColors distinctToMainThread subscribe new Consumer ActiveInactiveColors @Override
1 11 public void accept @io reactivex annotations NonNull ActiveInactiveColors colors invalidateColor colors onErrorLogAndRethrow @Override
1 11 protected void onDetachedFromWindow subscription dispose super onDetachedFromWindow @Override
1 11 public void addDrawerListener @NonNull DrawerListener listener super addDrawerListener listener if listener instanceof ActionBarDrawerToggle this arrowDrawable ActionBarDrawerToggle listener getDrawerArrowDrawable invalidateColor lastState @SuppressWarnings deprecation @Override
1 11 public void setDrawerListener DrawerListener listener super setDrawerListener listener if listener instanceof ActionBarDrawerToggle this arrowDrawable ActionBarDrawerToggle listener getDrawerArrowDrawable invalidateColor
1 12 public class AestheticEditText extends AppCompatEditText
1 12 private CompositeDisposable subscriptions
1 12 private int backgroundResId
1 12 private int textColorResId
1 12 private int textColorHintResId
1 12 public AestheticEditText Context context super context
1 12 public AestheticEditText Context context AttributeSet attrs super context attrs init context attrs
1 12 public AestheticEditText Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 12 private void init Context context AttributeSet attrs if attrs null int attrsArray new int android R attr background android R attr textColor android R attr textColorHint TypedArray ta context obtainStyledAttributes attrs attrsArray backgroundResId ta getResourceId 0 0 textColorResId ta getResourceId 1 0 textColorHintResId ta getResourceId 2 0 ta recycle
1 12 private void invalidateColors ColorIsDarkState state TintHelper setTintAuto this state color true state isDark TintHelper setCursorTint this state color @SuppressWarnings ConstantConditions @Override
1 12 protected void onAttachedToWindow super onAttachedToWindow subscriptions new CompositeDisposable subscriptions add Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 12 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow subscriptions add ViewUtil getObservableForResId getContext textColorResId Aesthetic get textColorPrimary compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this onErrorLogAndRethrow subscriptions add ViewUtil getObservableForResId getContext textColorHintResId Aesthetic get textColorSecondary compose Rx Integer distinctToMainThread subscribe ViewHintTextColorAction create this onErrorLogAndRethrow @Override
1 12 protected void onDetachedFromWindow subscriptions clear super
1 13 public class AestheticFab extends FloatingActionButton
1 13 private Disposable subscription
1 13 private int backgroundResId
1 13 private int iconColor
1 13 public AestheticFab Context context super context
1 13 public AestheticFab Context context AttributeSet attrs super context attrs init context attrs
1 13 public AestheticFab Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 13 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 13 private void invalidateColors ColorIsDarkState state TintHelper setTintAuto this state color true state isDark iconColor Util isColorLight state color Color BLACK Color WHITE setImageDrawable getDrawable @Override
1 13 public void setImageDrawable @Nullable Drawable drawable super setImageDrawable TintHelper createTintedDrawable drawable iconColor @Override
1 13 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 13 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 13 protected void onDetachedFromWindow subscription dispose super
1 14 public class AestheticImageButton extends AppCompatImageButton
1 14 private Disposable bgSubscription
1 14 private int backgroundResId
1 14 public AestheticImageButton Context context super context
1 14 public AestheticImageButton Context context @Nullable AttributeSet attrs super context attrs init context attrs
1 14 public AestheticImageButton Context context @Nullable AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 14 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background @Override
1 14 protected void onAttachedToWindow super onAttachedToWindow Observable Integer obs ViewUtil getObservableForResId getContext backgroundResId null if obs null bgSubscription obs compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create this onErrorLogAndRethrow @Override
1 14 protected void onDetachedFromWindow if bgSubscription null bgSubscription dispose super
1 15 public class AestheticImageView extends AppCompatImageView
1 15 private Disposable bgSubscription
1 15 private int backgroundResId
1 15 public AestheticImageView Context context super context
1 15 public AestheticImageView Context context @Nullable AttributeSet attrs super context attrs init context attrs
1 15 public AestheticImageView Context context @Nullable AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 15 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background @Override
1 15 protected void onAttachedToWindow super onAttachedToWindow Observable Integer obs ViewUtil getObservableForResId getContext backgroundResId null if obs null bgSubscription obs compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create this onErrorLogAndRethrow @Override
1 15 protected void onDetachedFromWindow if bgSubscription null bgSubscription dispose super
1 16 public interface AestheticKeyProvider @Nullable String
1 17 public class AestheticListView extends ListView
1 17 private Disposable subscription
1 17 public AestheticListView Context context super context
1 17 public AestheticListView Context context AttributeSet attrs super context attrs
1 17 public AestheticListView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 17 private void invalidateColors int color EdgeGlowUtil setEdgeGlowColor this color @Override
1 17 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 17 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 17 protected void onDetachedFromWindow subscription dispose super
1 18 public class AestheticNavigationView extends NavigationView
1 18 private Disposable modeSubscription
1 18 private Disposable colorSubscription
1 18 public AestheticNavigationView Context context super context
1 18 public AestheticNavigationView Context context AttributeSet attrs super context attrs
1 18 public AestheticNavigationView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 18 private void invalidateColors ColorIsDarkState state int selectedColor state color boolean isDark state isDark int baseColor isDark Color WHITE Color BLACK int unselectedIconColor Util adjustAlpha baseColor 54f int unselectedTextColor Util adjustAlpha baseColor 87f int selectedItemBgColor ContextCompat getColor getContext isDark R color ate_navigation_drawer_selected_dark R color ate_navigation_drawer_selected_light final ColorStateList iconSl new ColorStateList new int new int android R attr state_checked new int android R attr state_checked new int unselectedIconColor selectedColor final ColorStateList textSl new ColorStateList new int new int android R attr state_checked new int android R attr state_checked new int unselectedTextColor selectedColor setItemTextColor textSl setItemIconTintList iconSl StateListDrawable bgDrawable new StateListDrawable bgDrawable addState new int android R attr state_checked new ColorDrawable selectedItemBgColor setItemBackground bgDrawable @Override
1 18 protected void onAttachedToWindow super onAttachedToWindow modeSubscription Aesthetic get navigationViewMode compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 18 public void accept @NonNull Integer mode switch mode case NavigationViewMode SELECTED_PRIMARY colorSubscription Observable combineLatest Aesthetic get colorPrimary Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 18 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow break case NavigationViewMode SELECTED_ACCENT colorSubscription Observable combineLatest Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 18 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow break default throw new IllegalStateException Unknown nav view mode mode onErrorLogAndRethrow @Override
1 18 protected void onDetachedFromWindow if modeSubscription null modeSubscription dispose if colorSubscription null colorSubscription dispose super
1 19 public class AestheticNestedScrollView extends NestedScrollView
1 19 private Disposable subscription
1 19 public AestheticNestedScrollView Context context super context
1 19 public AestheticNestedScrollView Context context AttributeSet attrs super context attrs
1 19 public AestheticNestedScrollView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 19 private void invalidateColors int color EdgeGlowUtil setEdgeGlowColor this color @Override
1 19 public void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 19 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 19 protected void onDetachedFromWindow subscription dispose super
1 20 public class AestheticProgressBar extends MaterialProgressBar
1 20 private Disposable subscription
1 20 public AestheticProgressBar Context context super context
1 20 public AestheticProgressBar Context context AttributeSet attrs super context attrs
1 20 public AestheticProgressBar Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 20 private void invalidateColors int color TintHelper setTint this color @Override
1 20 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 20 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 20 protected void onDetachedFromWindow subscription dispose super
1 21 public class AestheticRadioButton extends AppCompatRadioButton
1 21 private CompositeDisposable subscriptions
1 21 private int backgroundResId
1 21 public AestheticRadioButton Context context super context
1 21 public AestheticRadioButton Context context AttributeSet attrs super context attrs init context attrs
1 21 public AestheticRadioButton Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 21 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 21 private void invalidateColors ColorIsDarkState state TintHelper setTint this state color state isDark @Override
1 21 protected void onAttachedToWindow super onAttachedToWindow subscriptions new CompositeDisposable subscriptions add Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 21 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow subscriptions add Aesthetic get textColorPrimary compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this @Override
1 21 protected void onDetachedFromWindow subscriptions clear super
1 22 public class AestheticRecyclerView extends RecyclerView
1 22 private Disposable subscription
1 22 public AestheticRecyclerView Context context super context
1 22 public AestheticRecyclerView Context context AttributeSet attrs super context attrs
1 22 public AestheticRecyclerView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 22 private void invalidateColors int color EdgeGlowUtil setEdgeGlowColor this color null @Override
1 22 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 22 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 22 protected void onDetachedFromWindow subscription dispose super
1 23 public class AestheticScrollView extends ScrollView
1 23 private Disposable subscription
1 23 public AestheticScrollView Context context super context
1 23 public AestheticScrollView Context context AttributeSet attrs super context attrs
1 23 public AestheticScrollView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 23 private void invalidateColors int color EdgeGlowUtil setEdgeGlowColor this color @Override
1 23 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 23 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 23 protected void onDetachedFromWindow subscription dispose super
1 24 public class AestheticSeekBar extends AppCompatSeekBar
1 24 private Disposable subscription
1 24 private int backgroundResId
1 24 public AestheticSeekBar Context context super context
1 24 public AestheticSeekBar Context context AttributeSet attrs super context attrs init context attrs
1 24 public AestheticSeekBar Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 24 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 24 private void invalidateColors ColorIsDarkState state TintHelper setTint this state color state isDark @Override
1 24 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 24 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 24 protected void onDetachedFromWindow subscription dispose super
1 25 private Disposable subscription
1 25 public AestheticSnackBarButton Context context super context
1 25 public AestheticSnackBarButton Context context AttributeSet attrs super context attrs
1 25 public AestheticSnackBarButton Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr @Override
1 25 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get snackbarActionTextColor compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this @Override
1 25 protected void onDetachedFromWindow subscription dispose super
1 26 private Disposable subscription
1 26 public AestheticSnackBarTextView Context context super context
1 26 public AestheticSnackBarTextView Context context AttributeSet attrs super context attrs
1 26 public AestheticSnackBarTextView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr @Override
1 26 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get snackbarTextColor compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this onErrorLogAndRethrow @Override
1 26 protected void onDetachedFromWindow subscription dispose super
1 27 public class AestheticSpinner extends AppCompatSpinner
1 27 private Disposable subscription
1 27 private int backgroundResId
1 27 public AestheticSpinner Context context super context
1 27 public AestheticSpinner Context context AttributeSet attrs super context attrs init context attrs
1 27 public AestheticSpinner Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 27 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 27 private void invalidateColors ColorIsDarkState state TintHelper setTintAuto this state color true state isDark @Override
1 27 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 27 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 27 protected void onDetachedFromWindow subscription dispose super
1 28 public class AestheticSwitch extends Switch
1 28 private Disposable subscription
1 28 private int backgroundResId
1 28 public AestheticSwitch Context context super context
1 28 public AestheticSwitch Context context AttributeSet attrs super context attrs init context attrs
1 28 public AestheticSwitch Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 28 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 28 private void invalidateColors ColorIsDarkState state TintHelper setTint this state color state isDark @Override
1 28 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 28 public void accept @NonNull ColorIsDarkState state invalidateColors state onErrorLogAndRethrow @Override
1 28 protected void onDetachedFromWindow subscription dispose super
1 29 public class AestheticSwitchCompat extends SwitchCompat
1 29 private Disposable subscription
1 29 private int backgroundResId
1 29 public AestheticSwitchCompat Context context super context
1 29 public AestheticSwitchCompat Context context AttributeSet attrs super context attrs init context attrs
1 29 public AestheticSwitchCompat Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 29 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 29 private void invalidateColors ColorIsDarkState state TintHelper setTint this state color state isDark @Override
1 29 protected void onAttachedToWindow super onAttachedToWindow subscription Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 29 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 29 protected void onDetachedFromWindow subscription dispose super
1 30 public class AestheticTabLayout extends TabLayout
1 30 private static final float UNFOCUSED_ALPHA 0 5f
1 30 private Disposable indicatorModeSubscription
1 30 private Disposable bgModeSubscription
1 30 private Disposable indicatorColorSubscription
1 30 private Disposable bgColorSubscription
1 30 public AestheticTabLayout Context context super context
1 30 public AestheticTabLayout Context context AttributeSet attrs super context attrs
1 30 public AestheticTabLayout Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 30 private void setIconsColor int color final ColorStateList sl new ColorStateList new int new int android R attr state_selected new int android R attr state_selected new int adjustAlpha color UNFOCUSED_ALPHA color for int i 0 i getTabCount i final TabLayout Tab tab getTabAt i if tab null tab getIcon null tab setIcon createTintedDrawable tab getIcon sl @Override
1 30 public void setBackgroundColor @ColorInt int color super setBackgroundColor color Aesthetic get colorIconTitle Observable just color take 1 subscribe new Consumer ActiveInactiveColors @Override
1 30 public void accept @NonNull ActiveInactiveColors activeInactiveColors setIconsColor activeInactiveColors activeColor setTabTextColors adjustAlpha activeInactiveColors inactiveColor UNFOCUSED_ALPHA activeInactiveColors activeColor @Override
1 30 protected void onAttachedToWindow super onAttachedToWindow bgModeSubscription Aesthetic get tabLayoutBackgroundMode compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 30 public void accept @NonNull Integer mode if bgColorSubscription null bgColorSubscription dispose switch mode case TabLayoutIndicatorMode PRIMARY bgColorSubscription Aesthetic get colorPrimary compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create AestheticTabLayout this onErrorLogAndRethrow break case TabLayoutIndicatorMode ACCENT bgColorSubscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe ViewBackgroundAction create AestheticTabLayout this onErrorLogAndRethrow break default throw new IllegalStateException Unimplemented bg mode mode onErrorLogAndRethrow indicatorModeSubscription Aesthetic get tabLayoutIndicatorMode compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 30 public void accept @NonNull Integer mode if indicatorColorSubscription null indicatorColorSubscription dispose switch mode case TabLayoutIndicatorMode PRIMARY indicatorColorSubscription Aesthetic get colorPrimary compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 30 public void accept @NonNull Integer color setSelectedTabIndicatorColor color onErrorLogAndRethrow break case TabLayoutIndicatorMode ACCENT indicatorColorSubscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 30 public void accept @NonNull Integer color setSelectedTabIndicatorColor color onErrorLogAndRethrow break default throw new IllegalStateException Unimplemented bg mode mode onErrorLogAndRethrow @Override
1 30 protected void onDetachedFromWindow if bgModeSubscription null bgModeSubscription dispose if indicatorModeSubscription null indicatorModeSubscription dispose if bgColorSubscription null bgColorSubscription dispose if indicatorColorSubscription null indicatorColorSubscription dispose super
1 31 public class AestheticTextInputEditText extends TextInputEditText
1 31 private CompositeDisposable subs
1 31 private int backgroundResId
1 31 private ColorIsDarkState lastState
1 31 public AestheticTextInputEditText Context context super context
1 31 public AestheticTextInputEditText Context context AttributeSet attrs super context attrs init context attrs
1 31 public AestheticTextInputEditText Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 31 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 31 private void invalidateColors ColorIsDarkState state this lastState state TintHelper setTintAuto this state color true state isDark TintHelper setCursorTint this state color @Override
1 31 protected void onAttachedToWindow super onAttachedToWindow subs new CompositeDisposable subs add Aesthetic get textColorPrimary compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this onErrorLogAndRethrow subs add Aesthetic get textColorSecondary compose Rx Integer distinctToMainThread subscribe ViewHintTextColorAction create this onErrorLogAndRethrow subs add Observable combineLatest ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent Aesthetic get isDark ColorIsDarkState creator compose Rx ColorIsDarkState distinctToMainThread subscribe new Consumer ColorIsDarkState @Override
1 31 public void accept @NonNull ColorIsDarkState colorIsDarkState invalidateColors colorIsDarkState onErrorLogAndRethrow @Override
1 31 protected void onDetachedFromWindow subs clear super onDetachedFromWindow @Override
1 31 public void refreshDrawableState super refreshDrawableState if lastState null post new Runnable @Override
1 31 public void run invalidateColors
1 32 public class AestheticTextInputLayout extends TextInputLayout
1 32 private CompositeDisposable subs
1 32 private int backgroundResId
1 32 public AestheticTextInputLayout Context context super context
1 32 public AestheticTextInputLayout Context context AttributeSet attrs super context attrs init context attrs
1 32 public AestheticTextInputLayout Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 32 private void init Context context AttributeSet attrs if attrs null backgroundResId resolveResId context attrs android R attr background
1 32 private void invalidateColors int color TextInputLayoutUtil setAccent this color @SuppressWarnings ConstantConditions @Override
1 32 protected void onAttachedToWindow super onAttachedToWindow subs new CompositeDisposable subs add Aesthetic get textColorSecondary compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 32 public void accept @NonNull Integer color TextInputLayoutUtil setHint AestheticTextInputLayout this adjustAlpha color 0 7f onErrorLogAndRethrow subs add ViewUtil getObservableForResId getContext backgroundResId Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 32 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 32 protected void onDetachedFromWindow subs clear super
1 33 public class AestheticTextView extends AppCompatTextView
1 33 private Disposable subscription
1 33 private int textColorResId
1 33 public AestheticTextView Context context super context
1 33 public AestheticTextView Context context AttributeSet attrs super context attrs init context attrs
1 33 public AestheticTextView Context context AttributeSet attrs int defStyleAttr super context attrs defStyleAttr init context attrs
1 33 private void init Context context AttributeSet attrs if attrs null textColorResId resolveResId context attrs android R attr textColor @Override
1 33 protected void onAttachedToWindow super onAttachedToWindow Observable Integer obs ViewUtil getObservableForResId getContext textColorResId Aesthetic get textColorSecondary subscription obs compose Rx Integer distinctToMainThread subscribe ViewTextColorAction create this onErrorLogAndRethrow @Override
1 33 protected void onDetachedFromWindow subscription dispose super
1 34 public class AestheticToolbar extends Toolbar
1 34 private BgIconColorState lastState
1 34 private Disposable subscription
1 34 private PublishSubject Integer onColorUpdated
1 34 public AestheticToolbar Context context super context
1 34 public AestheticToolbar Context context @Nullable AttributeSet attrs super context attrs
1 34 public AestheticToolbar Context context @Nullable AttributeSet attrs int defStyleAttr super context attrs defStyleAttr
1 34 private void invalidateColors BgIconColorState state lastState state setBackgroundColor state bgColor setTitleTextColor state iconTitleColor activeColor setOverflowButtonColor this state iconTitleColor activeColor if getNavigationIcon null setNavigationIcon getNavigationIcon onColorUpdated onNext state bgColor ViewUtil tintToolbarMenu this getMenu state iconTitleColor
1 34 public Observable Integer colorUpdated return onColorUpdated @Override
1 34 public void setNavigationIcon @Nullable Drawable icon if lastState null super setNavigationIcon icon return super setNavigationIcon createTintedDrawable icon lastState iconTitleColor toEnabledSl
1 34 public void setNavigationIcon @Nullable Drawable icon @ColorInt int color if lastState null super setNavigationIcon icon return super setNavigationIcon createTintedDrawable icon color @SuppressWarnings ConstantConditions @Override
1 34 protected void onAttachedToWindow super onAttachedToWindow onColorUpdated PublishSubject create subscription Observable combineLatest Aesthetic get colorPrimary Aesthetic get colorIconTitle null BgIconColorState creator compose Rx BgIconColorState distinctToMainThread subscribe new Consumer BgIconColorState @Override
1 34 public void accept @NonNull BgIconColorState bgIconColorState invalidateColors bgIconColorState onErrorLogAndRethrow @Override
1 34 protected void onDetachedFromWindow lastState null onColorUpdated null subscription dispose super
1 35 public class AestheticViewPager extends ViewPager
1 35 private Disposable subscription
1 35 public AestheticViewPager Context context super context
1 35 public AestheticViewPager Context context AttributeSet attrs super context attrs
1 35 private void invalidateColors int color EdgeGlowUtil setEdgeGlowColor this color @Override
1 35 protected void onAttachedToWindow super onAttachedToWindow subscription Aesthetic get colorAccent compose Rx Integer distinctToMainThread subscribe new Consumer Integer @Override
1 35 public void accept @NonNull Integer color invalidateColors color onErrorLogAndRethrow @Override
1 35 protected void onDetachedFromWindow subscription dispose super
1 36 public @interface AutoSwitchMode int OFF 0 int ON 1 int AUTO
1 37 private final int bgColor
1 37 private final ActiveInactiveColors iconTitleColor
1 37 private BgIconColorState @ColorInt int bgColor ActiveInactiveColors iconTitleColor this bgColor bgColor this iconTitleColor iconTitleColor static BgIconColorState create @ColorInt int color ActiveInactiveColors iconTitleColors return new BgIconColorState color iconTitleColors static BiFunction Integer ActiveInactiveColors BgIconColorState creator return new BiFunction Integer ActiveInactiveColors BgIconColorState @Override
1 37 public BgIconColorState apply @NonNull Integer integer ActiveInactiveColors activeInactiveColors return BgIconColorState create integer activeInactiveColors @ColorInt int bgColor return bgColor @Nullable ActiveInactiveColors iconTitleColor return
1 38 public @interface BottomNavBgMode int BLACK_WHITE_AUTO 0 int PRIMARY 1 int PRIMARY_DARK 2 int ACCENT
1 39 public @interface BottomNavIconTextMode int SELECTED_PRIMARY 0 int SELECTED_ACCENT 1 int BLACK_WHITE_AUTO
1 40 private final int color
1 40 private final boolean isDark
1 40 private ColorIsDarkState @ColorInt int color boolean isDark this color color this isDark isDark static ColorIsDarkState create @ColorInt int color boolean isDark return new ColorIsDarkState color isDark static BiFunction Integer Boolean ColorIsDarkState creator return new BiFunction Integer Boolean ColorIsDarkState @Override
1 40 public ColorIsDarkState apply Integer integer Boolean aBoolean return ColorIsDarkState create integer aBoolean @ColorInt int color return color boolean isDark return
1 41 private static Field EDGE_GLOW_FIELD_EDGE
1 41 private static Field EDGE_GLOW_FIELD_GLOW
1 41 private static Field EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT
1 41 private static Field SCROLL_VIEW_FIELD_EDGE_GLOW_TOP
1 41 private static Field SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM
1 41 private static Field NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_TOP
1 41 private static Field NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM
1 41 private static Field LIST_VIEW_FIELD_EDGE_GLOW_TOP
1 41 private static Field LIST_VIEW_FIELD_EDGE_GLOW_BOTTOM
1 41 private static Field RECYCLER_VIEW_FIELD_EDGE_GLOW_TOP
1 41 private static Field RECYCLER_VIEW_FIELD_EDGE_GLOW_LEFT
1 41 private static Field RECYCLER_VIEW_FIELD_EDGE_GLOW_RIGHT
1 41 private static Field RECYCLER_VIEW_FIELD_EDGE_GLOW_BOTTOM
1 41 private static Field VIEW_PAGER_FIELD_EDGE_GLOW_LEFT
1 41 private static Field VIEW_PAGER_FIELD_EDGE_GLOW_RIGHT
1 41 private static void invalidateEdgeEffectFields if EDGE_GLOW_FIELD_EDGE null EDGE_GLOW_FIELD_GLOW null EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT null EDGE_GLOW_FIELD_EDGE setAccessible true EDGE_GLOW_FIELD_GLOW setAccessible true EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT setAccessible true return if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP Field edge null Field glow null for Field f EdgeEffect class getDeclaredFields switch f getName case mEdge f setAccessible true edge f break case mGlow f setAccessible true glow f break EDGE_GLOW_FIELD_EDGE edge EDGE_GLOW_FIELD_GLOW glow else EDGE_GLOW_FIELD_EDGE null EDGE_GLOW_FIELD_GLOW null Field efc null try efc EdgeEffectCompat class getDeclaredField mEdgeEffect catch NoSuchFieldException e if BuildConfig DEBUG e printStackTrace EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT efc
1 41 private static void invalidateScrollViewFields if SCROLL_VIEW_FIELD_EDGE_GLOW_TOP null SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM null SCROLL_VIEW_FIELD_EDGE_GLOW_TOP setAccessible true SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM setAccessible true return final Class cls ScrollView class for Field f cls getDeclaredFields switch f getName case mEdgeGlowTop f setAccessible true SCROLL_VIEW_FIELD_EDGE_GLOW_TOP f break case mEdgeGlowBottom f setAccessible true SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM f break
1 41 private static void invalidateNestedScrollViewFields if NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_TOP null NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM null NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_TOP setAccessible true NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM setAccessible true return Class cls NestedScrollView class for Field f cls getDeclaredFields switch f getName case mEdgeGlowTop f setAccessible true NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_TOP f break case mEdgeGlowBottom f setAccessible true NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM f break
1 41 private static void invalidateListViewFields if LIST_VIEW_FIELD_EDGE_GLOW_TOP null LIST_VIEW_FIELD_EDGE_GLOW_BOTTOM null LIST_VIEW_FIELD_EDGE_GLOW_TOP setAccessible true LIST_VIEW_FIELD_EDGE_GLOW_BOTTOM setAccessible true return final Class cls AbsListView class for Field f cls getDeclaredFields switch f getName case mEdgeGlowTop f setAccessible true LIST_VIEW_FIELD_EDGE_GLOW_TOP f break case mEdgeGlowBottom f setAccessible true LIST_VIEW_FIELD_EDGE_GLOW_BOTTOM f break
1 41 private static void invalidateRecyclerViewFields if RECYCLER_VIEW_FIELD_EDGE_GLOW_TOP null RECYCLER_VIEW_FIELD_EDGE_GLOW_LEFT null RECYCLER_VIEW_FIELD_EDGE_GLOW_RIGHT null RECYCLER_VIEW_FIELD_EDGE_GLOW_BOTTOM null RECYCLER_VIEW_FIELD_EDGE_GLOW_TOP setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_LEFT setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_RIGHT setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_BOTTOM setAccessible true return Class cls RecyclerView class for Field f cls getDeclaredFields switch f getName case mTopGlow f setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_TOP f break case mBottomGlow f setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_BOTTOM f break case mLeftGlow f setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_LEFT f break case mRightGlow f setAccessible true RECYCLER_VIEW_FIELD_EDGE_GLOW_RIGHT f break
1 41 private static void invalidateViewPagerFields if VIEW_PAGER_FIELD_EDGE_GLOW_LEFT null VIEW_PAGER_FIELD_EDGE_GLOW_RIGHT null VIEW_PAGER_FIELD_EDGE_GLOW_LEFT setAccessible true VIEW_PAGER_FIELD_EDGE_GLOW_RIGHT setAccessible true return Class cls ViewPager class for Field f cls getDeclaredFields switch f getName case mLeftEdge f setAccessible true VIEW_PAGER_FIELD_EDGE_GLOW_LEFT f break case mRightEdge f setAccessible true VIEW_PAGER_FIELD_EDGE_GLOW_RIGHT f break static void setEdgeGlowColor @NonNull ScrollView scrollView @ColorInt int color invalidateScrollViewFields try Object ee ee SCROLL_VIEW_FIELD_EDGE_GLOW_TOP get scrollView setEffectColor ee color ee SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM get scrollView setEffectColor ee color catch Exception ex if BuildConfig DEBUG ex printStackTrace static void setEdgeGlowColor @NonNull NestedScrollView scrollView @ColorInt int color invalidateNestedScrollViewFields try Object ee NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_TOP get scrollView setEffectColor ee color ee NESTED_SCROLL_VIEW_FIELD_EDGE_GLOW_BOTTOM get scrollView setEffectColor ee color catch Exception ex if BuildConfig DEBUG ex printStackTrace static void setEdgeGlowColor @NonNull AbsListView listView @ColorInt int color invalidateListViewFields try Object ee LIST_VIEW_FIELD_EDGE_GLOW_TOP get listView setEffectColor ee color ee LIST_VIEW_FIELD_EDGE_GLOW_BOTTOM get listView setEffectColor ee color catch Exception ex if BuildConfig DEBUG ex printStackTrace static void setEdgeGlowColor @NonNull RecyclerView scrollView final @ColorInt int color @Nullable RecyclerView OnScrollListener scrollListener invalidateRecyclerViewFields invalidateRecyclerViewFields if scrollListener null scrollListener new RecyclerView OnScrollListener @Override
1 41 public void onScrollStateChanged RecyclerView recyclerView int newState super onScrollStateChanged recyclerView newState EdgeGlowUtil setEdgeGlowColor recyclerView color this scrollView addOnScrollListener scrollListener try Object ee RECYCLER_VIEW_FIELD_EDGE_GLOW_TOP get scrollView setEffectColor ee color ee RECYCLER_VIEW_FIELD_EDGE_GLOW_BOTTOM get scrollView setEffectColor ee color ee RECYCLER_VIEW_FIELD_EDGE_GLOW_LEFT get scrollView setEffectColor ee color ee RECYCLER_VIEW_FIELD_EDGE_GLOW_RIGHT get scrollView setEffectColor ee color catch Exception ex if BuildConfig DEBUG ex printStackTrace static void setEdgeGlowColor @NonNull ViewPager pager @ColorInt int color invalidateViewPagerFields try Object ee VIEW_PAGER_FIELD_EDGE_GLOW_LEFT get pager setEffectColor ee color ee VIEW_PAGER_FIELD_EDGE_GLOW_RIGHT get pager setEffectColor ee color catch Exception ex if BuildConfig DEBUG ex printStackTrace @TargetApi Build VERSION_CODES LOLLIPOP
1 41 private static void setEffectColor Object edgeEffect @ColorInt int color invalidateEdgeEffectFields if edgeEffect instanceof EdgeEffectCompat try EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT setAccessible true edgeEffect EDGE_EFFECT_COMPAT_FIELD_EDGE_EFFECT get edgeEffect catch IllegalAccessException e e printStackTrace return if edgeEffect null return if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP try EDGE_GLOW_FIELD_EDGE setAccessible true final Drawable mEdge Drawable EDGE_GLOW_FIELD_EDGE get edgeEffect EDGE_GLOW_FIELD_GLOW setAccessible true final Drawable mGlow Drawable EDGE_GLOW_FIELD_GLOW get edgeEffect mEdge setColorFilter color PorterDuff Mode SRC_IN mGlow setColorFilter color PorterDuff Mode SRC_IN mEdge setCallback null mGlow setCallback null catch Exception ex ex printStackTrace else EdgeEffect edgeEffect setColor
1 42 private final Method onCreateViewMethod
1 42 private final Method createViewMethod
1 42 private final Field constructorArgsField
1 42 private final AppCompatActivity keyContext @NonNull
1 42 private final LayoutInflater layoutInflater @Nullable
1 42 private final AppCompatDelegate delegate
1 42 private int ATTRS_THEME InflationInterceptor @Nullable AppCompatActivity keyContext @NonNull LayoutInflater li @Nullable AppCompatDelegate delegate this keyContext keyContext layoutInflater li this delegate delegate try onCreateViewMethod LayoutInflater class getDeclaredMethod onCreateView View class String class AttributeSet class catch NoSuchMethodException e throw new IllegalStateException Failed to retrieve the onCreateView method e try createViewMethod LayoutInflater class getDeclaredMethod createView String class String class AttributeSet class catch NoSuchMethodException e throw new IllegalStateException Failed to retrieve the createView method e try constructorArgsField LayoutInflater class getDeclaredField mConstructorArgs catch NoSuchFieldException e throw new IllegalStateException Failed to retrieve the mConstructorArgs field e try final Field attrsThemeField LayoutInflater class getDeclaredField ATTRS_THEME attrsThemeField setAccessible true ATTRS_THEME int attrsThemeField get null catch Throwable t t printStackTrace Log d InflationInterceptor Failed to get the value of static field ATTRS_THEME t getMessage onCreateViewMethod setAccessible true createViewMethod setAccessible true constructorArgsField setAccessible true
1 42 private static void log String msg Object args if args null Log d InflationInterceptor String format msg args else Log d InflationInterceptor msg
1 42 private boolean isBlackListedForApply String name return android support design internal NavigationMenuItemView equals name ViewStub equals name fragment equals name include equals name @Override
1 42 public View onCreateView View parent final String name Context context AttributeSet attrs View view null final int viewId resolveResId context attrs android R attr id switch name case ImageView case android support v7 widget AppCompatImageView view new AestheticImageView context attrs break case ImageButton case android support v7 widget AppCompatImageButton view new AestheticImageButton context attrs break case android support v4 widget DrawerLayout view new AestheticDrawerLayout context attrs break case Toolbar case android support v7 widget Toolbar view new AestheticToolbar context attrs break case android support v7 widget AppCompatTextView case TextView if viewId R id snackbar_text view new AestheticSnackBarTextView context attrs else view new AestheticTextView context attrs if parent instanceof LinearLayout view getId android R id message view null break case Button case android support v7 widget AppCompatButton if viewId android R id button1 viewId android R id button2 viewId android R id button3 view new AestheticDialogButton context attrs else if viewId R id snackbar_action view new AestheticSnackBarButton context attrs else view new AestheticButton context attrs break case android support v7 widget AppCompatCheckBox case CheckBox view new AestheticCheckBox context attrs break case android support v7 widget AppCompatRadioButton case RadioButton view new AestheticRadioButton context attrs break case android support v7 widget AppCompatEditText case EditText view new AestheticEditText context attrs break case Switch view new AestheticSwitch context attrs break case android support v7 widget SwitchCompat view new AestheticSwitchCompat context attrs break case android support v7 widget AppCompatSeekBar case SeekBar view new AestheticSeekBar context attrs break case ProgressBar view new AestheticProgressBar context attrs break case android support v7 view menu ActionMenuItemView view new AestheticActionMenuItemView context attrs break case android support v7 widget RecyclerView view new AestheticRecyclerView context attrs break case android support v4 widget NestedScrollView view new AestheticNestedScrollView context attrs break case ListView view new AestheticListView context attrs break case ScrollView view new AestheticScrollView context attrs break case android support v4 view ViewPager view new AestheticViewPager context attrs break case Spinner case android support v7 widget AppCompatSpinner view new AestheticSpinner context attrs break case android support design widget TextInputLayout view new AestheticTextInputLayout context attrs break case android support design widget TextInputEditText view new AestheticTextInputEditText context attrs break case android support v7 widget CardView view new AestheticCardView context attrs break case android support design widget TabLayout view new AestheticTabLayout context attrs break case android support design widget NavigationView view new AestheticNavigationView context attrs break case android support design widget BottomNavigationView view new AestheticBottomNavigationView context attrs break case android support design widget FloatingActionButton view new AestheticFab context attrs break case android support design widget CoordinatorLayout view new AestheticCoordinatorLayout context attrs break int viewBackgroundRes 0 if view null view getTag null aesthetic_ignore equals view getTag view null else if attrs null viewBackgroundRes resolveResId context attrs android R attr background if view null if delegate null view delegate createView parent name context attrs if view null view keyContext onCreateView parent name context attrs else view null else view null if isBlackListedForApply name return view if view null try Context viewContext layoutInflater getContext if ATTRS_THEME null final TypedArray ta viewContext obtainStyledAttributes attrs ATTRS_THEME final int themeResId ta getResourceId 0 0 if themeResId 0 viewContext new ContextThemeWrapper viewContext themeResId ta recycle Object constructorArgs try constructorArgs Object constructorArgsField get layoutInflater catch IllegalAccessException e throw new IllegalStateException Failed to retrieve the mConstructorArgsField field e final Object lastContext constructorArgs 0 constructorArgs 0 viewContext try if 1 name indexOf view View onCreateViewMethod invoke layoutInflater parent name attrs else view View createViewMethod invoke layoutInflater name null attrs catch Exception e log Failed to inflate s s name e getMessage e printStackTrace finally constructorArgs 0 lastContext catch Throwable t throw new RuntimeException String format An error occurred while inflating View s s name t getMessage t if view null if viewBackgroundRes 0 Observable Integer obs obs ViewUtil getObservableForResId view getContext viewBackgroundRes null if obs null Aesthetic get addBackgroundSubscriber view obs String idName try idName context getResources getResourceName view getId catch Throwable ignored log Inflated s s idName view getClass getName return
1 43 public @interface NavigationViewMode int SELECTED_PRIMARY 0 int SELECTED_ACCENT
1 44 public void accept @NonNull Throwable throwable throws Exception throwable printStackTrace throw Exceptions propagate throwable static T ObservableTransformer T T distinctToMainThread return new ObservableTransformer T T @Override
1 44 public ObservableSource T apply @NonNull Observable T obs return obs observeOn AndroidSchedulers mainThread
1 45 public @interface TabLayoutBgMode int PRIMARY 0 int ACCENT
1 46 public @interface TabLayoutIndicatorMode int PRIMARY 0 int ACCENT
1 48 private static int getDefaultRippleColor @NonNull Context context boolean useDarkRipple return ContextCompat getColor context useDarkRipple R color ripple_material_light R color ripple_material_dark @NonNull
1 48 private static ColorStateList getDisabledColorStateList @ColorInt int normal @ColorInt int disabled return new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled new int disabled normal @SuppressWarnings deprecation
1 48 private static void setTintSelector @NonNull View view @ColorInt final int color final boolean darker final boolean useDarkTheme final boolean isColorLight Util isColorLight color final int disabled ContextCompat getColor view getContext useDarkTheme R color ate_button_disabled_dark R color ate_button_disabled_light final int pressed Util shiftColor color darker 0 9f 1 1f final int activated Util shiftColor color darker 1 1f 0 9f final int rippleColor getDefaultRippleColor view getContext isColorLight final int textColor ContextCompat getColor view getContext isColorLight R color ate_primary_text_light R color ate_primary_text_dark final ColorStateList sl if view instanceof Button sl getDisabledColorStateList color disabled if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP view getBackground instanceof RippleDrawable RippleDrawable rd RippleDrawable view getBackground rd setColor ColorStateList valueOf rippleColor final Button button Button view button setTextColor getDisabledColorStateList textColor ContextCompat getColor view getContext useDarkTheme R color ate_button_text_disabled_dark R color ate_button_text_disabled_light else if view instanceof FloatingActionButton sl new ColorStateList new int new int android R attr state_pressed new int android R attr state_pressed new int color pressed final FloatingActionButton fab FloatingActionButton view fab setRippleColor rippleColor fab setBackgroundTintList sl if fab getDrawable null fab setImageDrawable createTintedDrawable fab getDrawable textColor return else sl new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled new int android R attr state_enabled android R attr state_pressed new int android R attr state_enabled android R attr state_activated new int android R attr state_enabled android R attr state_checked new int disabled color pressed activated activated Drawable drawable view getBackground if drawable null drawable createTintedDrawable drawable sl Util setBackgroundCompat view drawable if view instanceof TextView view instanceof Button final TextView tv TextView view tv setTextColor getDisabledColorStateList textColor ContextCompat getColor view getContext isColorLight R color ate_text_disabled_light R color ate_text_disabled_dark @SuppressWarnings deprecation @SuppressLint PrivateResource static void setTintAuto final @NonNull View view final @ColorInt int color boolean background final boolean isDark if background if view instanceof RadioButton setTint RadioButton view color isDark else if view instanceof SeekBar setTint SeekBar view color isDark else if view instanceof ProgressBar setTint ProgressBar view color else if view instanceof EditText setTint EditText view color isDark else if view instanceof CheckBox setTint CheckBox view color isDark else if view instanceof ImageView setTint ImageView view color else if view instanceof Switch setTint Switch view color isDark else if view instanceof SwitchCompat setTint SwitchCompat view color isDark else background true if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP background view getBackground instanceof RippleDrawable RippleDrawable rd RippleDrawable view getBackground final int unchecked ContextCompat getColor view getContext isDark R color ripple_material_dark R color ripple_material_light final int checked Util adjustAlpha color 0 4f final ColorStateList sl new ColorStateList new int new int android R attr state_activated android R attr state_checked new int android R attr state_activated new int android R attr state_checked new int unchecked checked checked rd setColor sl if background if view instanceof FloatingActionButton view instanceof Button setTintSelector view color false isDark else if view getBackground null Drawable drawable view getBackground if drawable null if view instanceof TextInputEditText drawable setColorFilter color PorterDuff Mode SRC_IN else drawable createTintedDrawable drawable color Util setBackgroundCompat view drawable static void setTint @NonNull RadioButton radioButton @ColorInt int color boolean useDarker ColorStateList sl new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled android R attr state_checked new int android R attr state_enabled android R attr state_checked new int Util stripAlpha ContextCompat getColor radioButton getContext useDarker R color ate_control_disabled_dark R color ate_control_disabled_light ContextCompat getColor radioButton getContext useDarker R color ate_control_normal_dark R color ate_control_normal_light color if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP radioButton setButtonTintList sl else @SuppressLint PrivateResource Drawable d createTintedDrawable ContextCompat getDrawable radioButton getContext R drawable abc_btn_radio_material sl radioButton setButtonDrawable d static void setTint @NonNull SeekBar seekBar @ColorInt int color boolean useDarker final ColorStateList s1 getDisabledColorStateList color ContextCompat getColor seekBar getContext useDarker R color ate_control_disabled_dark R color ate_control_disabled_light if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP seekBar setThumbTintList s1 seekBar setProgressTintList s1 else Drawable progressDrawable createTintedDrawable seekBar getProgressDrawable s1 seekBar setProgressDrawable progressDrawable if Build VERSION SDK_INT Build VERSION_CODES JELLY_BEAN Drawable thumbDrawable createTintedDrawable seekBar getThumb s1 seekBar setThumb thumbDrawable static void setTint @NonNull ProgressBar progressBar @ColorInt int color setTint progressBar color false
1 48 private static void setTint @NonNull ProgressBar progressBar @ColorInt int color boolean skipIndeterminate ColorStateList sl ColorStateList valueOf color if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP progressBar setProgressTintList sl progressBar setSecondaryProgressTintList sl if skipIndeterminate progressBar setIndeterminateTintList sl else PorterDuff Mode mode PorterDuff Mode SRC_IN if skipIndeterminate progressBar getIndeterminateDrawable null progressBar getIndeterminateDrawable setColorFilter color mode if progressBar getProgressDrawable null progressBar getProgressDrawable setColorFilter color mode
1 48 private static void setTint @NonNull EditText editText @ColorInt int color boolean useDarker final ColorStateList editTextColorStateList new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled android R attr state_pressed android R attr state_focused new int new int ContextCompat getColor editText getContext useDarker R color ate_text_disabled_dark R color ate_text_disabled_light ContextCompat getColor editText getContext useDarker R color ate_control_normal_dark R color ate_control_normal_light color if editText instanceof TintableBackgroundView ViewCompat setBackgroundTintList editText editTextColorStateList else if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP editText setBackgroundTintList editTextColorStateList setCursorTint editText color static void setTint @NonNull CheckBox box @ColorInt int color boolean useDarker ColorStateList sl new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled android R attr state_checked new int android R attr state_enabled android R attr state_checked new int ContextCompat getColor box getContext useDarker R color ate_control_disabled_dark R color ate_control_disabled_light ContextCompat getColor box getContext useDarker R color ate_control_normal_dark R color ate_control_normal_light color if Build VERSION SDK_INT Build VERSION_CODES LOLLIPOP box setButtonTintList sl else @SuppressLint PrivateResource Drawable drawable createTintedDrawable ContextCompat getDrawable box getContext R drawable abc_btn_check_material sl box setButtonDrawable drawable
1 48 private static void setTint @NonNull ImageView image @ColorInt int color image setColorFilter color PorterDuff Mode SRC_ATOP
1 48 private static Drawable modifySwitchDrawable @NonNull Context context @NonNull Drawable from @ColorInt int tint boolean thumb boolean compatSwitch boolean useDarker if useDarker tint Util shiftColor tint 1 1f tint Util adjustAlpha tint compatSwitch thumb 0 5f 1 0f int disabled int normal if thumb disabled ContextCompat getColor context useDarker R color ate_switch_thumb_disabled_dark R color ate_switch_thumb_disabled_light normal ContextCompat getColor context useDarker R color ate_switch_thumb_normal_dark R color ate_switch_thumb_normal_light else disabled ContextCompat getColor context useDarker R color ate_switch_track_disabled_dark R color ate_switch_track_disabled_light normal ContextCompat getColor context useDarker R color ate_switch_track_normal_dark R color ate_switch_track_normal_light if compatSwitch normal Util stripAlpha normal final ColorStateList sl new ColorStateList new int new int android R attr state_enabled new int android R attr state_enabled android R attr state_activated android R attr state_checked new int android R attr state_enabled android R attr state_activated new int android R attr state_enabled android R attr state_checked new int disabled normal tint tint return createTintedDrawable from sl static void setTint @NonNull Switch switchView @ColorInt int color boolean useDarker if switchView getTrackDrawable null switchView setTrackDrawable modifySwitchDrawable switchView getContext switchView getTrackDrawable color false false useDarker if switchView getThumbDrawable null switchView setThumbDrawable modifySwitchDrawable switchView getContext switchView getThumbDrawable color true false useDarker static void setTint @NonNull SwitchCompat switchView @ColorInt int color boolean useDarker if switchView getTrackDrawable null switchView setTrackDrawable modifySwitchDrawable switchView getContext switchView getTrackDrawable color false true useDarker if switchView getThumbDrawable null switchView setThumbDrawable modifySwitchDrawable switchView getContext switchView getThumbDrawable color true true useDarker @CheckResult @Nullable static Drawable createTintedDrawable @Nullable Drawable drawable @ColorInt int color if drawable null return null drawable DrawableCompat wrap drawable mutate DrawableCompat setTintMode drawable PorterDuff Mode SRC_IN DrawableCompat setTint drawable color return drawable @CheckResult @Nullable static Drawable createTintedDrawable @Nullable Drawable drawable @NonNull ColorStateList sl if drawable null return null drawable DrawableCompat wrap drawable mutate DrawableCompat setTintList drawable sl return drawable static void setCursorTint @NonNull EditText editText @ColorInt int color try Field fCursorDrawableRes TextView class getDeclaredField mCursorDrawableRes fCursorDrawableRes setAccessible true int mCursorDrawableRes fCursorDrawableRes getInt editText Field fEditor TextView class getDeclaredField mEditor fEditor setAccessible true Object editor fEditor get editText Class clazz editor getClass Field fCursorDrawable clazz getDeclaredField mCursorDrawable fCursorDrawable setAccessible true Drawable drawables new Drawable 2 drawables 0 ContextCompat getDrawable editText getContext mCursorDrawableRes drawables 0 createTintedDrawable drawables 0 color drawables 1 ContextCompat getDrawable editText getContext mCursorDrawableRes drawables 1 createTintedDrawable drawables 1 color fCursorDrawable set editor drawables catch Exception e e
1 50 private final View view
1 50 private ViewBackgroundAction View view this view view
1 50 public static ViewBackgroundAction create @NonNull View view return new ViewBackgroundAction view @Override
1 50 public void accept @io reactivex annotations NonNull Integer color if view null view setBackgroundColor
1 51 private final View view
1 51 private ViewBackgroundSubscriber @NonNull View view this view view
1 51 public static ViewBackgroundSubscriber create @NonNull View view return new ViewBackgroundSubscriber view @Override
1 51 public void onError Throwable e throw Exceptions propagate e @Override
1 51 public void onComplete @Override
1 51 public void onNext Integer color if view instanceof CardView CardView view setCardBackgroundColor color else view setBackgroundColor
1 52 private final TextView view
1 52 private ViewHintTextColorAction TextView view this view view
1 52 public static ViewHintTextColorAction create @NonNull TextView view return new ViewHintTextColorAction view @Override
1 52 public void accept @io reactivex annotations NonNull Integer color if view null view setHintTextColor
1 53 private final View view
1 53 private final Observable Integer observable
1 53 private ViewObservablePair View view Observable Integer observable this view view this observable observable static ViewObservablePair create View view Observable Integer observable return new ViewObservablePair view observable View view return view Observable Integer observable return
1 54 private final TextView view
1 54 private ViewTextColorAction TextView view this view view
1 54 public static ViewTextColorAction create @NonNull TextView view return new ViewTextColorAction view @Override
1 54 public void accept @io reactivex annotations NonNull Integer color if view null view setTextColor
1 55 private static void themeSearchView ActiveInactiveColors tintColors SearchView view final Class cls view getClass try final Field mSearchSrcTextViewField cls getDeclaredField mSearchSrcTextView mSearchSrcTextViewField setAccessible true final EditText mSearchSrcTextView EditText mSearchSrcTextViewField get view mSearchSrcTextView setTextColor tintColors activeColor mSearchSrcTextView setHintTextColor tintColors inactiveColor TintHelper setCursorTint mSearchSrcTextView tintColors activeColor Field field cls getDeclaredField mSearchButton tintImageView view field tintColors field cls getDeclaredField mGoButton tintImageView view field tintColors field cls getDeclaredField mCloseButton tintImageView view field tintColors field cls getDeclaredField mVoiceButton tintImageView view field tintColors field cls getDeclaredField mSearchPlate field setAccessible true TintHelper setTintAuto View field get view tintColors activeColor true isColorLight tintColors activeColor field cls getDeclaredField mSearchHintIcon field setAccessible true field set view createTintedDrawable Drawable field get view tintColors toEnabledSl catch Exception e e printStackTrace
1 55 private static void tintImageView Object target Field field ActiveInactiveColors tintColors throws Exception field setAccessible true final ImageView imageView ImageView field get target if imageView getDrawable null imageView setImageDrawable createTintedDrawable imageView getDrawable tintColors
1 56 public class BottomNavActivity extends AestheticActivity @BindView R id toolbar Toolbar toolbar
1 56 private Unbinder unbinder @Override
1 56 protected void onCreate @Nullable Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_bottom_nav unbinder ButterKnife bind this toolbar setNavigationOnClickListener new View OnClickListener @Override
1 56 public void onClick View view finish @Override
1 56 protected void onDestroy unbinder unbind super
1 57 public class CoordinatorLayoutActivity extends AestheticActivity @BindView R id toolbar Toolbar toolbar
1 57 private Unbinder unbinder @Override
1 57 protected void onCreate @Nullable Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_collapsing_appbar unbinder ButterKnife bind this toolbar inflateMenu R menu coordinatorlayout toolbar setNavigationOnClickListener new View OnClickListener @Override
1 57 public void onClick View view finish @Override
1 57 protected void onDestroy unbinder unbind super
1 58 public class DrawerActivity extends AestheticActivity @BindView R id toolbar Toolbar toolbar @BindView R id drawer_layout DrawerLayout drawerLayout @BindView R id navigation_view NavigationView navigationView
1 58 private Unbinder unbinder
1 58 private ActionBarDrawerToggle drawerToggle @Override
1 58 protected void onCreate @Nullable Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_drawer unbinder ButterKnife bind this setSupportActionBar toolbar drawerToggle new ActionBarDrawerToggle this drawerLayout toolbar R string open_drawer R string close_drawer drawerLayout addDrawerListener drawerToggle getSupportActionBar setDisplayHomeAsUpEnabled true getSupportActionBar setHomeButtonEnabled true navigationView post new Runnable @Override
1 58 public void run navigationView setCheckedItem R id item_three @Override
1 58 protected void onPostCreate Bundle savedInstanceState super onPostCreate savedInstanceState drawerToggle syncState @Override
1 58 public void onConfigurationChanged Configuration newConfig super onConfigurationChanged newConfig drawerToggle onConfigurationChanged newConfig @Override
1 58 public boolean onOptionsItemSelected MenuItem item return drawerToggle onOptionsItemSelected item super onOptionsItemSelected item @Override
1 58 protected void onDestroy unbinder unbind super
1 59 public class MainActivity extends AestheticActivity @BindView R id toolbar Toolbar toolbar @BindView R id pager ViewPager pager @BindView R id tabs TabLayout tabs
1 59 private Unbinder unbinder @Override
1 59 protected void onCreate Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_main unbinder ButterKnife bind this toolbar inflateMenu R menu main final MenuItem searchItem toolbar getMenu findItem R id search final SearchView searchView SearchView MenuItemCompat getActionView searchItem searchView setQueryHint getString R string search_view_example if Aesthetic isFirstTime Aesthetic get activityTheme R style AppTheme textColorPrimaryRes R color text_color_primary textColorSecondaryRes R color text_color_secondary colorPrimaryRes R color md_white colorAccentRes R color md_blue colorStatusBarAuto colorNavigationBarAuto textColorPrimary Color BLACK navigationViewMode NavigationViewMode SELECTED_ACCENT bottomNavigationBackgroundMode BottomNavBgMode PRIMARY bottomNavigationIconTextMode BottomNavIconTextMode SELECTED_ACCENT apply pager setAdapter new MainPagerAdapter this getSupportFragmentManager tabs setupWithViewPager pager @Override
1 59 protected void onDestroy unbinder unbind super
1 60 public ViewHolder onCreateViewHolder ViewGroup parent int viewType View view LayoutInflater from parent getContext inflate R layout list_item_rv parent false return new ViewHolder view @SuppressLint SetTextI18n @Override
1 60 public void onBindViewHolder ViewHolder holder int position holder title setText Item position holder subtitle setText R string hello_world @Override
1 60 public int getItemCount return 20 static class ViewHolder extends RecyclerView ViewHolder @BindView R id title TextView title @BindView R id subtitle TextView subtitle ViewHolder View itemView super itemView ButterKnife bind this
1 61 public class MainFragment extends Fragment @BindView R id root FrameLayout rootView @BindView R id switch_theme SwitchCompat switchThemeView @BindView R id spinner Spinner spinnerView
1 61 private Snackbar snackbar
1 61 private Unbinder unbinder
1 61 private Disposable isDarkSubscription @Nullable @Override
1 61 public View onCreateView LayoutInflater inflater @Nullable ViewGroup container @Nullable Bundle savedInstanceState return inflater inflate R layout fragment_main container false @Override
1 61 public void onViewCreated View view @Nullable Bundle savedInstanceState super onViewCreated view savedInstanceState unbinder ButterKnife bind this view isDarkSubscription Aesthetic get isDark subscribe new Consumer Boolean @Override
1 61 public void accept @NonNull Boolean isDark switchThemeView setChecked isDark ArrayAdapter String spinnerAdapter new ArrayAdapter getContext R layout list_item_spinner new String Spinner One Spinner Two Spinner Three Spinner Four Spinner Five Spinner Six spinnerAdapter setDropDownViewResource R layout list_item_spinner_dropdown spinnerView setAdapter spinnerAdapter @Override
1 61 public void onDestroyView isDarkSubscription dispose unbinder unbind super onDestroyView @OnClick R id switch_theme
1 61 public void onThemeChange SwitchCompat switchCompat if switchCompat isChecked Aesthetic get activityTheme R style AppThemeDark isDark true textColorPrimaryRes R color text_color_primary_dark textColorSecondaryRes R color text_color_secondary_dark apply else Aesthetic get activityTheme R style AppTheme isDark false textColorPrimaryRes R color text_color_primary textColorSecondaryRes R color text_color_secondary apply @OnClick R id btn_black R id btn_red R id btn_purple R id btn_blue R id btn_green R id btn_white
1 61 public void onClickButton View view switch view getId case R id btn_black Aesthetic get colorPrimaryRes R color text_color_primary colorAccentRes R color md_purple colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY_DARK bottomNavigationIconTextMode BottomNavIconTextMode BLACK_WHITE_AUTO apply break case R id btn_red Aesthetic get colorPrimaryRes R color md_red colorAccentRes R color md_amber colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY_DARK bottomNavigationIconTextMode BottomNavIconTextMode BLACK_WHITE_AUTO apply break case R id btn_purple Aesthetic get colorPrimaryRes R color md_purple colorAccentRes R color md_lime colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY_DARK bottomNavigationIconTextMode BottomNavIconTextMode BLACK_WHITE_AUTO apply break case R id btn_blue Aesthetic get colorPrimaryRes R color md_blue colorAccentRes R color md_pink colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY_DARK bottomNavigationIconTextMode BottomNavIconTextMode BLACK_WHITE_AUTO apply break case R id btn_green Aesthetic get colorPrimaryRes R color md_green colorAccentRes R color md_blue_grey colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY_DARK bottomNavigationIconTextMode BottomNavIconTextMode BLACK_WHITE_AUTO apply break case R id btn_white Aesthetic get colorPrimaryRes R color md_white colorAccentRes R color md_blue colorStatusBarAuto colorNavigationBarAuto bottomNavigationBackgroundMode BottomNavBgMode PRIMARY bottomNavigationIconTextMode BottomNavIconTextMode SELECTED_ACCENT apply break @OnClick R id fab
1 61 public void onClickFab if snackbar null snackbar dismiss snackbar Snackbar make rootView R string hello_world Snackbar LENGTH_LONG snackbar setAction android R string cancel new View OnClickListener @Override
1 61 public void onClick View view snackbar
1 62 private final Context context MainPagerAdapter Context context FragmentManager fm super fm this context context @Override
1 62 public Fragment getItem int position return position 0 new MainFragment new SecondaryFragment @Override
1 62 public int getCount return 2 @Override
1 62 public CharSequence getPageTitle int position return context getString position 0 R string main R string
1 63 public class RecyclerViewActivity extends AestheticActivity @BindView R id toolbar Toolbar toolbar @BindView R id recycler_view RecyclerView recyclerView
1 63 private Unbinder unbinder @Override
1 63 protected void onCreate @Nullable Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_recyclerview unbinder ButterKnife bind this toolbar setNavigationOnClickListener new View OnClickListener @Override
1 63 public void onClick View view finish recyclerView setLayoutManager new LinearLayoutManager this recyclerView setAdapter new MainAdapter @Override
1 63 protected void onDestroy unbinder unbind super
1 64 public class SecondaryFragment extends Fragment
1 64 private Unbinder unbinder @Nullable @Override
1 64 public View onCreateView LayoutInflater inflater @Nullable ViewGroup container @Nullable Bundle savedInstanceState return inflater inflate R layout fragment_secondary container false @Override
1 64 public void onViewCreated View view @Nullable Bundle savedInstanceState super onViewCreated view savedInstanceState unbinder ButterKnife bind this view @Override
1 64 public void onDestroyView unbinder unbind super onDestroyView @OnClick R id drawer_layout
1 64 public void onClickDrawerLayout startActivity new Intent getActivity DrawerActivity class @OnClick R id coordinator_layout
1 64 public void onClickCoordinatorlayout startActivity new Intent getActivity CoordinatorLayoutActivity class @OnClick R id bottom_tabs
1 64 public void onClickBottomTabs startActivity new Intent getActivity BottomNavActivity class @OnClick R id recycler_view
1 64 public void onClickRecyclerView startActivity new Intent getActivity RecyclerViewActivity
3 65 public class MainActivity extends AppCompatActivity @Override
3 65 protected void onCreate Bundle savedInstanceState super onCreate savedInstanceState setContentView R layout activity_main @Override
3 65 protected void attachBaseContext Context newBase super attachBaseContext ResourceInspector wrap
3 66 public class ResourceInspector
3 66 public static Context wrap Context base return
3 67 public class ResourceInspector
3 67 public static Context wrap Context base return new ContextWrapper base
3 67 private static class ContextWrapper extends android content ContextWrapper
3 67 private InspectorLayoutInflater inflater ContextWrapper Context base super base @Override
3 67 public Object getSystemService String name if LAYOUT_INFLATER_SERVICE equals name if inflater null inflater new InspectorLayoutInflater LayoutInflater super getSystemService name this return inflater return super getSystemService name
3 67 private static class InspectorLayoutInflater extends LayoutInflater
3 67 private final LayoutInflater original
3 67 private final String appPackageName InspectorLayoutInflater LayoutInflater original Context newContext super original newContext this original original appPackageName getContext getApplicationContext getPackageName @Override
3 67 public LayoutInflater cloneInContext Context newContext return new InspectorLayoutInflater this original newContext @Override
3 67 public View inflate @LayoutRes int resource @Nullable ViewGroup root boolean attachToRoot final Resources res getContext getResources final String packageName res getResourcePackageName resource final String resName res getResourceEntryName resource final View view original inflate resource root attachToRoot if appPackageName equals packageName return view View targetView view if root null attachToRoot targetView root getChildAt root getChildCount 1 if Build VERSION SDK_INT Build VERSION_CODES M final Drawable foreground targetView getForeground if foreground null targetView setForeground new TipDrawable resName else targetView setForeground new LayerDrawable new Drawable foreground new TipDrawable resName else final Drawable background targetView getBackground if background null if Build VERSION SDK_INT Build VERSION_CODES JELLY_BEAN targetView setBackground new TipDrawable resName else targetView setBackgroundDrawable new TipDrawable resName else if Build VERSION SDK_INT Build VERSION_CODES JELLY_BEAN targetView setBackground new LayerDrawable new Drawable background new TipDrawable resName else targetView setBackgroundDrawable new LayerDrawable new Drawable background new TipDrawable resName return view
3 67 private static class TipDrawable extends Drawable
3 67 private static final float TEXT_SIZE sp2px 10
3 67 private static final float PADDING dp2px 4
3 67 private static final float BOUNDARY_WIDTH dp2px 2
3 67 private static final Paint paint new TextPaint
3 67 private static final Path path new Path
3 67 private static final Path path2 new Path
3 67 private final String text
3 67 private final float textWidth textHeight
3 67 private final float tcx tcy
3 67 private int alpha 200 static paint setAntiAlias true paint setTextSize TEXT_SIZE paint setTextAlign Paint Align CENTER TipDrawable String text this text text final Paint FontMetrics fontMetrics paint getFontMetrics textWidth paint measureText text PADDING 2f textHeight TEXT_SIZE PADDING 2f tcx textWidth 2f tcy textHeight 2f fontMetrics bottom fontMetrics top 2f @Override
3 67 public void draw @NonNull Canvas canvas final float left 0f top 0f right canvas getWidth bottom canvas getHeight path reset path moveTo left top path lineTo right top path lineTo right bottom path lineTo left bottom path close if Build VERSION SDK_INT Build VERSION_CODES KITKAT path2 reset path2 moveTo left BOUNDARY_WIDTH top BOUNDARY_WIDTH path2 lineTo right BOUNDARY_WIDTH top BOUNDARY_WIDTH path2 lineTo right BOUNDARY_WIDTH bottom BOUNDARY_WIDTH path2 lineTo left BOUNDARY_WIDTH bottom BOUNDARY_WIDTH path2 close path op path2 Path Op DIFFERENCE path2 reset path2 moveTo left top path2 lineTo left textWidth top path2 lineTo left textWidth top textHeight path2 lineTo left top textHeight path2 close path op path2 Path Op UNION paint setColor Color BLACK paint setAlpha int alpha 0 5f paint setStyle Paint Style FILL canvas drawPath path paint else paint setColor Color BLACK paint setAlpha int alpha 0 5f paint setStrokeWidth BOUNDARY_WIDTH 2 paint setStyle Paint Style STROKE canvas drawPath path paint paint setStyle Paint Style FILL canvas drawRect left top left textWidth top textHeight paint paint setColor Color WHITE paint setAlpha alpha canvas drawText text left tcx top tcy paint @Override
3 67 public void setAlpha @IntRange from 0 to 255 int alpha this alpha alpha @Override
3 67 public void setColorFilter @Nullable ColorFilter colorFilter @Override
3 67 public int getOpacity return PixelFormat TRANSLUCENT
3 67 private static float dp2px float dipValue final float scale Resources getSystem getDisplayMetrics density return dipValue scale 0 5f
3 67 private static float sp2px float spValue final float fontScale Resources getSystem getDisplayMetrics scaledDensity return spValue fontScale 0
4 68 public class ActionPanel extends JPanel
4 68 private ActionData actionData
4 68 private JPanel extraPanel new JPanel
4 68 private ActionTypeSelector actionTypeSelector new ActionTypeSelector
4 68 private boolean atomicOperationFlag false
4 68 private EventSelector eventSelector
4 68 private ItemSelector itemSelector
4 68 private StoreSelector storeSelector
4 68 private FeedbackInputField extraTextField
4 68 private static final long serialVersionUID 1L
4 68 public ActionPanel ActionData a actionData a buildActionTypeSelector add new JLabel actionData getId in actionData getActionsetId add actionTypeSelector add extraPanel onActionTypeChange
4 68 protected void buildActionTypeSelector actionTypeSelector reload actionTypeSelector setSelectedItem actionData getAction actionTypeSelector addActionListener new ActionListener
4 68 public void actionPerformed ActionEvent arg0 if atomicOperationFlag return onActionTypeChange
4 68 protected void onActionTypeChange String action String actionTypeSelector getSelectedItem actionData setAction action commit extraPanel removeAll if event equals action buildEventAction else if item equals action buildItemAction else if store equals action buildStoreAction else if dresser equals action repaint
4 68 protected void buildEventAction int eventId 1 try eventId Integer parseInt actionData getOptions catch NumberFormatException e actionData setOptions 1 actionData commit if eventSelector null eventSelector new EventSelector eventSelector addActionListener new ActionListener
4 68 public void actionPerformed ActionEvent arg0 if atomicOperationFlag return onEventChange atomicOperationFlag true eventSelector reload eventSelector setSelectedItem Event get eventId atomicOperationFlag false extraPanel add eventSelector
4 68 protected void onEventChange int eventId Event eventSelector getSelectedItem getNumber actionData setOptions eventId actionData commit
4 68 protected void buildItemAction int itemId 1 quantity 1 try String pieces actionData getOptions split itemId Integer parseInt pieces 0 quantity Integer parseInt pieces 1 catch Exception e actionData setOptions itemId quantity actionData commit if itemSelector null itemSelector new ItemSelector itemSelector addActionListener new ActionListener
4 68 public void actionPerformed ActionEvent arg0 if atomicOperationFlag return onItemChange extraTextField new FeedbackInputField extraTextField setPreferredSize new Dimension 20 20 extraTextField addActionListener new ActionListener
4 68 public void actionPerformed ActionEvent arg0 onQuantityChange atomicOperationFlag true itemSelector reload itemSelector setSelectedItem ItemInfo get itemId extraTextField setSavedValue quantity extraTextField setText quantity atomicOperationFlag false extraPanel add extraTextField extraPanel add new JLabel x extraPanel add itemSelector
4 68 protected void onItemChange int itemId ItemInfo itemSelector getSelectedItem getId String quantity extraTextField getSavedValue actionData setOptions itemId quantity actionData commit
4 68 protected void onQuantityChange int quantity 1 try quantity Integer parseInt extraTextField getText catch NumberFormatException e extraTextField setText quantity extraTextField setSavedValue quantity int itemId ItemInfo itemSelector getSelectedItem getId actionData setOptions itemId quantity actionData commit
4 68 protected void buildStoreAction int storeId 1 try storeId Integer parseInt actionData getOptions catch NumberFormatException e actionData setOptions 1 actionData commit if storeSelector null storeSelector new StoreSelector storeSelector addActionListener new ActionListener
4 68 public void actionPerformed ActionEvent arg0 if atomicOperationFlag return onStoreChange atomicOperationFlag true storeSelector reload storeSelector setSelectedItem Store get storeId atomicOperationFlag false extraPanel add storeSelector
4 68 protected void onStoreChange int storeId Store storeSelector getCurrentElement getId actionData setOptions storeId actionData
4 69 public class InteractionEditor extends JFrame
4 69 private List ActionSet actionSets
4 69 private boolean atomicOperationFlag false
4 69 private JLabel actionSetIdsLabel new JLabel ActionSets
4 69 private JPanel centerPanel new JPanel northPanel new JPanel southPanel new JPanel
4 69 private JPanel actionsPanel new JPanel
4 69 private JPanel requirementsPanel new JPanel
4 69 private FeedbackInputField nameField new FeedbackInputField
4 69 private JComboBox String contextCombobox new JComboBox String
4 69 private JComboBox String optionCombobox new JComboBox String
4 69 private static final String viewAllText Show All
4 69 private static final long serialVersionUID 1L
4 69 public InteractionEditor super Interaction Editor buildNorthPanel buildSouthPanel setLayout new BorderLayout add northPanel BorderLayout NORTH add southPanel BorderLayout SOUTH buildCenterPanel JScrollPane scrollPane new JScrollPane centerPanel add scrollPane BorderLayout CENTER pack setVisible true setDefaultCloseOperation DISPOSE_ON_CLOSE
4 69 protected void buildNorthPanel nameField setPreferredSize new Dimension 120 25 nameField addActionListener new ActionListener
4 69 public void actionPerformed ActionEvent arg0 onNameChange northPanel add new JLabel entity northPanel add nameField contextCombobox setEditable true contextCombobox addActionListener new ActionListener
4 69 public void actionPerformed ActionEvent arg0 if atomicOperationFlag arg0 getActionCommand equals comboBoxEdited return onContextChange northPanel add new JLabel context northPanel add contextCombobox optionCombobox setEditable true optionCombobox addActionListener new ActionListener
4 69 public void actionPerformed ActionEvent arg0 if atomicOperationFlag arg0 getActionCommand equals comboBoxEdited return onOptionChange northPanel add new JLabel option name northPanel add optionCombobox
4 69 protected void onNameChange String name nameField getText nameField setSavedValue name actionSets ActionSet get name atomicOperationFlag true fillContextCombobox fillOptionCombobox atomicOperationFlag false fillActionsAndRequirements
4 69 protected void onContextChange String name nameField getSavedValue String context String contextCombobox getSelectedItem if context null context isEmpty context equals viewAllText actionSets ActionSet get name else actionSets ActionSet get context name atomicOperationFlag true fillOptionCombobox atomicOperationFlag false fillActionsAndRequirements
4 69 protected void onOptionChange String name nameField getSavedValue String context String contextCombobox getSelectedItem String option String optionCombobox getSelectedItem if option null option isEmpty optionCombobox setSelectedItem option viewAllText if context null context isEmpty contextCombobox setSelectedItem context viewAllText if viewAllText equals context actionSets ActionSet get context name else actionSets ActionSet get name if viewAllText equals option filterActionSets option if actionSets isEmpty if name null name isEmpty viewAllText equals context return new ActionSet setName name setContext context setOption option commit actionSets ActionSet get context name filterActionSets option fillActionsAndRequirements
4 69 protected void buildSouthPanel JButton addActionButton new JButton Add Action addActionButton addActionListener new ActionListener
4 69 public void actionPerformed ActionEvent arg0 onAddAction southPanel add addActionButton JButton addRequirementButton new JButton Add Requirement addRequirementButton addActionListener new ActionListener
4 69 public void actionPerformed ActionEvent arg0 onAddRequirement southPanel add addRequirementButton
4 69 protected void onAddAction if actionSets size 1 JOptionPane showMessageDialog this Please filter a single actionset to add this action to return int actionSetId actionSets get 0 getId new ActionData setActionsetId actionSetId setAction undefined commit fillActionsAndRequirements
4 69 protected void onAddRequirement if actionSets size 1 JOptionPane showMessageDialog this Please filter a single actionset to add this requirement to return int actionSetId actionSets get 0 getId new RequirementData setActionsetId actionSetId setRequirement undefined commit fillActionsAndRequirements
4 69 protected void buildCenterPanel centerPanel setLayout new BoxLayout centerPanel BoxLayout Y_AXIS centerPanel add actionSetIdsLabel JPanel jp new JPanel jp setLayout new BoxLayout jp BoxLayout X_AXIS centerPanel add jp actionsPanel setLayout new BoxLayout actionsPanel BoxLayout Y_AXIS jp add actionsPanel requirementsPanel setLayout new BoxLayout requirementsPanel BoxLayout Y_AXIS jp add requirementsPanel
4 69 protected void filterActionSets String option ActionSet foundActionSet null for ActionSet actionSet actionSets if actionSet getOption equals option foundActionSet actionSet break actionSets new ArrayList ActionSet if foundActionSet null actionSets add foundActionSet
4 69 protected void fillContextCombobox List String contexts new ArrayList String for ActionSet actionSet actionSets if contexts contains actionSet getContext contexts add actionSet getContext contextCombobox removeAllItems contextCombobox addItem viewAllText for String context contexts contextCombobox addItem context
4 69 protected void fillOptionCombobox optionCombobox removeAllItems optionCombobox addItem viewAllText for ActionSet actionSet actionSets optionCombobox addItem actionSet getOption
4 69 protected void fillActionsAndRequirements List Integer actionSetIds new ArrayList Integer actionsPanel removeAll actionsPanel add new JLabel Actions requirementsPanel removeAll requirementsPanel add new JLabel Requirements for ActionSet actionSet actionSets for ActionData actionData ActionData get actionSet getId actionsPanel add new ActionPanel actionData for RequirementData requirementData RequirementData get actionSet getId requirementsPanel add new RequirementPanel requirementData actionSetIds add actionSet getId actionSetIdsLabel setText ActionSet IDs actionSetIds
4 70 public class RequirementPanel extends JPanel
4 70 private RequirementData requirementData
4 70 private JPanel extraPanel new JPanel
4 70 private RequirementTypeSelector requirementTypeSelector new RequirementTypeSelector
4 70 private boolean atomicOperationFlag false
4 70 private EventSelector eventSelector
4 70 private FeedbackInputField pokedexCountField
4 70 private static final long serialVersionUID 1L
4 70 public RequirementPanel RequirementData r requirementData r buildRequirementTypeSelector add new JLabel requirementData getId in requirementData getActionsetId add requirementTypeSelector add extraPanel onRequirementTypeChange
4 70 protected void buildRequirementTypeSelector requirementTypeSelector reload requirementTypeSelector setSelectedItem requirementData getRequirement requirementTypeSelector addActionListener new ActionListener
4 70 public void actionPerformed ActionEvent e onRequirementTypeChange
4 70 protected void onRequirementTypeChange String requirement String requirementTypeSelector getSelectedItem requirementData setRequirement requirement commit extraPanel removeAll if event equals requirement buildEventRequirement else if pokedex equals requirement buildPokedexRequirement revalidate
4 70 protected void buildEventRequirement int eventId 1 try eventId Integer parseInt requirementData getOptions catch NumberFormatException e requirementData setOptions 1 requirementData commit if eventSelector null eventSelector new EventSelector eventSelector addActionListener new ActionListener
4 70 public void actionPerformed ActionEvent arg0 if atomicOperationFlag return onEventChange atomicOperationFlag true eventSelector reload eventSelector setSelectedItem Event get eventId atomicOperationFlag false extraPanel add eventSelector
4 70 protected void onEventChange int eventId Event eventSelector getSelectedItem getNumber requirementData setOptions eventId requirementData commit
4 70 protected void buildPokedexRequirement int pokedexCount 0 try pokedexCount Integer parseInt requirementData getOptions catch NumberFormatException e requirementData setOptions 0 requirementData commit if pokedexCountField null pokedexCountField new FeedbackInputField pokedexCountField setPreferredSize new Dimension 40 20 pokedexCountField addActionListener new ActionListener
4 70 public void actionPerformed ActionEvent arg0 onPokedexCountChange pokedexCountField setSavedValue pokedexCount pokedexCountField setText pokedexCount extraPanel add pokedexCountField
4 70 protected void onPokedexCountChange try int pokedexCount Integer parseInt pokedexCountField getText requirementData setOptions pokedexCount requirementData commit pokedexCountField setSavedValue pokedexCount catch NumberFormatException e pokedexCountField setText pokedexCountField
4 71 public class EventEditor implements MapEditComponent
4 71 public static final String BUTTON_NAME Events
4 71 public EventEditor JButton newEvent new JPokemonButton New newEvent addActionListener new ActionListener
4 71 public void actionPerformed ActionEvent arg0 onClickNewEvent editorPanel add newEvent eventSelector addActionListener new ActionListener
4 71 public void actionPerformed ActionEvent arg0 onEventSelect editorPanel add eventSelector descriptionField setPreferredSize new Dimension 160 20 descriptionField addActionListener new ActionListener
4 71 public void actionPerformed ActionEvent arg0 onDescriptionFieldEnter editorPanel add descriptionField @Override
4 71 public JPanel getEditor readyToEdit false eventSelector reload if eventSelector getCurrentElement null descriptionField setText eventSelector getCurrentElement getDescription readyToEdit true return editorPanel @Override
4 71 public Dimension getSize return new Dimension 200 100
4 71 private void onClickNewEvent Event createNew getEditor
4 71 private void onEventSelect if readyToEdit return getEditor
4 71 private void onDescriptionFieldEnter if readyToEdit return Event event eventSelector getCurrentElement String description descriptionField getText event setDescription description event commit getEditor
4 71 private boolean readyToEdit false
4 71 private JPanel editorPanel new JPanel
4 71 private JTextField descriptionField new JTextField
4 71 private EventSelector eventSelector new
4 72 public interface MapEditComponent
4 72 public JPanel getEditor
4 72 public Dimension
4 73 public class MapEditWindow extends JFrame
4 73 public MapEditWindow components put WildPokemonEditor BUTTON_NAME new WildPokemonEditor components put EventEditor BUTTON_NAME new EventEditor setLayout new BorderLayout JPanel sectionPanel new JPanel for String component components keySet sectionPanel add new ComponentButton component add sectionPanel BorderLayout NORTH setDefaultCloseOperation DISPOSE_ON_CLOSE setSize MINIMUM_WIDTH 80 setVisible true
4 73 private void onClickComponentButton String name if currentView null remove currentView MapEditComponent mec components get name if mec null currentView mec getEditor add currentView BorderLayout CENTER Dimension d mec getSize d setSize Math max d width MINIMUM_WIDTH d height 80 setSize d repaint
4 73 private class ComponentButton extends JButton implements ActionListener
4 73 public ComponentButton String name super name addActionListener this
4 73 public void actionPerformed ActionEvent arg0 onClickComponentButton getText
4 73 private static final long serialVersionUID 1L
4 73 private JPanel currentView null
4 73 private Map String MapEditComponent components new HashMap String MapEditComponent
4 73 private static final int MINIMUM_WIDTH 1140
4 73 private static final long serialVersionUID
4 74 public class NPCEditor implements MapEditComponent
4 74 public static final String BUTTON_NAME NPCs
4 74 public NPCEditor JPanel northPanel new JPanel npcSelector addActionListener new ActionListener
4 74 public void actionPerformed ActionEvent arg0 onClickSelectNPC northPanel add npcSelector JButton newNPC new JPokemonButton New newNPC addActionListener new ActionListener
4 74 public void actionPerformed ActionEvent arg0 NPCEditor this onClickNewNPC northPanel add newNPC JPanel eastPanel new JPanel eastPanel setLayout new BoxLayout eastPanel BoxLayout Y_AXIS eastPanel add new JPanel npcTypeSelector addActionListener new ActionListener
4 74 public void actionPerformed ActionEvent arg0 onClickNPCType eastPanel add npcTypeSelector eastPanel add new JPanel JPanel centerPanel new JPanel centerPanel setLayout new BoxLayout centerPanel BoxLayout Y_AXIS centerPanel add new JPanel centerPanel add iconLabel centerPanel add new JPanel JPanel nameAndTypeName new JPanel nameAndTypeName setLayout new BoxLayout nameAndTypeName BoxLayout X_AXIS nameAndTypeName add typeNameLabel nameField setMinimumSize new Dimension 75 16 nameField setMaximumSize new Dimension 75 16 nameField addActionListener new ActionListener
4 74 public void actionPerformed ActionEvent arg0 onEnterNewNPCName nameAndTypeName add nameField useTypePrefix addActionListener new ActionListener
4 74 public void actionPerformed ActionEvent arg0 onClickUseTypePrefix nameAndTypeName add useTypePrefix centerPanel add nameAndTypeName centerPanel add new JPanel editorPanel setLayout new BorderLayout editorPanel add northPanel BorderLayout NORTH editorPanel add eastPanel BorderLayout EAST editorPanel add centerPanel BorderLayout CENTER @Override
4 74 public JPanel getEditor readyToEdit false npcSelector reload npcTypeSelector reload iconLabel setIcon ImageLoader npc npcSelector getCurrentElement getIcon if npcSelector getCurrentElement getName contains typename useTypePrefix setSelected true typeNameLabel setText npcSelector getCurrentElement getNPCType getName else useTypePrefix setSelected false typeNameLabel setText null nameField setText npcSelector getCurrentElement getName replaceAll typename readyToEdit true return editorPanel @Override
4 74 public Dimension getSize return new Dimension 480 120
4 74 private void onClickSelectNPC if readyToEdit return getEditor
4 74 private void onClickNewNPC NPC createNew getEditor
4 74 private void onEnterNewNPCName if readyToEdit return String name nameField getText if useTypePrefix isSelected name typename name npcSelector getCurrentElement setName name commitChange getEditor
4 74 private void onClickNPCType if readyToEdit return npcSelector getCurrentElement setType npcTypeSelector getCurrentElement getNumber commitChange getEditor
4 74 private void onClickUseTypePrefix if readyToEdit return NPC currentNPC npcSelector getCurrentElement if useTypePrefix isSelected currentNPC setName typename currentNPC getName else currentNPC setName currentNPC getName replaceAll typename commitChange getEditor
4 74 private void commitChange npcSelector getCurrentElement commit
4 74 private boolean readyToEdit false
4 74 private JPanel editorPanel new JPanel
4 74 private JTextField nameField new JTextField
4 74 private NPCSelector npcSelector new NPCSelector
4 74 private NPCTypeSelector npcTypeSelector new NPCTypeSelector
4 74 private JLabel typeNameLabel new JLabel iconLabel new JLabel
4 74 private JCheckBox useTypePrefix new JCheckBox Use type prefix
4 75 public class NPCTypeEditor implements MapEditComponent
4 75 public static final String BUTTON_NAME NPC Types
4 75 public NPCTypeEditor JPanel northPanel new JPanel npcTypes addActionListener new ActionListener
4 75 public void actionPerformed ActionEvent arg0 onClickSelectNPCType northPanel add npcTypes JButton newNPCType new JButton New newNPCType addActionListener new ActionListener
4 75 public void actionPerformed ActionEvent arg0 onClickNewNPCType northPanel add newNPCType JPanel centerPanel new JPanel centerPanel setLayout new BoxLayout centerPanel BoxLayout Y_AXIS centerPanel add icon JPanel nameAndLabel new JPanel nameAndLabel add new JLabel Type name nameField setMinimumSize new Dimension 75 16 nameField setMaximumSize new Dimension 75 16 nameField addActionListener new ActionListener
4 75 public void actionPerformed ActionEvent arg0 onEnterNewName nameAndLabel add nameField centerPanel add nameAndLabel JPanel iconNameAndLabel new JPanel iconNameAndLabel add new JLabel Icon path iconNameField setMinimumSize new Dimension 75 16 iconNameField setMaximumSize new Dimension 75 16 iconNameField addActionListener new ActionListener
4 75 public void actionPerformed ActionEvent arg0 onEnterNewIconPath iconNameAndLabel add iconNameField centerPanel add iconNameAndLabel editorPanel setLayout new BorderLayout editorPanel add northPanel BorderLayout NORTH editorPanel add centerPanel BorderLayout CENTER @Override
4 75 public JPanel getEditor readyToEdit false NPCType npcType npcTypes removeAllItems allNPCTypes clear for int i 1 npcType NPCType get i null i npcTypes addItem npcType toString allNPCTypes add npcType if allNPCTypes size currentTypeIndex currentNPCType allNPCTypes get currentTypeIndex npcTypes setSelectedIndex currentTypeIndex icon setIcon ImageLoader npc currentNPCType getIcon nameField setText currentNPCType getName iconNameField setText currentNPCType getIcon readyToEdit true return editorPanel @Override
4 75 public Dimension getSize return new Dimension 460 120
4 75 private void onClickSelectNPCType if readyToEdit return currentTypeIndex npcTypes getSelectedIndex getEditor
4 75 private void onClickNewNPCType currentNPCType NPCType createNew currentTypeIndex npcTypes getItemCount getEditor
4 75 private void onEnterNewName if readyToEdit return currentNPCType setName nameField getText commitChange getEditor
4 75 private void onEnterNewIconPath if readyToEdit return currentNPCType setIcon iconNameField getText commitChange getEditor
4 75 private void commitChange currentNPCType commit
4 75 private NPCType currentNPCType
4 75 private int currentTypeIndex 0
4 75 private boolean readyToEdit false
4 75 private JLabel icon new JLabel
4 75 private JPanel editorPanel new JPanel
4 75 private JComboBox npcTypes new JComboBox
4 75 private List NPCType allNPCTypes new ArrayList NPCType
4 75 private JTextField nameField new JTextField iconNameField new
4 76 public class WildPokemonEditor implements MapEditComponent
4 76 public static final String BUTTON_NAME Wild Pokemon
4 76 public WildPokemonEditor JPanel northPanel new JPanel southPanel new JPanel JPanel namePanel new JPanel northPanel add namePanel mapNameTextField setMinimumSize new Dimension 100 16 mapNameTextField setMaximumSize new Dimension 100 16 mapNameTextField setPreferredSize new Dimension 100 16 mapNameTextField addActionListener new LoadAreaHandler namePanel add mapNameTextField JPanel buttonPanel new JPanel buttonPanel setLayout new BoxLayout buttonPanel BoxLayout X_AXIS southPanel add buttonPanel JButton addRow new JPokemonButton Add Row addRow addActionListener new ActionListener
4 76 public void actionPerformed ActionEvent arg0 onSelectAddRow buttonPanel add addRow editorPanel setLayout new BorderLayout editorPanel add northPanel BorderLayout NORTH editorPanel add childContainer BorderLayout CENTER editorPanel add southPanel BorderLayout SOUTH @Override
4 76 public JPanel getEditor readyToEdit false mapNameTextField setText currentMapName childContainer removeAll for WildPokemon wildPokemon WildPokemon get currentMapName childContainer add new WildPokemonPanel wildPokemon editorPanel validate readyToEdit true return editorPanel @Override
4 76 public Dimension getSize return new Dimension 480 480
4 76 private void onSelectAddRow if readyToEdit return WildPokemon wildPokemon new WildPokemon wildPokemon setMap currentMapName try SqlStatement insert wildPokemon execute catch DataConnectionException e e printStackTrace getEditor
4 76 private boolean readyToEdit false
4 76 private String currentMapName null
4 76 private JTextField mapNameTextField new JTextField
4 76 private JPanel editorPanel new JPanel childContainer new JPanel
4 76 private class LoadAreaHandler implements ActionListener @Override
4 76 public void actionPerformed ActionEvent e currentMapName mapNameTextField getText getEditor
4 76 private class WildPokemonPanel extends JPanel
4 76 public WildPokemonPanel WildPokemon wp wildPokemon wp pokemonInfoSelector reload pokemonInfoSelector setSelectedIndex wp getNumber 1 pokemonInfoSelector addActionListener new ActionListener
4 76 public void actionPerformed ActionEvent arg0 onSelectPokemonSelector levelMinField setText wp getLevelmin levelMinField addActionListener new ActionListener
4 76 public void actionPerformed ActionEvent arg0 onSelectLevelMinField levelMaxField setText wp getLevelmax levelMaxField addActionListener new ActionListener
4 76 public void actionPerformed ActionEvent arg0 onSelectLevelMaxField flexField setText wp getFlex flexField addActionListener new ActionListener
4 76 public void actionPerformed ActionEvent arg0 onSelectFlexField add pokemonInfoSelector add new JPanel add new JLabel Levels add levelMinField add new JLabel add levelMaxField add new JPanel add new JLabel Flex add flexField
4 76 private void onSelectPokemonSelector int oldNumber wildPokemon getNumber int newNumber pokemonInfoSelector getCurrentElement getNumber wildPokemon setNumber newNumber try SqlStatement update wildPokemon where map eq wildPokemon getMap and number eq oldNumber execute catch DataConnectionException e e printStackTrace getEditor
4 76 private void onSelectLevelMinField int newLevelMin Integer parseInt levelMinField getText wildPokemon setLevelmin newLevelMin try SqlStatement update wildPokemon where map eq wildPokemon getMap and number eq wildPokemon getNumber execute catch DataConnectionException e e printStackTrace getEditor
4 76 private void onSelectLevelMaxField int newLevelMax Integer parseInt levelMaxField getText wildPokemon setLevelmax newLevelMax try SqlStatement update wildPokemon where map eq wildPokemon getMap and number eq wildPokemon getNumber execute catch DataConnectionException e e printStackTrace getEditor
4 76 private void onSelectFlexField int newFlex Integer parseInt flexField getText wildPokemon setFlex newFlex try SqlStatement update wildPokemon where map eq wildPokemon getMap and number eq wildPokemon getNumber execute catch DataConnectionException e e printStackTrace getEditor
4 76 private WildPokemon wildPokemon
4 76 private JTextField flexField new JTextField
4 76 private JTextField levelMinField new JTextField
4 76 private JTextField levelMaxField new JTextField
4 76 private PokemonInfoSelector pokemonInfoSelector new PokemonInfoSelector
4 76 private static final long serialVersionUID
4 77 public class OwnedPokemonPanel extends JPanel
4 77 public OwnedPokemonPanel PartyEditorPanel pep Pokemon p super new BorderLayout parent pep pokemon p add new JLabel ImageLoader pokemon p number BorderLayout WEST add new JLabel p name Lvl p level BorderLayout CENTER editButton addMouseListener new EditHandler add editButton BorderLayout EAST
4 77 private Pokemon pokemon
4 77 private PartyEditorPanel parent
4 77 private JLabel editButton new JLabel ImageLoader find ui arrow_right
4 77 private static final long serialVersionUID 1L
4 77 private class EditHandler extends MouseAdapter @Override
4 77 public void mouseClicked MouseEvent e parent showEditPokemon
4 78 public class PartyEditorPanel extends JPanel
4 78 public static int defaultlevel 25
4 78 public PartyEditorPanel SaveGeneratorWindow sgw super new BorderLayout parent sgw JPanel bodyPanel new JPanel bodyPanel setLayout new BorderLayout bodyPanel setPreferredSize new Dimension 250 300 add bodyPanel BorderLayout CENTER bodyPanel add new JLabel Party BorderLayout NORTH partyPanel setLayout new BoxLayout partyPanel BoxLayout Y_AXIS JScrollPane scrollPane new JScrollPane partyPanel bodyPanel add scrollPane BorderLayout CENTER JPanel southPanel new JPanel bodyPanel add southPanel BorderLayout SOUTH showAddPokemon addMouseListener new AddPokemonHandler southPanel add showAddPokemon
4 78 public void showEditPokemon Pokemon p remove pokemonSelectorPanel add pokemonDetailsPanel BorderLayout EAST pokemonDetailsPanel show p callParentRefresh
4 78 public void showAddPokemon remove pokemonDetailsPanel add pokemonSelectorPanel BorderLayout EAST callParentRefresh
4 78 public void addPokemon PokemonInfo pi Pokemon pokemon new Pokemon pi getNumber defaultlevel parent getPlayer add pokemon callParentRefresh
4 78 public void removePokemon Pokemon p parent getPlayer party remove p callParentRefresh
4 78 public void callParentRefresh parent refresh
4 78 public void refresh partyPanel removeAll for Pokemon p parent getPlayer party partyPanel add new OwnedPokemonPanel this p
4 78 private SaveGeneratorWindow parent
4 78 private JPanel partyPanel new JPanel
4 78 private JLabel showAddPokemon new JLabel ImageLoader find ui plus
4 78 private PokemonDetailsPanel pokemonDetailsPanel new PokemonDetailsPanel this
4 78 private PokemonSearchPanel pokemonSelectorPanel new PokemonSearchPanel this
4 78 public static final long serialVersionUID 1L
4 78 private class AddPokemonHandler extends MouseAdapter @Override
4 78 public void mousePressed MouseEvent e
4 79 public class PlayerDetailsPanel extends JPanel
4 79 public PlayerDetailsPanel SaveGeneratorWindow sgw super parent sgw setLayout new BoxLayout this BoxLayout Y_AXIS setPreferredSize new Dimension 200 300 add usernameLabel add cashLabel add badgeLabel JPanel playerPanel new JPanel playerPanel setLayout new BoxLayout playerPanel BoxLayout X_AXIS playerPanel add new JLabel Edit player editPlayer addMouseListener new EditPlayerHandler playerPanel add editPlayer add playerPanel JPanel partyPanel new JPanel partyPanel setLayout new BoxLayout partyPanel BoxLayout X_AXIS partyPanel add new JLabel Edit party editParty addMouseListener new EditPartyHandler partyPanel add editParty add partyPanel JPanel downloadPanel new JPanel saveFile addMouseListener new SaveHandler downloadPanel add saveFile add downloadPanel refresh
4 79 public void refresh usernameLabel setText name parent getPlayer id cashLabel setText cash parent getPlayer getCash badgeLabel setText badges parent getPlayer getBadgeCount
4 79 private SaveGeneratorWindow parent
4 79 private JLabel usernameLabel new JLabel
4 79 private JLabel cashLabel new JLabel
4 79 private JLabel badgeLabel new JLabel
4 79 private JLabel editParty new JLabel ImageLoader find ui arrow_right
4 79 private JLabel editPlayer new JLabel ImageLoader find ui arrow_right
4 79 private JLabel saveFile new JLabel ImageLoader find ui download
4 79 public static final long serialVersionUID 1L
4 79 private class EditPartyHandler extends MouseAdapter @Override
4 79 public void mouseClicked MouseEvent e parent toggleEditParty
4 79 private class EditPlayerHandler extends MouseAdapter @Override
4 79 public void mouseClicked MouseEvent e parent toggleEditPlayer
4 79 private class SaveHandler extends MouseAdapter @Override
4 79 public void mouseClicked MouseEvent e parent
4 80 public class PlayerEditorPanel extends JPanel
4 80 public PlayerEditorPanel SaveGeneratorWindow sgw super setLayout new BoxLayout this BoxLayout Y_AXIS setPreferredSize new Dimension 200 300 JPanel namePanel new JPanel namePanel setLayout new BoxLayout namePanel BoxLayout X_AXIS namePanel add new JLabel Username JTextField nameField new JTextField nameField setMinimumSize new Dimension 100 16 nameField setMaximumSize new Dimension 100 16 nameField getDocument addDocumentListener new SetNameHandler sgw nameField namePanel add nameField add namePanel JPanel cashPanel new JPanel cashPanel setLayout new BoxLayout cashPanel BoxLayout X_AXIS cashPanel add new JLabel Cash JTextField cashField new JTextField cashField setMinimumSize new Dimension 100 16 cashField setMaximumSize new Dimension 100 16 cashField getDocument addDocumentListener new SetCashHandler sgw cashField cashPanel add cashField add cashPanel JPanel badgePanel new JPanel badgePanel setLayout new BoxLayout badgePanel BoxLayout X_AXIS badgePanel add new JLabel Badges JTextField badgeField new JTextField badgeField setMinimumSize new Dimension 100 16 badgeField setMaximumSize new Dimension 100 16 badgeField getDocument addDocumentListener new SetBadgeHandler sgw badgeField badgePanel add badgeField add badgePanel
4 80 public static final long serialVersionUID
4 81 public class PokemonDetailsPanel extends JPanel
4 81 public PokemonDetailsPanel PartyEditorPanel pep super new BorderLayout parent pep JPanel detailsPanel new JPanel detailsPanel setLayout new BoxLayout detailsPanel BoxLayout Y_AXIS add detailsPanel BorderLayout CENTER detailsPanel add new JPanel JPanel namePanel new JPanel namePanel setLayout new BoxLayout namePanel BoxLayout X_AXIS namePanel add new JLabel Name nameField setPreferredSize new Dimension 100 16 nameField addActionListener new ActionListener
4 81 public void actionPerformed ActionEvent arg0 setName namePanel add nameField detailsPanel add namePanel detailsPanel add new JPanel JPanel levelPanel new JPanel levelPanel setLayout new BoxLayout levelPanel BoxLayout X_AXIS levelPanel add new JLabel Level levelField setPreferredSize new Dimension 100 16 levelField addActionListener new ActionListener
4 81 public void actionPerformed ActionEvent arg0 setLevel levelPanel add levelField detailsPanel add levelPanel detailsPanel add new JPanel movePanel setLayout new BoxLayout movePanel BoxLayout Y_AXIS detailsPanel add movePanel detailsPanel add new JPanel JPanel southPanel new JPanel add southPanel BorderLayout SOUTH deletePokemon addMouseListener new DeletePokemonHandler southPanel add deletePokemon
4 81 public void show Pokemon p pokemon p nameField setText pokemon name levelField setText pokemon level movePanel removeAll AvailableMoveSelector ams MoveInfo amsValue for int i 0 i MoveBlock movecount i ams new AvailableMoveSelector ams reload amsValue null if i pokemon moveCount amsValue MoveInfo get pokemon move i number ams setSelectedItem amsValue ams addActionListener new ActionListener
4 81 public void actionPerformed ActionEvent arg0 setMoves movePanel add ams
4 81 private void setName if pokemon null return String name nameField getText if name isEmpty name null pokemon name name parent callParentRefresh
4 81 private void setLevel if pokemon null return String level levelField getText if level isEmpty return pokemon level Integer parseInt level parent callParentRefresh
4 81 private void setMoves pokemon removeAllMoves MoveInfo mi AvailableMoveSelector ams for Component c movePanel getComponents if c instanceof AvailableMoveSelector continue ams AvailableMoveSelector c mi ams getCurrentElement if mi null continue try pokemon addMove mi getNumber catch IllegalArgumentException e ams setSelectedItem null
4 81 private Pokemon pokemon
4 81 private PartyEditorPanel parent
4 81 private JPanel movePanel new JPanel
4 81 private JTextField nameField new JTextField
4 81 private JTextField levelField new JTextField
4 81 private JLabel deletePokemon new JLabel ImageLoader find ui minus
4 81 private class DeletePokemonHandler extends MouseAdapter @Override
4 81 public void mouseClicked MouseEvent e parent removePokemon pokemon
4 81 private class AvailableMoveSelector extends JPokemonSelector MoveInfo @Override
4 81 protected void reloadItems removeAllItems for MoveMap movemap MoveMap get pokemon number addElementToModel MoveInfo get movemap getMove_number
4 81 protected void renderElement Component c MoveInfo element JLabel c setText element getName
4 81 private static final long serialVersionUID 1L
4 81 private static final long serialVersionUID
4 82 public class PokemonSearchPanel extends JPanel
4 82 private static final String nameFieldDefault Search by name
4 82 public PokemonSearchPanel PartyEditorPanel pep super new BorderLayout parent pep setPreferredSize new Dimension 250 300 setFocusable true searchFieldPanel setFocusable true searchFieldPanel setLayout new BorderLayout add searchFieldPanel BorderLayout NORTH nameField setPreferredSize new Dimension 100 16 nameField addFocusListener new FieldFocuser nameField nameFieldDefault nameField getDocument addDocumentListener new DocumentListener
4 82 public void changedUpdate DocumentEvent arg0 nameFieldSearch
4 82 public void insertUpdate DocumentEvent arg0 nameFieldSearch
4 82 public void removeUpdate DocumentEvent arg0 nameFieldSearch searchFieldPanel add nameField BorderLayout WEST typeSelector reload typeSelector addActionListener new ActionListener
4 82 public void actionPerformed ActionEvent arg0 typeSelectorSearch searchFieldPanel add typeSelector BorderLayout EAST searchResultsPanel setLayout new BoxLayout searchResultsPanel BoxLayout Y_AXIS JScrollPane scrollPane new JScrollPane searchResultsPanel add scrollPane BorderLayout CENTER
4 82 public void selectPokemon PokemonInfo pi parent addPokemon pi
4 82 private void nameFieldSearch String nameFieldText nameField getText toLowerCase if nameFieldText equals nameFieldDefault toLowerCase return searchResultsPanel removeAll typeSelector setSelectedItem null PokemonInfo pokemonInfo for int i 1 pokemonInfo PokemonInfo get i null i if pokemonInfo getName toLowerCase contains nameFieldText searchResultsPanel add new SelectablePokemonPanel this pokemonInfo parent validate parent repaint
4 82 private void typeSelectorSearch Type selectedType typeSelector getCurrentElement if selectedType null return searchResultsPanel removeAll nameField setText nameFieldDefault Type t1 t2 PokemonInfo pokemonInfo for int i 1 pokemonInfo PokemonInfo get i null i t1 Type valueOf pokemonInfo getType1 t2 Type valueOf pokemonInfo getType2 if selectedType t1 selectedType t2 searchResultsPanel add new SelectablePokemonPanel this pokemonInfo parent validate parent repaint
4 82 private PartyEditorPanel parent
4 82 private JPanel searchFieldPanel new JPanel
4 82 private JPanel searchResultsPanel new JPanel
4 82 private JTextField nameField new JTextField nameFieldDefault
4 82 private TypeSelector typeSelector new TypeSelector
4 82 private static class FieldFocuser implements FocusListener
4 82 public FieldFocuser JTextField jtf String s field jtf blankText s @Override
4 82 public void focusGained FocusEvent arg0 if field getText equals blankText field setText @Override
4 82 public void focusLost FocusEvent arg0 if field getText isEmpty field setText blankText
4 82 private String blankText
4 82 private JTextField field
4 82 public static final long serialVersionUID
4 83 public class SaveGeneratorWindow extends JFrame
4 83 public SaveGeneratorWindow super setLayout new BorderLayout add playerDetailsPanel BorderLayout CENTER setVisible true setDefaultCloseOperation DISPOSE_ON_CLOSE refresh
4 83 public Player getPlayer return player
4 83 public void loadOrSetName String name File file new File name jpkmn if file exists player new Player undefined try player loadXML XmlParser parse file get 0 catch FileNotFoundException e else player getLocation setMap house
4 83 public void savePlayer String playerName player id if playerName null playerName length 0 JOptionPane showMessageDialog this You haven t yet provided a name for the player Can t Save Player JOptionPane WARNING_MESSAGE return File file new File player id jpkmn try Writer writer new BufferedWriter new PrintWriter file writer write player toXml printToString 0 writer close catch IOException e e printStackTrace
4 83 public void toggleEditParty boolean containsEditorPanel false remove playerEditorPanel for Component c getContentPane getComponents if c partyEditorPanel containsEditorPanel true break if containsEditorPanel remove partyEditorPanel else add partyEditorPanel BorderLayout EAST refresh
4 83 public void toggleEditPlayer boolean containsEditorPanel false remove partyEditorPanel for Component c getContentPane getComponents if c playerEditorPanel containsEditorPanel true break if containsEditorPanel remove playerEditorPanel else add playerEditorPanel BorderLayout EAST refresh
4 83 public void refresh playerDetailsPanel refresh partyEditorPanel refresh pack repaint
4 83 private Player player new Player undefined
4 83 private PlayerDetailsPanel playerDetailsPanel new PlayerDetailsPanel this
4 83 private PartyEditorPanel partyEditorPanel new PartyEditorPanel this
4 83 private PlayerEditorPanel playerEditorPanel new PlayerEditorPanel this
4 83 public static final long serialVersionUID
4 84 public class SelectablePokemonPanel extends JPanel
4 84 public SelectablePokemonPanel PokemonSearchPanel psp PokemonInfo pi super new BorderLayout parent psp pokemonInfo pi add new JLabel ImageLoader pokemon pi getNumber BorderLayout WEST add new JLabel pi getName BorderLayout CENTER addButton addMouseListener new MouseHandler add addButton BorderLayout EAST
4 84 private PokemonInfo pokemonInfo
4 84 private PokemonSearchPanel parent
4 84 private JLabel addButton new JLabel ImageLoader find ui plus
4 84 private static final long serialVersionUID 1L
4 84 private class MouseHandler extends MouseAdapter @Override
4 84 public void mouseClicked MouseEvent e parent selectPokemon
4 85 public abstract class AbstractInputHandler implements DocumentListener
4 85 protected JTextField boundTextField
4 85 protected SaveGeneratorWindow boundWindow
4 85 public AbstractInputHandler SaveGeneratorWindow window JTextField textField this boundWindow window this boundTextField textField @Override
4 85 public void insertUpdate DocumentEvent e updateParent @Override
4 85 public void removeUpdate DocumentEvent e updateParent @Override
4 85 public void changedUpdate DocumentEvent e
4 85 protected abstract void
4 86 public class SetBadgeHandler extends AbstractInputHandler
4 86 public SetBadgeHandler SaveGeneratorWindow window JTextField textField super window textField @Override
4 86 public void updateParent String badgeText this boundTextField getText Integer badgeVal Integer parseInt badgeText this boundWindow getPlayer setBadgeCount badgeVal this boundWindow
4 87 public class SetCashHandler extends AbstractInputHandler
4 87 public SetCashHandler SaveGeneratorWindow window JTextField textField super window textField @Override
4 87 public void updateParent String cashText this boundTextField getText Integer cashVal Integer parseInt cashText this boundWindow getPlayer setCash cashVal this boundWindow
4 88 public class SetNameHandler extends AbstractInputHandler
4 88 public SetNameHandler SaveGeneratorWindow window JTextField textField super window textField @Override
4 88 public void updateParent this boundWindow loadOrSetName this boundTextField getText this boundWindow
4 89 public class InventoryPanel extends JPanel
4 89 private Inventory inventory
4 89 private ItemSelector itemSelector new ItemSelector
4 89 private FeedbackInputField priceField new FeedbackInputField
4 89 private FeedbackInputField availableField new FeedbackInputField
4 89 private FeedbackInputField denominationField new FeedbackInputField
4 89 private FeedbackInputField purchaseField new FeedbackInputField
4 89 private static final long serialVersionUID 1L
4 89 public InventoryPanel Inventory i inventory i buildItemSelector buildPriceField buildPurchaseField buildDenominationField buildAvailableField
4 89 protected void buildItemSelector itemSelector reload itemSelector setSelectedIndex inventory getItem 1 itemSelector addActionListener new ActionListener
4 89 public void actionPerformed ActionEvent arg0 onItemSelect add itemSelector
4 89 protected void onItemSelect int newItemId itemSelector getCurrentElement getId inventory setItem newItemId inventory commit revalidate
4 89 protected void buildPriceField String priceString inventory getPrice priceField setText priceString priceField setSavedValue priceString priceField setPreferredSize new Dimension 40 20 priceField addActionListener new ActionListener
4 89 public void actionPerformed ActionEvent arg0 onPriceChange add new JLabel Price add priceField
4 89 protected void onPriceChange try int newPrice Integer parseInt priceField getText priceField setSavedValue newPrice inventory setPrice newPrice inventory commit validate catch NumberFormatException e priceField setText priceField getSavedValue
4 89 protected void buildPurchaseField String purchaseString inventory getPurchaseprice purchaseField setText purchaseString purchaseField setSavedValue purchaseString purchaseField setPreferredSize new Dimension 40 20 purchaseField addActionListener new ActionListener
4 89 public void actionPerformed ActionEvent arg0 onPurchaseChange add new JLabel Purchase add purchaseField
4 89 protected void onPurchaseChange try int newPurchase Integer parseInt purchaseField getText purchaseField setSavedValue newPurchase inventory setPurchaseprice newPurchase inventory commit validate catch NumberFormatException e purchaseField setText purchaseField getSavedValue
4 89 protected void buildDenominationField String denominationString inventory getDenomination denominationField setText denominationString denominationField setSavedValue denominationString denominationField setPreferredSize new Dimension 40 20 denominationField addActionListener new ActionListener
4 89 public void actionPerformed ActionEvent arg0 onDenominationChange add new JLabel Per add denominationField
4 89 protected void onDenominationChange try int newDenomination Integer parseInt denominationField getText denominationField setSavedValue newDenomination inventory setDenomination newDenomination inventory commit validate catch NumberFormatException e denominationField setText denominationField getSavedValue
4 89 protected void buildAvailableField String availableString inventory getAvailable availableField setText availableString availableField setSavedValue availableString availableField setPreferredSize new Dimension 40 20 availableField addActionListener new ActionListener
4 89 public void actionPerformed ActionEvent arg0 onAvailableChange add new JLabel Available add availableField
4 89 protected void onAvailableChange try int newAvailable Integer parseInt availableField getText availableField setSavedValue newAvailable inventory setAvailable newAvailable inventory commit validate catch NumberFormatException e availableField setText availableField
4 90 public class StoreEditor extends JFrame
4 90 private boolean readyToEdit false
4 90 private StoreSelector storeSelector new StoreSelector
4 90 private FeedbackInputField storeNameTextField new FeedbackInputField
4 90 private JPanel centerPanel new JPanel northPanel new JPanel southPanel new JPanel
4 90 private static final long serialVersionUID 1L
4 90 public StoreEditor super Store Editor buildNorthPanel buildSouthPanel setLayout new BorderLayout add northPanel BorderLayout NORTH add southPanel BorderLayout SOUTH centerPanel setLayout new BoxLayout centerPanel BoxLayout Y_AXIS JScrollPane scrollPane new JScrollPane centerPanel add scrollPane BorderLayout CENTER pack setVisible true setDefaultCloseOperation DISPOSE_ON_CLOSE readyToEdit true
4 90 protected void buildNorthPanel storeSelector reload storeSelector setSelectedItem null storeSelector addActionListener new ActionListener
4 90 public void actionPerformed ActionEvent arg0 onStoreSelect northPanel add storeSelector storeNameTextField setPreferredSize new Dimension 120 25 storeNameTextField addActionListener new ActionListener
4 90 public void actionPerformed ActionEvent arg0 onStoreRename northPanel add storeNameTextField
4 90 protected void onStoreSelect if readyToEdit return Store store storeSelector getCurrentElement storeNameTextField setText store getName storeNameTextField setSavedValue store getName fillInventory
4 90 protected void onStoreRename String newStoreName storeNameTextField getText if newStoreName null newStoreName isEmpty storeNameTextField setText storeNameTextField getSavedValue return Store store storeSelector getCurrentElement if store null return store setName newStoreName store commit storeNameTextField setSavedValue newStoreName storeSelector repaint
4 90 protected void buildSouthPanel southPanel setLayout new BoxLayout southPanel BoxLayout X_AXIS JButton addStore new JButton Add Store addStore addActionListener new ActionListener
4 90 public void actionPerformed ActionEvent arg0 onAddStore southPanel add addStore JButton addRow new JButton Add Inventory addRow addActionListener new ActionListener
4 90 public void actionPerformed ActionEvent arg0 onAddInventory southPanel add addRow
4 90 protected void onAddStore new Store commit readyToEdit false storeSelector reload readyToEdit true storeSelector setSelectedIndex storeSelector getModel getSize 1 fillInventory
4 90 protected void onAddInventory int storeIndex storeSelector getSelectedIndex int storeId storeSelector getCurrentElement getId Inventory inventory new Inventory inventory setStore storeId inventory commit readyToEdit false storeSelector reload storeSelector setSelectedIndex storeIndex readyToEdit true fillInventory
4 90 protected void fillInventory Store store storeSelector getCurrentElement if store null return centerPanel removeAll for Inventory inventory store getInventory centerPanel add new InventoryPanel inventory revalidate
4 91 public class FeedbackInputField extends JTextField implements DocumentListener
4 91 private String savedValue
4 91 private static final long serialVersionUID 1L
4 91 public FeedbackInputField getDocument addDocumentListener this
4 91 public String getSavedValue return savedValue
4 91 public void setSavedValue String s savedValue s colorBorder
4 91 public void colorBorder String currentValue getText if savedValue null savedValue equals currentValue setBorder BorderFactory createLineBorder Color black else setBorder BorderFactory createLineBorder Color red @Override
4 91 public void changedUpdate DocumentEvent e @Override
4 91 public void insertUpdate DocumentEvent e colorBorder @Override
4 91 public void removeUpdate DocumentEvent e
4 92 public class UtilMain
4 92 public static void main String args new
4 93 public class UtilWindow extends JFrame
4 93 public UtilWindow super JPokemon Server Utilities setDefaultCloseOperation EXIT_ON_CLOSE setLayout new FlowLayout JButton mapEditor new JButton Open Map Editor mapEditor addActionListener new ActionListener
4 93 public void actionPerformed ActionEvent arg0 new MapEditWindow add mapEditor JButton storeEditor new JButton Open Store Editor storeEditor addActionListener new ActionListener
4 93 public void actionPerformed ActionEvent arg0 new StoreEditor add storeEditor JButton interactionEditor new JButton Open Interaction Editor interactionEditor addActionListener new ActionListener
4 93 public void actionPerformed ActionEvent arg0 new InteractionEditor add interactionEditor JButton saveFileEditor new JButton Open Save File Editor saveFileEditor addActionListener new ActionListener
4 93 public void actionPerformed ActionEvent arg0 new SaveGeneratorWindow add saveFileEditor pack setVisible true
4 93 private static final long serialVersionUID
4 94 public class ImageLoader
4 94 public static ImageIcon find String name String path JPokemonServer imagepath name png ImageIcon icon new ImageIcon path return icon
4 94 public static ImageIcon pokemon String number String path JPokemonServer imagepath pokemon number png ImageIcon icon new ImageIcon path return icon
4 94 public static ImageIcon item String type String name String path JPokemonServer imagepath item type toLowerCase if type equalsIgnoreCase ball type equalsIgnoreCase potion type equals stone path name substring 0 1 toLowerCase path png ImageIcon icon new ImageIcon path return icon
4 94 public static ImageIcon npc String type String path JPokemonServer imagepath npc type toLowerCase png ImageIcon icon new ImageIcon path return
4 95 public abstract class JPokemonSelector E extends JComboBox
4 95 private DefaultComboBoxModel model new DefaultComboBoxModel
4 95 private static final long serialVersionUID 1L
4 95 public JPokemonSelector setModel model setRenderer new JPokemonCellRenderer
4 95 public E getCurrentElement return E model getSelectedItem
4 95 public void reload int selectedIndex getSelectedIndex if selectedIndex 0 selectedIndex 0 reloadItems if model getSize selectedIndex setSelectedIndex selectedIndex
4 95 protected abstract void reloadItems
4 95 protected void addElementToModel E element model addElement element
4 95 protected void renderElement Component c E element JLabel c setText element toString
4 95 private class JPokemonCellRenderer extends DefaultListCellRenderer @Override
4 95 public Component getListCellRendererComponent JList list Object o int index boolean isSelected boolean cellHasFocus Component c super getListCellRendererComponent list o index isSelected cellHasFocus E element if index 0 element E model getElementAt index else element E model getSelectedItem if element null renderElement c element return c
4 95 private static final long serialVersionUID
4 96 public class JPokemonButton extends JButton
4 96 public JPokemonButton String s super s this setFocusable false
4 96 public JPokemonButton Icon icon super icon this setFocusable false
4 96 private static final long serialVersionUID
4 97 public class ActionTypeSelector extends JPokemonSelector String @Override @SuppressWarnings unchecked
4 97 protected void reloadItems removeAllItems addItem undefined addItem event addItem heal addItem item addItem store addItem dresser
4 97 private static final long serialVersionUID
4 98 public class EventSelector extends JPokemonSelector Event @Override
4 98 protected void reloadItems removeAllItems Event event for int i 1 event Event get i null i addElementToModel event
4 98 private static final long serialVersionUID
4 99 public class ItemSelector extends JPokemonSelector ItemInfo @Override
4 99 protected void reloadItems removeAllItems ItemInfo item for int i 1 item ItemInfo get i null i addElementToModel item
4 99 protected void renderElement Component c ItemInfo itemInfo JLabel c setText Item itemInfo getId itemInfo getName
4 99 private static final long serialVersionUID
4 100 public class MoveInfoSelector extends JPokemonSelector MoveInfo @Override
4 100 protected void reloadItems removeAllItems MoveInfo moveInfo for int i 1 moveInfo MoveInfo get i null i addElementToModel moveInfo
4 100 private static final long serialVersionUID
4 101 public class NPCActionSetSelector extends JPokemonSelector NPCActionSetMap
4 101 public NPCActionSetSelector int n npcNumber n
4 101 public void setNPCNumber int n npcNumber n @Override
4 101 protected void reloadItems removeAllItems List Integer seenActionSetNumbers new ArrayList Integer for NPCActionSetMap npcActionSetMap NPCActionSetMap getByNPCNumber npcNumber if seenActionSetNumbers contains npcActionSetMap getActionset continue seenActionSetNumbers add npcActionSetMap getActionset addElementToModel npcActionSetMap
4 101 private int npcNumber
4 101 private static final long serialVersionUID
4 102 public class NPCSelector extends JPokemonSelector NPC @Override
4 102 protected void reloadItems removeAllItems NPC npc for int i 1 npc NPC get i null i addElementToModel npc
4 102 private static final long serialVersionUID
4 103 public class NPCTypeSelector extends JPokemonSelector NPCType @Override
4 103 protected void reloadItems removeAllItems NPCType npcType for int i 1 npcType NPCType get i null i addElementToModel npcType
4 103 private static final long serialVersionUID
4 104 public class PokemonInfoSelector extends JPokemonSelector PokemonInfo @Override
4 104 protected void reloadItems removeAllItems PokemonInfo pokemonInfo for int i 1 pokemonInfo PokemonInfo get i null i addElementToModel pokemonInfo
4 104 private static final long serialVersionUID
4 105 public class RequirementTypeSelector extends JPokemonSelector String @Override @SuppressWarnings unchecked
4 105 protected void reloadItems removeAllItems addItem undefined addItem event addItem pokedex
4 105 private static final long serialVersionUID
4 106 public class StoreSelector extends JPokemonSelector Store @Override
4 106 protected void reloadItems removeAllItems Store store for int i 1 store Store get i null i addElementToModel store @Override
4 106 protected void renderElement Component c Store store JLabel c setText Store store getId store getName
4 106 private static final long serialVersionUID
4 107 public class TypeSelector extends JPokemonSelector Type @Override
4 107 protected void reloadItems removeAllItems for Type type Type values addElementToModel type
4 107 private static final long serialVersionUID
4 108 public class Clock implements Runnable
4 108 private static final Queue Calendar times new PriorityQueue Calendar
4 108 private static final Map Calendar Runnable callbacks new HashMap Calendar Runnable
4 108 private static final Calendar clockStart Calendar getInstance
4 108 public static int timespeed 1 static Myna configure Clock class org jpokemon server time new Thread new Clock start
4 108 private Clock
4 108 public static void timeout int seconds Runnable callback Calendar time getGameTime time add Calendar SECOND seconds schedule time callback
4 108 public static void schedule Calendar time Runnable callback synchronized times times add time callbacks put time callback
4 108 public static Calendar getGameTime Calendar realTime Calendar getInstance int timeDiff int realTime getTimeInMillis clockStart getTimeInMillis timespeed Calendar gameTime Calendar clockStart clone gameTime add Calendar MILLISECOND timeDiff return gameTime @Override
4 108 public void run for synchronized times while times isEmpty times peek getTimeInMillis getGameTime getTimeInMillis new Thread callbacks remove times remove start try Thread sleep 1000 timespeed catch InterruptedException
4 109 public interface Activity
4 109 public void onAdd Player player throws ServiceException
4 109 public void logout Player player
4 109 public void onReturn Activity activity Player player
4 109 public void serve JSONObject request Player player throws
4 110 public class SelectMoveFromPokemonActivity implements Activity
4 110 private Pokemon pokemon
4 110 private int moveIndex 1
4 110 public SelectMoveFromPokemonActivity Pokemon p pokemon p
4 110 public int getMoveIndex return moveIndex @Override
4 110 public void onAdd Player player throws ServiceException JSONObject json new JSONObject List JSONObject moves new ArrayList JSONObject try json put action selectmove json put pokemon pokemon name for int i 0 i pokemon moveCount i JSONObject moveJson new JSONObject Move move pokemon move i moveJson put name move name moveJson put pp move pp moveJson put ppMax move ppMax moves add moveJson json put moves new JSONArray moves toString catch JSONException e PlayerManager pushJson player json @Override
4 110 public void logout Player player @Override
4 110 public void onReturn Activity activity Player player @Override
4 110 public void serve JSONObject request Player player throws ServiceException try if request has moveIndex moveIndex request getInt moveIndex PlayerManager popActivity player this else throw new ServiceException Expected move index catch JSONException e throw new ServiceException Expected move
4 111 public class Battle implements Activity Iterable Slot
4 111 public static double stab 1 5
4 111 public static double typeadvantage 2 0
4 111 public static double typedisadvantage 5 static Myna configure Battle class org jpokemon battle
4 111 private List String log new ArrayList String
4 111 private Map String Slot slots new HashMap String Slot
4 111 private Map String Turn turns new HashMap String Turn
4 111 public Battle PokemonTrainer trainers System out println this created for int i 0 i trainers length i PokemonTrainer trainer trainers i addTrainer trainer i doTrainerAttacks
4 111 public void addTrainer PokemonTrainer trainer int team if contains trainer throw new IllegalArgumentException Duplicate trainer trainer slots put trainer id new Slot trainer team System out println this trainer added trainer
4 111 public int getTrainerCount return slots size
4 111 public Slot getSlot String trainerId return slots get trainerId
4 111 public boolean contains PokemonTrainer trainer return slots get trainer id null
4 111 public void remove PokemonTrainer trainer System out println toString remove trainer trainer id if trainer party awake 0 if trainer instanceof Trainer addTrainerToPlayerHistory trainer id else if trainer instanceof Player if trainer instanceof Player Player player Player trainer pushLog false JSONObject json new JSONObject try json put action battle json put visible false catch JSONException e PlayerManager pushJson player json PlayerManager popActivity player this slots remove trainer id verifyTeamCount
4 111 public void addTurn Turn turn turns put turn slot trainer id turn System out println toString turn set turn slot trainer id t turn toString if turns size slots size executeRound @Override
4 111 public void onAdd Player player throws ServiceException PlayerManager pushJson player generateJson @Override
4 111 public void logout Player player @Override
4 111 public void onReturn Activity activity Player player if activity instanceof BuildTurnActivity BuildTurnActivity bta BuildTurnActivity activity Turn turn bta getTurn addTurn turn JSONObject json generateJson for Slot slot this if slot trainer instanceof Player player Player slot trainer PlayerManager pushJson player json @Override
4 111 public void serve JSONObject request Player player throws ServiceException if turns get player id null return try if request has turn String turn request getString turn if attack equals turn PlayerManager addActivity player new BuildAttackTurnActivity this else if item equals turn else if swap equals turn PlayerManager addActivity player new BuildSwapTurnActivity this else if run equals turn PlayerManager addActivity player new BuildRunTurnActivity this catch JSONException e
4 111 public void log String message log add message
4 111 public void pushLog boolean clear JSONObject json new JSONObject try json put action battlelog json put logs new JSONArray log json put clear clear catch JSONException e e printStackTrace for Slot slot this if slot trainer instanceof Player Player player Player slot trainer PlayerManager pushJson player json @Override
4 111 public Iterator Slot iterator return slots values iterator
4 111 public String toString return Battle@ hashCode
4 111 private void executeRound Queue Turn turnQueue new PriorityQueue Turn Map String Turn currentRoundTurns turns turns new HashMap String Turn for Turn turn currentRoundTurns values turnQueue add turn while turnQueue isEmpty Turn turn turnQueue remove turn execute if turn target leader awake log turn target trainer id s turn target leader name fainted Turn turnToRemove currentRoundTurns get turn target trainer id boolean turnWasRemoved turnQueue remove turnToRemove if turn target party awake 0 log turn target trainer id lost remove turn target trainer else if turnWasRemoved log turn target trainer id will auto swap to the next available pokemon turnQueue add SwapTurn autoSwapTurn this turn target if turn slot leader awake remove turn slot trainer else if turn reAdd addTurn turn applyEndOfRoundEffects doTrainerAttacks for Slot slot this if slot leader awake if slot party awake 0 if slot trainer instanceof Player log slot trainer id must swap on the next turn PlayerManager addActivity Player slot trainer new BuildSwapTurnActivity this else addTurn SwapTurn autoSwapTurn this slot else remove slot trainer System out println toString logs log toString pushLog true log new ArrayList String
4 111 private void doTrainerAttacks for Slot slot slots values if slot trainer instanceof Player continue Slot randomSlot do Slot allSlots slots values toArray new Slot slots values size randomSlot allSlots int Math random allSlots length while slot equals randomSlot int randomMoveIndex int Math random slot leader moveCount Move randomMove slot leader move randomMoveIndex addTurn new AttackTurn this slot randomSlot randomMove
4 111 private void verifyTeamCount int curTeam 1 boolean onlyOneTeamLeft true for Slot s this if curTeam 1 curTeam s team else if curTeam s team onlyOneTeamLeft false break JSONObject json new JSONObject try json put action battle json put visible false catch JSONException e if onlyOneTeamLeft while slots isEmpty String slotKey String slots keySet toArray 0 Slot slot slots remove slotKey if slot trainer instanceof Player Player p Player slot trainer PlayerManager pushJson p json PlayerManager popActivity p this
4 111 private void applyEndOfRoundEffects for Slot slot this for Iterator ConditionEffect conditionEffectIterator slot leader getConditionEffects iterator conditionEffectIterator hasNext ConditionEffect conditionEffect conditionEffectIterator next if Math random conditionEffect persistanceChance log slot leader name conditionEffect getPersistanceMessage if conditionEffect damagePercentage 0 int damage int slot leader maxHealth conditionEffect damagePercentage slot leader takeDamage damage log slot leader name took damage damage else log slot leader name conditionEffect getDissipationMessage conditionEffectIterator remove slot applySlotEffects
4 111 private void addTrainerToPlayerHistory String id Player p for Slot s this if s trainer instanceof Player continue p Player s trainer p record putTrainer id
4 111 private JSONObject generateJson JSONObject json new JSONObject try json put action battle json put visible true Map Integer JSONArray teams new HashMap Integer JSONArray for Slot slot this if teams get slot team null teams put slot team new JSONArray JSONObject opponent new JSONObject opponent put id slot trainer id opponent put turn turns get slot trainer id null ready waiting opponent put pokemonName slot leader name opponent put pokemonLevel slot leader level opponent put pokemonNumber slot leader number opponent put pokemonHealth slot leader health opponent put pokemonMaxHealth slot leader maxHealth JSONArray conditionArray new JSONArray for ConditionEffect conditionEffect slot leader getConditionEffects conditionArray put conditionEffect name opponent put pokemonCondition conditionArray teams get slot team put opponent json put teams new JSONArray teams values catch JSONException e return json
4 111 public static int computeDamage Pokemon user Move move Pokemon victim double damage 1 0 L user level A 1 0 P move power D 0 E computeEffectiveness move user victim R Math random 15 85 reps move reps if move style MoveStyle SPECIAL A user specattack D victim specdefense else if move style MoveStyle PHYSICAL A user attack D victim defense else if move style MoveStyle OHKO A 10000000 D 1 else if move style MoveStyle DELAYNEXT move style MoveStyle DELAYBEFORE A Math max user attack user specattack D Math max victim defense victim specdefense damage 2 0 L 5 0 2 0 A P D 50 0 2 0 E R reps if damage 1 E 0 damage 1 return int damage
4 111 public static int confusedDamage Pokemon p double L p level A p attack P 40 D p defense STAB 1 E 1 R 1 00 return int 2 0 L 5 0 2 0 A P D 50 0 2 0 STAB E R
4 111 private static double computeEffectiveness Move move Pokemon user Pokemon victim double answer 1 0 if move type user type1 move type user type2 answer stab if victim type1 null switch move type effectiveness victim type1 case SUPER answer typeadvantage break case NORMAL answer 1 break case NOT_VERY answer typedisadvantage break case IMMUNE answer 0 break if victim type2 null switch move type effectiveness victim type1 case SUPER answer typeadvantage break case NORMAL answer 1 break case NOT_VERY answer typedisadvantage break case IMMUNE answer 0 break return
4 112 public class Reward
4 112 public static double wildxprate 1 0
4 112 public static double npcxprate 1 3
4 112 public static double gymxprate 1 6
4 112 public static double playerxprate 0 0
4 112 public static double otxprate 1 0
4 112 public static double nototxprate 1 5 static Myna configure Reward class org jpokemon battle reward
4 112 public Reward Slot s _pokemon s leader _xp computeXp s trainer _pokemon if s trainer instanceof Player _evs _pokemon effortValues if s party awake 0
4 112 public void xp int amount _xp amount
4 112 public int xp return _xp
4 112 public void effortValues List EffortValue list _evs list
4 112 public List EffortValue effortValues return _evs
4 112 public void pokemon Pokemon p _pokemon p
4 112 public Pokemon pokemon return _pokemon
4 112 public void apply Slot s applyXP s if s trainer instanceof Player PlayerManager pushMessage Player s trainer _faintMessage if _defeatMessage null applyDefeat Player s trainer
4 112 private void applyXP Slot s List Pokemon hitList s removeRival pokemon int xpEach Math max xp hitList size 1 for Pokemon earner hitList if earner hasOriginalTrainer earner xp int earner xp xpEach otxprate else earner xp int earner xp xpEach nototxprate earner addEV effortValues if s trainer instanceof Player s trainer notify
4 112 private void applyDefeat Player player PlayerManager pushMessage player _defeatMessage
4 112 private static int computeXp PokemonTrainer trainer Pokemon pokemon double xp pokemon xpYield xp pokemon level xp 7 if trainer instanceof WildTrainer xp wildxprate else if trainer instanceof Trainer if Trainer trainer isGym xp gymxprate else xp npcxprate else if trainer instanceof Player xp playerxprate return int xp
4 112 private int _xp
4 112 private Pokemon _pokemon
4 112 private Message _faintMessage _defeatMessage
4 112 private ActionSet _actions new ActionSet
4 112 private List EffortValue _evs new ArrayList
4 113 public enum Target SELF ENEMY
4 113 public static Target valueOf int target return target 0 SELF
4 114 public class BuildAttackTurnActivity implements BuildTurnActivity
4 114 private Battle battle
4 114 private int moveIndex 1
4 114 private String slotId targetId
4 114 public BuildAttackTurnActivity Battle b battle b @Override
4 114 public void onAdd Player player throws ServiceException slotId player id PlayerManager addActivity player new SelectMoveFromPokemonActivity player party get 0 @Override
4 114 public void logout Player player @Override
4 114 public void onReturn Activity activity Player player if activity instanceof SelectMoveFromPokemonActivity SelectMoveFromPokemonActivity smflpa SelectMoveFromPokemonActivity activity moveIndex smflpa getMoveIndex if battle getTrainerCount 2 for Slot slot battle if slot trainer id equals player id continue targetId slot trainer id break PlayerManager popActivity player this else String moveName player party get 0 move moveIndex name PlayerManager addActivity player new SelectTargetForMoveActivity moveName else if activity instanceof SelectTargetForMoveActivity SelectTargetForMoveActivity stfma SelectTargetForMoveActivity activity targetId stfma getTargetId PlayerManager popActivity player this @Override
4 114 public void serve JSONObject request Player player throws ServiceException throw new ServiceException Cannot serve from BuildTurnActivity @Override
4 114 public Turn getTurn if moveIndex 1 targetId null return null Slot userSlot battle getSlot slotId Slot targetSlot battle getSlot targetId return new AttackTurn battle userSlot targetSlot userSlot party get 0 move
4 115 public class BuildRunTurnActivity implements BuildTurnActivity
4 115 private Battle battle
4 115 private String slotId
4 115 public BuildRunTurnActivity Battle b battle b @Override
4 115 public void onAdd Player player throws ServiceException slotId player id PlayerManager popActivity player this @Override
4 115 public void logout Player player @Override
4 115 public void onReturn Activity activity Player player @Override
4 115 public void serve JSONObject request Player player throws ServiceException @Override
4 115 public Turn getTurn Slot slot battle getSlot slotId return new RunTurn battle
4 116 public class BuildSwapTurnActivity implements BuildTurnActivity
4 116 private Battle battle
4 116 private String slotId
4 116 private int pokemonIndex 1
4 116 public BuildSwapTurnActivity Battle b battle b @Override
4 116 public void onAdd Player player throws ServiceException slotId player id JSONObject json new JSONObject try json put action selectpokemon JSONArray pokemonArray new JSONArray json put pokemon pokemonArray for Pokemon pokemon player party JSONObject pokemonJson new JSONObject pokemonJson put name pokemon name pokemonJson put pokemonNumber pokemon number pokemonJson put level pokemon level pokemonJson put health pokemon health pokemonJson put healthMax pokemon maxHealth JSONArray conditionArray new JSONArray for ConditionEffect conditionEffect pokemon getConditionEffects conditionArray put conditionEffect name pokemonJson put condition conditionArray pokemonArray put pokemonJson catch JSONException e PlayerManager pushJson player json @Override
4 116 public void logout Player player @Override
4 116 public void onReturn Activity activity Player player @Override
4 116 public void serve JSONObject request Player player throws ServiceException try if request has pokemonIndex pokemonIndex request getInt pokemonIndex JSONObject closeJson new JSONObject closeJson put action selectpokemon close PlayerManager pushJson player closeJson PlayerManager popActivity player this return catch JSONException e throw new ServiceException Expected pokemon index @Override
4 116 public Turn getTurn if pokemonIndex 1 return null Slot userSlot battle getSlot slotId return new SwapTurn battle userSlot
4 117 public interface BuildTurnActivity extends Activity
4 117 public Turn
4 118 public class SelectTargetForMoveActivity implements Activity
4 118 private String moveName
4 118 private String targetId
4 118 public SelectTargetForMoveActivity String name moveName name
4 118 public String getTargetId return targetId @Override
4 118 public void onAdd Player player throws ServiceException JSONObject json new JSONObject try json put action battle selecttarget json put moveName moveName catch JSONException e PlayerManager pushJson player json @Override
4 118 public void logout Player player @Override
4 118 public void onReturn Activity activity Player player @Override
4 118 public void serve JSONObject request Player player throws ServiceException try if request has targetId targetId request getString targetId PlayerManager popActivity player this return catch JSONException e e printStackTrace throw new ServiceException targetId
4 119 public class Lobby
4 119 private final String host
4 119 private boolean configuring true
4 119 private final List List String teams new ArrayList List String
4 119 private final Map String String responses new HashMap String String
4 119 public Lobby String h host h reset
4 119 public String getHost return host
4 119 public boolean isConfiguring return configuring
4 119 public void setConfiguring boolean state configuring state if configuring responses clear for List String team teams for String name team if name equals host responses put name yes else responses put name pending
4 119 public void addTeam teams add new ArrayList String
4 119 public void removeTeam int team teams remove team
4 119 public void addPlayer String otherPlayerName int team teams get team add otherPlayerName
4 119 public void removePlayer String otherPlayerName int team teams get team remove otherPlayerName
4 119 public void accept String otherPlayerName responses put otherPlayerName yes
4 119 public void reject String otherPlayerName responses put otherPlayerName no
4 119 public List List String getTeams List List String copy new ArrayList List String for List String team teams copy add Collections unmodifiableList team return Collections unmodifiableList copy
4 119 public Map String String getResponses return Collections unmodifiableMap responses
4 119 public void reset teams clear teams add new ArrayList String teams add new ArrayList String teams get 0 add host responses clear configuring
4 120 public class LobbyService implements JPokemonService
4 120 private static final Map String Lobby lobbies new HashMap String Lobby
4 120 private static final Map String List String pending new HashMap String List String
4 120 public void login Player player lobbies put player id new Lobby player id pending put player id new ArrayList String
4 120 public void logout Player player lobbies remove player id pending remove player id @Override
4 120 public void serve JSONObject request Player player throws ServiceException try if request has configure configure request player else if request has respond respond request player else if request has search search request player catch JSONException e e printStackTrace @Override
4 120 public JSONObject load JSONObject request Player player String host player id if request has host try host request getString host catch JSONException e e printStackTrace Lobby lobby lobbies get host JSONObject json generateJson lobby List String pendingList synchronized pending pendingList pending get player id try json put pending new JSONArray pendingList toString catch JSONException e e printStackTrace return json
4 120 private void configure JSONObject json Player player throws JSONException ServiceException String configure json getString configure Lobby lobby lobbies get player id if configure equals addteam if lobby isConfiguring return lobby addTeam PlayerManager pushJson player load new JSONObject player else if configure equals addplayer String otherPlayerName json getString name int team json getInt team if lobby isConfiguring return if PlayerManager playerIsLoggedIn otherPlayerName Message message new Message otherPlayerName not found PlayerManager pushMessage player message return lobby addPlayer otherPlayerName team PlayerManager pushJson player load new JSONObject player else if configure equals removeplayer String otherPlayerName json getString name int team json getInt team if lobby isConfiguring return lobby removePlayer otherPlayerName team PlayerManager pushJson player load new JSONObject player else if configure equals state String state json getString state if configure equals state clearPending lobby lobby setConfiguring true PlayerManager pushJson player load new JSONObject player else if wait equals state buildPending lobby lobby setConfiguring false pushLobbyToPlayers lobby true else if start equals state clearPending lobby startBattle lobby lobby reset
4 120 private void respond JSONObject json Player player throws JSONException ServiceException String host json getString host String response json getString respond Lobby lobby lobbies get host if lobby isConfiguring lobby getResponses keySet contains player id return if response equals accept lobby accept player id else if response equals reject lobby reject player id pushLobbyToPlayers lobby false
4 120 private void search JSONObject json Player player throws JSONException ServiceException String searchTerm json getString search toLowerCase JSONObject response new JSONObject response put action lobby fillSearchResults JSONArray names new JSONArray response put names names if searchTerm isEmpty for String name PlayerManager getOnlinePlayerNames if name equals player id continue if name toLowerCase contains searchTerm player getFriends contains name names put name if names length 9 break PlayerManager pushJson player response
4 120 private JSONObject generateJson Lobby lobby JSONObject json new JSONObject try json put action lobby json put host lobby getHost json put state lobby isConfiguring configure wait json put teams new JSONArray lobby getTeams toString json put responses new JSONObject lobby getResponses catch JSONException e return json
4 120 private void buildPending Lobby lobby for List String team lobby getTeams for String name team if name equals lobby getHost continue List String pendingList synchronized pending pendingList pending get name synchronized pendingList pendingList add lobby getHost Player player PlayerManager getPlayer name PlayerManager pushJson player load new JSONObject player
4 120 private void clearPending Lobby lobby for List String team lobby getTeams for String name team if name equals lobby getHost continue List String pendingList synchronized pending pendingList pending get name synchronized pendingList pendingList remove lobby getHost Player player PlayerManager getPlayer name PlayerManager pushJson player load new JSONObject player
4 120 private void startBattle Lobby lobby Battle battle new Battle Map String String responses lobby getResponses List Player playersInBattle new ArrayList Player int teamNumber 0 for List String teamMembers lobby getTeams for String teamMember teamMembers if yes equals responses get teamMember Player player PlayerManager getPlayer teamMember battle addTrainer player teamNumber playersInBattle add player teamNumber for Player player playersInBattle PlayerManager addActivity player battle
4 120 private void pushLobbyToPlayers Lobby lobby boolean sendNewRequestMessage Message message new Message New battle request JSONObject lobbyJson generateJson lobby for List String team lobby getTeams for String name team Player player PlayerManager getPlayer name PlayerManager pushJson player lobbyJson if sendNewRequestMessage PlayerManager pushMessage player
4 121 public class Slot
4 121 public Slot PokemonTrainer trainer int team _trainer trainer _team team
4 121 public PokemonTrainer trainer return _trainer
4 121 public PokemonStorageUnit party return _trainer party
4 121 public int team return _team
4 121 public Pokemon leader return party get 0
4 121 public void addSlotEffect SlotEffect e if _slotEffects contains e _slotEffects remove e _slotEffects add e
4 121 public String applySlotEffects List String messages new ArrayList String for SlotEffect e _slotEffects String message e apply if message null messages add message messages addAll rollDownEffectDuration return messages toArray new String messages size
4 121 private List String rollDownEffectDuration List String messages new ArrayList String List SlotEffect nextEffects new ArrayList SlotEffect for SlotEffect e _slotEffects if e reduceDuration nextEffects add e else messages add e name dissipated _slotEffects nextEffects return messages
4 121 public void takeDamage int damage leader takeDamage damage
4 121 public double damageModifier Move m double damageModifier 1 0 for SlotEffect e _slotEffects damageModifier e damageModifier m return damageModifier
4 121 public void addRival Slot s List Pokemon rivalsList rivalsList leader if rivalsList contains s leader rivalsList add s leader if _trainer instanceof Player Player _trainer pokedex saw s leader number
4 121 public List Pokemon removeRival Pokemon p List Pokemon hitList new ArrayList Pokemon for Pokemon cur _trainer party List Pokemon rivalsList rivalsList cur if rivalsList null rivalsList contains p hitList add cur rivalsList remove p return hitList
4 121 private List Pokemon rivalsList Pokemon p if _rivalsLists get p null _rivalsLists put p new ArrayList Pokemon return _rivalsLists get p
4 121 private int _team
4 121 private PokemonTrainer _trainer
4 121 private List SlotEffect _slotEffects new ArrayList SlotEffect
4 121 private Map Pokemon List Pokemon _rivalsLists new HashMap Pokemon List
4 122 public class SlotEffect
4 122 public SlotEffect SlotEffectType t Slot user Slot target _type t _user user _target target if _type hasFiniteDuration _time SlotEffectType shieldturns else _time 0
4 122 public String name return _type name
4 122 public double damageModifier Move m MoveStyle style m style if _type SlotEffectType INVULERNABLE return 0 if style MoveStyle PHYSICAL _type SlotEffectType PHYSICAL_SHIELD return 0 if style MoveStyle SPECIAL _type SlotEffectType SPECIAL_SHIELD return 0 return 1
4 122 public String apply switch _type case SEED int d Math max 1 _target leader maxHealth 12 _target takeDamage d _user leader healDamage d return _user leader name healed d from leeching _target leader name default return null
4 122 public boolean reduceDuration _time return _time 0
4 122 public boolean equals Object o if o instanceof SlotEffect return false return SlotEffect o _type _type
4 122 private int _time
4 122 private Slot _user _target
4 122 private SlotEffectType
4 123 public enum SlotEffectType SEED PHYSICAL_SHIELD SPECIAL_SHIELD INVULERNABLE
4 123 public static int shieldturns 5 static Myna configure SlotEffectType class org jpokemon battle
4 123 public boolean hasFiniteDuration return this
4 124 public class AttackTurn extends Turn
4 124 public AttackTurn Battle b Slot user Slot target Move move super b user target _move move _executions 0 @Override
4 124 public void execute Pokemon leader slot leader _executions if _executions 1 for ConditionEffect conditionEffect leader getConditionEffects if conditionEffect blocksAttack battle log leader name conditionEffect getPersistanceMessage return if _move enabled battle log leader name cannot use _move name It s not enabled return else if _move use battle log leader name tried to use _move name but it missed if _move hurtUserOnMiss int d Battle computeDamage leader _move target leader 8 slot takeDamage d battle log leader name took d recoil damage return battle log slot trainer id s slot leader name used _move name if _move style MoveStyle DELAYNEXT _executions 1 battle log slot trainer id s slot leader name is resting this turn return if _move style MoveStyle DELAYBEFORE _executions _move turns battle log slot trainer id s slot leader name is resting this turn return if _move style MoveStyle OHKO int levelDiff leader level target leader level if levelDiff 0 levelDiff 30 0 100 0 Math random battle log leader name tried to use _move name but it missed return if _move style MoveStyle MISC battle log _move name doesn t work yet Sorry about that return if _move doesDamage calculateDamage battle log target leader name took _damage damage target takeDamage _damage _move applyEffects slot target _damage @Override
4 124 public boolean reAdd return _executions _move turns @Override
4 124 public int compareTo Turn t if t instanceof AttackTurn return t slot leader speed slot leader speed return 1
4 124 private void calculateDamage if _move damageIsAbsolute _damage _move power else _damage Battle computeDamage slot leader _move target leader _damage target damageModifier _move _damage Math min Math max _damage 1 target leader health
4 124 private Move _move
4 124 private int _damage
4 125 public class ItemTurn extends Turn
4 125 public ItemTurn Battle b Slot user Slot target Item item int targetIndex super b user target _targetIndex targetIndex _item item battle log slot trainer id used item name @Override
4 125 public void execute Pokemon target target party get _targetIndex if _item type ItemType MACHINE battle log Machines aren t allowed in battle else if _item type ItemType STONE battle log Stones aren t allowed in battle else if _item type ItemType POTION _item effect target else if _item type ItemType BALL if target trainer instanceof WildTrainer battle log Cannot use a ball against target name else if _item effect target if slot trainer add target battle log No room for target name else target party remove target battle log target name was caught else battle log target name broke free @Override
4 125 public boolean reAdd return false @Override
4 125 public int compareTo Turn turn if turn instanceof AttackTurn return 1 if turn instanceof ItemTurn return 0 return 1
4 125 private int _targetIndex
4 125 private Item
4 126 public class RunTurn extends Turn
4 126 public RunTurn Battle b Slot user super b user user @Override
4 126 public void execute Battle battle Battle PlayerManager getActivity Player slot trainer double chance 100 for Slot s battle if slot leader level s leader level chance 10 s leader level slot leader level else if slot leader level s leader level chance 7 slot leader level s leader level if chance 250 0 Math random battle remove slot trainer else battle log Didn t get away @Override
4 126 public boolean reAdd return false @Override
4 126 public int compareTo Turn turn if turn instanceof RunTurn return 0 return
4 127 public class SwapTurn extends Turn
4 127 private int _swapIndex
4 127 public SwapTurn Battle b Slot user int swapIndex super b user user _swapIndex swapIndex
4 127 public static SwapTurn autoSwapTurn Battle b Slot user if user party awake 0 return null int autoSwapIndex 0 while autoSwapIndex user party size user party get autoSwapIndex awake autoSwapIndex return new SwapTurn b user autoSwapIndex @Override
4 127 public void execute slot party swap 0 _swapIndex String trainerName slot trainer id String leaderName slot leader name battle log trainerName sent out leaderName @Override
4 127 public boolean reAdd return false @Override
4 127 public int compareTo Turn turn if turn instanceof RunTurn return 1 if turn instanceof SwapTurn return 0 return
4 128 public abstract class Turn implements Comparable Turn
4 128 private Battle battle
4 128 private Slot slot targetSlot
4 128 public Turn Battle b Slot user Slot target battle b slot user targetSlot target
4 128 public Battle battle return battle
4 128 public Slot slot return slot
4 128 public Slot target if targetSlot null return slot return targetSlot
4 128 public abstract void execute
4 128 public abstract boolean
4 129 public class DresserActivity implements Activity @Override
4 129 public void onAdd Player player throws ServiceException JSONObject json new JSONObject JSONArray avatars new JSONArray for String avatar player getAvatars avatars put avatar try json put action dresser Dresser open json put avatar player getAvatar json put avatars avatars catch JSONException e PlayerManager pushJson player json @Override
4 129 public void logout Player player @Override
4 129 public void onReturn Activity activity Player player @Override
4 129 public void serve JSONObject request Player player throws ServiceException try String nextAvatar request getString avatar if player getAvatar equals nextAvatar return if player getAvatars contains nextAvatar return player setAvatar nextAvatar PlayerManager popActivity player this JSONObject json new JSONObject json put action dresser Dresser close PlayerManager pushJson player json OverworldService overworldService OverworldService PlayerManager getService overworld overworldService teleportPlayer player player getLocation catch JSONException
4 130 public class FriendsService implements JPokemonService
4 130 private static final Map String List String pending new HashMap String List String
4 130 public void login Player player pending put player id new ArrayList String
4 130 public void logout Player player pending remove player id @Override
4 130 public void serve JSONObject json Player player throws ServiceException try if json has configure configure json player PlayerManager pushJson player generateJson player catch JSONException e e printStackTrace @Override
4 130 public JSONObject load JSONObject request Player player return generateJson player
4 130 private void configure JSONObject json Player player throws JSONException String configure json getString configure String otherPlayerName json getString name Player otherPlayer PlayerManager getPlayer otherPlayerName if otherPlayer null return if otherPlayer getBlocked contains player id return if configure equals add sendFriendRequest player otherPlayer else if configure equals accept acceptFriendRequest player otherPlayer else if configure equals block blockOtherPlayer player otherPlayer
4 130 private void sendFriendRequest Player player Player otherPlayer List String pendingList synchronized pending pendingList pending get otherPlayer id synchronized pendingList pendingList add player id PlayerManager pushMessage player new Message Friend request sent PlayerManager pushMessage otherPlayer new Message New friend request PlayerManager pushJson otherPlayer generateJson otherPlayer
4 130 private void acceptFriendRequest Player player Player otherPlayer List String pendingList synchronized pending pendingList pending get player id synchronized pendingList if pendingList contains otherPlayer id return player addFriend otherPlayer id otherPlayer addFriend player id pendingList remove otherPlayer id Message message new Message Friend request accepted PlayerManager pushMessage player message PlayerManager pushMessage otherPlayer message PlayerManager pushJson otherPlayer generateJson otherPlayer
4 130 private void blockOtherPlayer Player player Player otherPlayer player addBlocked otherPlayer id otherPlayer removeFriend player id PlayerManager pushMessage player new Message Player blocked
4 130 private JSONObject generateJson Player player JSONObject json new JSONObject try json put action friends json put friends new JSONArray player getFriends json put blocked new JSONArray player getBlocked List String pendingList synchronized pending pendingList pending get player id synchronized pendingList json put pending new JSONArray pendingList catch JSONException e return
4 131 public class PartyService implements JPokemonService @Override
4 131 public void login Player player @Override
4 131 public void logout Player player @Override
4 131 public void serve JSONObject request Player player throws ServiceException try String method request getString method if method equals slide slide request player catch JSONException e e printStackTrace
4 131 private void slide JSONObject request Player player throws JSONException int indexOld request getInt indexOld int indexNew request getInt indexNew player party slide indexOld indexNew PlayerManager pushJson player load null player @Override
4 131 public JSONObject load JSONObject request Player player JSONObject json new JSONObject JSONArray pokemonArray new JSONArray try json put action party json put pokemon pokemonArray json put count player party size json put awakecount player party awake for Pokemon pokemon player party JSONObject pokemonJson new JSONObject JSONArray conditionArray new JSONArray pokemonJson put name pokemon name pokemonJson put number pokemon number pokemonJson put health pokemon health pokemonJson put maxhealth pokemon maxHealth pokemonJson put condition conditionArray pokemonJson put level pokemon level for ConditionEffect C pokemon getConditionEffects conditionArray put C name pokemonArray put pokemonJson catch JSONException e return
4 132 public interface Action
4 132 public void execute Player player throws
4 133 public class ActionData @PrimaryKey @AutoIncrement
4 133 private int id 1
4 133 private int actionsetId
4 133 private String action options
4 133 public static List ActionData get int actionsetId DataConnectionManager init JPokemonServer databasepath try return SqlStatement select ActionData class where actionsetid eq actionsetId getList catch DataConnectionException e e printStackTrace return new ArrayList ActionData
4 133 public ActionData commit try if id 0 SqlStatement insert this execute else SqlStatement update this where id eq id execute catch DataConnectionException e e printStackTrace return this
4 133 public int getId return id
4 133 public void setId int id this id id
4 133 public int getActionsetId return actionsetId
4 133 public ActionData setActionsetId int actionsetId this actionsetId actionsetId return this
4 133 public String getAction return action
4 133 public ActionData setAction String action this action action return this
4 133 public String getOptions return options
4 133 public void setOptions String options this options
4 134 public interface ActionFactory
4 134 public Action buildAction String
4 135 public class ActionFactoryRegistry
4 135 private static Map String ActionFactory factories new HashMap String ActionFactory static registerActionFactory event new EventActionFactory registerActionFactory heal new HealActionFactory registerActionFactory item new ItemActionFactory registerActionFactory store new StoreActionFactory registerActionFactory upgrade new UpgradeActionFactory registerActionFactory map new MapActionFactory registerActionFactory grass new GrassActionFactory registerActionFactory dresser new DresserActionFactory
4 135 private ActionFactoryRegistry
4 135 public static void registerActionFactory String action ActionFactory factory factories put action factory
4 135 public static Action get String action String options ActionFactory actionFactory factories get action if actionFactory null return actionFactory buildAction options return
4 136 public class ActionSet @PrimaryKey @AutoIncrement
4 136 private int id 1
4 136 private String context name option
4 136 private List Action _actions new ArrayList Action
4 136 private List Requirement _requirements new ArrayList Requirement
4 136 public static List ActionSet get String name DataConnectionManager init JPokemonServer databasepath try List ActionSet actionSets SqlStatement select ActionSet class where name eq name getList if actionSets null actionSets isEmpty for ActionSet actionSet actionSets fillActionSet actionSet return actionSets catch DataConnectionException e e printStackTrace return new ArrayList ActionSet
4 136 public static List ActionSet get String context String name DataConnectionManager init JPokemonServer databasepath try List ActionSet actionSets SqlStatement select ActionSet class where context eq context and name eq name getList if actionSets null actionSets isEmpty for ActionSet actionSet actionSets fillActionSet actionSet return actionSets catch DataConnectionException e e printStackTrace return new ArrayList ActionSet
4 136 private static void fillActionSet ActionSet actionSet for ActionData actionData ActionData get actionSet id Action action ActionFactoryRegistry get actionData getAction actionData getOptions actionSet addAction action for RequirementData requirementData RequirementData get actionSet id Requirement requirement RequirementFactoryRegistry get requirementData getRequirement requirementData getOptions actionSet addRequirement requirement
4 136 public static ActionSet withAction Action action ActionSet actionSet new ActionSet actionSet addAction action return actionSet
4 136 public int getId return id
4 136 public ActionSet setId int id this id id return this
4 136 public ActionSet commit try if id 0 SqlStatement insert this execute else SqlStatement update this where id eq id execute catch DataConnectionException e e printStackTrace return this
4 136 public String getContext return context
4 136 public ActionSet setContext String s context s return this
4 136 public String getName return name
4 136 public ActionSet setName String s name s return this
4 136 public String getOption return option
4 136 public ActionSet setOption String o option o return this
4 136 public void execute Player player throws ServiceException if meetsRequirements player throw new ServiceException Requirements not satisfied for actionset id and player toString for Action action _actions action execute player
4 136 public boolean meetsRequirements Player player for Requirement requirement _requirements if requirement isSatisfied player return false return true
4 136 public List Action getActions return Collections unmodifiableList _actions
4 136 public void addAction Action action _actions add action
4 136 public List Requirement getRequirements return Collections unmodifiableList _requirements
4 136 public void addRequirement Requirement requirement _requirements add
4 137 public interface Requirement
4 137 public boolean isSatisfied Player
4 138 public class RequirementData @PrimaryKey @AutoIncrement
4 138 private int id 1
4 138 private int actionsetId
4 138 private String requirement options
4 138 public static List RequirementData get int actionsetId DataConnectionManager init JPokemonServer databasepath try return SqlStatement select RequirementData class where actionsetid eq actionsetId getList catch DataConnectionException e e printStackTrace return new ArrayList RequirementData
4 138 public RequirementData commit try if id 0 SqlStatement insert this execute else SqlStatement update this where id eq id execute catch DataConnectionException e e printStackTrace return this
4 138 public int getId return id
4 138 public void setId int id this id id
4 138 public int getActionsetId return actionsetId
4 138 public RequirementData setActionsetId int actionsetId this actionsetId actionsetId return this
4 138 public String getRequirement return requirement
4 138 public RequirementData setRequirement String requirement this requirement requirement return this
4 138 public String getOptions return options
4 138 public void setOptions String options this options
4 139 public interface RequirementFactory
4 139 public Requirement buildRequirement String
4 140 public class RequirementFactoryRegistry
4 140 private static Map String RequirementFactory factories new HashMap String RequirementFactory static registerRequirementFactory event new EventRequirementFactory registerRequirementFactory pokedex new PokedexRequirementFactory
4 140 private RequirementFactoryRegistry
4 140 public static void registerRequirementFactory String requirement RequirementFactory builder factories put requirement builder
4 140 public static Requirement get String action String options RequirementFactory requirementFactory factories get action if requirementFactory null return requirementFactory buildRequirement options return
4 141 public class BattleAction extends Action
4 141 public BattleAction String data super data
4 141 public void execute Player player throws ServiceException String fileName player record replaceMacros getData String filePath JPokemonServer scriptedbattlepath fileName jpkmn XmlNode trainerData try trainerData XmlParser parse new File filePath get 0 catch FileNotFoundException e throw new ServiceException Trainer file not found getData Trainer trainer new Trainer getData trainer loadXml trainerData if player record getTrainer trainer id PlayerManager addActivity player new Battle player
4 142 public class DresserActionFactory implements ActionFactory @Override
4 142 public Action buildAction String options return new DresserAction class DresserAction implements Action @Override
4 142 public void execute Player player throws ServiceException PlayerManager addActivity player new
4 143 public class EventActionFactory implements ActionFactory @Override
4 143 public Action buildAction String options return null class EventAction implements Action
4 143 private int eventId
4 143 public EventAction int eventId this eventId eventId
4 143 public void execute Player player player record putEvent
4 144 public class GrassActionFactory implements ActionFactory @Override
4 144 public Action buildAction String options return new GrassAction options class GrassAction implements Action
4 144 private String mapId
4 144 public GrassAction String mapId this mapId mapId @Override
4 144 public void execute Player player throws ServiceException int totalFlex 0 List WildPokemon wildPokemon WildPokemon get mapId for WildPokemon wp wildPokemon totalFlex wp getFlex wildPokemon add wp totalFlex int totalFlex Math random for WildPokemon wp wildPokemon if totalFlex wp getFlex return else totalFlex wp
4 145 public class HealActionFactory implements ActionFactory @Override
4 145 public Action buildAction String options return new HealAction class HealAction implements Action @Override
4 145 public void execute Player player for Pokemon pokemon player party pokemon healDamage pokemon
4 146 public class ItemActionFactory implements ActionFactory @Override
4 146 public Action buildAction String options String optionsSplit options split int itemId Integer parseInt optionsSplit 0 int quantity Integer parseInt optionsSplit 1 return new ItemAction itemId quantity class ItemAction implements Action int itemId quantity
4 146 public ItemAction int itemId int quantity this itemId itemId this quantity quantity
4 146 public void execute Player player player item itemId add
4 147 public class MapActionFactory implements ActionFactory @Override
4 147 public Action buildAction String s String options s split String mapId options 0 String nextMapId options 1 return new MapAction mapId nextMapId class MapAction implements Action
4 147 private String mapId nextMapId
4 147 public MapAction String mapId String nextMapId this mapId mapId this nextMapId nextMapId @Override
4 147 public void execute Player player throws ServiceException OverworldService overworldService OverworldService PlayerManager getService overworld Map nextMap overworldService getMap nextMapId Entity nextDoor nextMap getEntity mapId Location nextLocation nextDoor getLocation clone nextLocation setWidth 1 nextLocation setHeight 1 nextLocation setDirection down overworldService teleportPlayer player
4 148 public class PokemonActionFactory implements ActionFactory @Override
4 148 public Action buildAction String options return null class PokemonAction implements Action @Override
4 148 public void execute Player player Pokemon pokemon null String parameters getData split int number Integer parseInt parameters 0 if number 1 for Pokemon cur player party if cur number number pokemon null pokemon cur player party remove pokemon else pokemon new Pokemon number Integer parseInt parameters 1 for int i 2 i parameters length i String parameter parameters i split if parameter 0 equals ot pokemon setTrainerName parameter 1 player add
4 149 public class SpeechAction extends Action
4 149 public SpeechAction String data super data
4 149 public void execute Player
4 150 public class StoreActionFactory implements ActionFactory @Override
4 150 public Action buildAction String options int storeId Integer parseInt options return new StoreAction storeId class StoreAction implements Action
4 150 private int storeId
4 150 public StoreAction int storeId this storeId storeId @Override
4 150 public void execute Player player throws ServiceException Store store Store get storeId if store null throw new ServiceException Store undefined storeId PlayerManager addActivity player new StoreActivity
4 151 public class UpgradeActionFactory implements ActionFactory @Override
4 151 public Action buildAction String options return new UpgradeAction class UpgradeAction implements Action @Override
4 151 public void execute Player player PlayerManager addActivity player new
4 152 public class EventRequirementFactory implements RequirementFactory @Override
4 152 public Requirement buildRequirement String options return new EventRequirement Integer parseInt options class EventRequirement implements Requirement
4 152 private int eventId
4 152 public EventRequirement int eventId this eventId eventId @Override
4 152 public boolean isSatisfied Player player return player record getEvent Math abs eventId eventId
4 153 public class PokedexRequirementFactory implements RequirementFactory @Override
4 153 public Requirement buildRequirement String options return new PokedexRequirement Integer parseInt options class PokedexRequirement implements Requirement
4 153 private int pokedexCount
4 153 public PokedexRequirement int pokedexCount this pokedexCount pokedexCount @Override
4 153 public boolean isSatisfied Player player return player pokedex count Math abs pokedexCount pokedexCount
4 154 public class Bag implements Iterable Item
4 154 public static final String XML_NODE_NAME bag
4 154 public Item get int itemID Item item _items get itemID if item null _items put itemID item new Item itemID return item @Override
4 154 public Iterator Item iterator return new BagIterator
4 154 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME for Map Entry Integer Item itemEntry _items entrySet node addChild itemEntry getValue toXml return node
4 154 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node for XmlNode itemNode node getChildren Item XML_NODE_NAME Item i get itemNode getIntAttribute number i amount itemNode getIntAttribute quantity
4 154 private class BagIterator implements Iterator Item @Override
4 154 public boolean hasNext return index keys length @Override
4 154 public Item next return Bag this get keys index @Override
4 154 public void remove
4 154 private int index 0
4 154 private Integer keys Bag this _items keySet toArray new Integer Bag this _items keySet size
4 154 private Map Integer Item _items new HashMap Integer
4 155 public class Inventory @PrimaryKey @AutoIncrement
4 155 private int id 1
4 155 private int store item price purchaseprice denomination available
4 155 public static List Inventory get int store DataConnectionManager init JPokemonServer databasepath try return SqlStatement select Inventory class where store eq store getList catch DataConnectionException e e printStackTrace return new ArrayList Inventory
4 155 public void commit try if id 1 SqlStatement insert this execute else SqlStatement update this where id eq id execute catch DataConnectionException e
4 155 public int getId return id
4 155 public void setId int i id i
4 155 public int getStore return store
4 155 public void setStore int s store s
4 155 public int getItem return item
4 155 public void setItem int i item i
4 155 public int getPrice return price
4 155 public void setPrice int p price p
4 155 public int getPurchaseprice return purchaseprice
4 155 public void setPurchaseprice int p purchaseprice p
4 155 public int getDenomination return denomination
4 155 public void setDenomination int d denomination d
4 155 public int getAvailable return available
4 155 public void setAvailable int a available
4 156 public class Item
4 156 public static final String XML_NODE_NAME item
4 156 public Item int itemID _info ItemInfo get itemID _type ItemType valueOf _info getType
4 156 public int number return _info getId
4 156 public String name return _info getName
4 156 public ItemType type return _type
4 156 public Target target return _type target
4 156 public int amount return _quantity
4 156 public void amount int quantity _quantity quantity
4 156 public void add int quantity amount quantity amount
4 156 public boolean visible return amount 0
4 156 public boolean effect Pokemon p if _quantity 1 return false boolean result _type effect p _info if result _quantity return result
4 156 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute number _info getId node setAttribute quantity _quantity node setSelfClosing true return node
4 156 public String toString return _info getId _quantity
4 156 private int _quantity
4 156 private ItemInfo _info
4 156 private ItemType
4 157 public class ItemInfo @PrimaryKey @AutoIncrement
4 157 private int id 1
4 157 private String name
4 157 private int type data
4 157 private static Map Integer ItemInfo cache new HashMap Integer ItemInfo
4 157 public static ItemInfo get int number DataConnectionManager init JPokemonServer databasepath if cache get number null try List ItemInfo info SqlStatement select ItemInfo class where id eq number getList if info isEmpty cache put number info get 0 catch DataConnectionException e e printStackTrace return cache get number
4 157 public int getId return id
4 157 public void setId int i id i
4 157 public int getType return type
4 157 public void setType int t type t
4 157 public int getData return data
4 157 public void setData int d data d
4 157 public String getName return name
4 157 public void setName String s name
4 158 public enum ItemType BALL POTION XSTAT STONE MACHINE KEYITEM
4 158 public static ItemType valueOf int t return ItemType values t
4 158 public Target target switch this case POTION case XSTAT case STONE case MACHINE case KEYITEM return Target SELF case BALL return Target ENEMY default return null
4 158 public boolean effect Pokemon pokemon ItemInfo info switch this case BALL int a int Math random info getData 1 a 3 pokemon maxHealth 2 pokemon health pokemon catchRate a 30 pokemon maxHealth a pokemon catchBonus return a 255 case POTION pokemon healDamage info getData return true case XSTAT pokemon getStat StatType valueOf info getData effect 1 return true case STONE int n pokemon number switch Type valueOf info getData case FIRE if n 37 n 58 pokemon evolve else if n 133 pokemon evolve 136 break case WATER if n 60 n 90 n 120 pokemon evolve else if n 133 pokemon evolve 134 break case ELECTRIC if pokemon number 25 pokemon evolve else if n 133 pokemon evolve 135 break case GRASS if n 44 n 70 n 102 pokemon evolve break case NORMAL if n 30 n 33 n 35 n 39 pokemon evolve break default break return pokemon number n case MACHINE if new Move info getData STAB pokemon 1 return false try pokemon addMove info getData catch IllegalStateException e return false case KEYITEM default return
4 159 public class Store @PrimaryKey @AutoIncrement
4 159 private int id 1
4 159 private String name
4 159 private List Inventory _inventory
4 159 public static Store get int number DataConnectionManager init JPokemonServer databasepath Store store null try List Store query SqlStatement select Store class where id eq number getList if query size 0 store query get 0 store _inventory Inventory get store id catch DataConnectionException e return store
4 159 public void commit try if id 1 SqlStatement insert this execute else SqlStatement update this where id eq id execute catch DataConnectionException e e printStackTrace
4 159 public int getId return id
4 159 public void setId int i id i
4 159 public String getName return name
4 159 public void setName String n name n
4 159 public boolean isEmpty return _inventory isEmpty
4 159 public List Inventory getInventory return Collections unmodifiableList
4 160 public class StoreActivity implements Activity
4 160 private Store store
4 160 public StoreActivity Store s store s @Override
4 160 public void onAdd Player player @Override
4 160 public void logout Player player @Override
4 160 public void onReturn Activity activity Player player @Override
4 160 public void serve JSONObject request Player player throws ServiceException try JSONArray itemChanges request getJSONArray items int runningTotalCash player getCash for int index 0 index itemChanges length index JSONObject itemChange itemChanges getJSONObject index int itemID itemChange getInt item int change itemChange getInt change int denomination itemChange getInt denomination Inventory inventory findInventory itemID denomination if inventory null throw new ServiceException Invalid sale request item itemID denomination denomination if change 0 runningTotalCash change inventory getPrice else runningTotalCash change inventory getPurchaseprice if player item itemID amount change throw new ServiceException Insufficent quantity item player item itemID name if runningTotalCash 0 throw new ServiceException Not enough cash to complete order for int index 0 index itemChanges length index JSONObject itemChange itemChanges getJSONObject index int itemID itemChange getInt item int change itemChange getInt change int denomination itemChange getInt denomination Inventory inventory findInventory itemID denomination player item itemID add change if change 0 player setCash player getCash change inventory getPrice else player setCash player getCash change inventory getPurchaseprice catch JSONException e e printStackTrace
4 160 private Inventory findInventory int itemID int denomination for Inventory inventory store getInventory if inventory getItem itemID inventory getDenomination denomination return inventory return
4 161 public class Entity
4 161 protected String name
4 161 protected boolean solid true
4 161 protected Location location
4 161 protected Map String List ActionSet actionSets new HashMap String List ActionSet
4 161 public String getName return name
4 161 public Entity setName String name this name name return this
4 161 public boolean isSolid return solid
4 161 public Entity setSolid boolean solid this solid solid return this
4 161 public Location getLocation return location
4 161 public Entity setLocation Location location this location location return this
4 161 public List ActionSet getActionSets String trigger return actionSets get trigger
4 161 public Entity setActionSets String trigger List ActionSet actionSets this actionSets put trigger actionSets return this
4 161 public Entity addActionSet String trigger ActionSet actionSet if this actionSets containsKey trigger this actionSets put trigger new ArrayList ActionSet this actionSets get trigger add actionSet return this
4 161 public Entity addAllActionSets String trigger List ActionSet actionSets if this actionSets containsKey trigger this actionSets put trigger new ArrayList ActionSet this actionSets get trigger addAll actionSets return
4 162 public class Location
4 162 public static final String XML_NODE_NAME location
4 162 private String map direction
4 162 private int left top width 1 height 1
4 162 public Location
4 162 public Location int left int top this left top 1 1
4 162 public Location int left int top int width int height this left left this top top this width width this height height
4 162 public Location clone Location location new Location location map map location direction direction location left left location height height location top top location width width return location
4 162 public Location translate String direction Location location clone if left equals direction location left else if up equals direction location top else if right equals direction location left else if down equals direction location top else return null location setDirection direction return location
4 162 public String getMap return map
4 162 public void setMap String map this map map
4 162 public String getDirection return direction
4 162 public void setDirection String direction this direction direction
4 162 public int getLeft return this left
4 162 public void setLeft int left this left left
4 162 public int getTop return this top
4 162 public void setTop int top this top top
4 162 public int getWidth return this width
4 162 public void setWidth int width this width width
4 162 public int getHeight return this height
4 162 public void setHeight int height this height height
4 162 public int getRight return this left this width
4 162 public int getBottom return this top this height
4 162 public void setBounds int left int width int top int height this left left this top top this width width this height height
4 162 public boolean contains Location location return this left location left this top location top this getRight location getRight this getBottom location getBottom
4 162 public void loadXml XmlNode node setMap node getAttribute map setBounds node getIntAttribute left node getIntAttribute width node getIntAttribute top node getIntAttribute height if node hasAttribute direction direction node getAttribute direction else direction down
4 162 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute map map node setAttribute direction direction node setAttribute left getLeft node setAttribute top getTop node setAttribute width getWidth node setAttribute height getHeight node setSelfClosing true return node
4 162 public String toString return getLeft getWidth getTop
4 163 public class Map
4 163 private String name
4 163 private int width height entityZ
4 163 private List Entity entities new ArrayList Entity
4 163 private List String players new ArrayList String
4 163 public Map String name this name name
4 163 public String getName return name
4 163 public Entity getEntity Location target for Entity entity entities if entity getLocation contains target return entity return null
4 163 public Entity getEntity String entityName for Entity entity entities if entityName equals entity getName return entity return null
4 163 public void addEntity Entity entity entities add entity
4 163 public int getWidth return width
4 163 public void setWidth int width this width width
4 163 public int getHeight return height
4 163 public void setHeight int height this height height
4 163 public int getEntityZ return entityZ
4 163 public void setEntityZ int entityZ this entityZ entityZ
4 163 public void addPlayer String playerId players add playerId
4 163 public List String getPlayers return Collections unmodifiableList players
4 163 public void setPlayers List String players this players players
4 163 public void removePlayer String playerId players remove
4 164 public class OverworldService implements JPokemonService
4 164 private HashMap String Map maps new HashMap String Map
4 164 public Map getMap String name if maps containsKey name maps put name TmxMapParser parse name return maps get name
4 164 public void teleportPlayer Player player Location nextLocation sendLeave player player setLocation nextLocation sendJoin player @Override
4 164 public void login Player player sendJoin player @Override
4 164 public void logout Player player sendLeave player
4 164 private void sendLeave Player player String mapId player getLocation getMap Map map getMap mapId map removePlayer player id JSONObject signout new JSONObject try signout put action overworld leave signout put name player id catch JSONException e for String otherPlayerId map getPlayers PlayerManager pushJson PlayerManager getPlayer otherPlayerId signout
4 164 private void sendJoin Player player Location location player getLocation String mapId location getMap Map map getMap mapId JSONObject sendToOthers new JSONObject JSONObject sendToPlayer new JSONObject JSONArray otherPlayersArray new JSONArray try sendToOthers put action overworld join sendToOthers put spriteheight 56 sendToOthers put spritewidth 42 sendToOthers put name player id sendToOthers put image player getAvatar sendToOthers put x player getLocation getLeft sendToOthers put y player getLocation getTop sendToOthers put z map getEntityZ sendToOthers put direction player getLocation getDirection sendToPlayer put action overworld load sendToPlayer put spriteheight 56 sendToPlayer put spritewidth 42 sendToPlayer put name player id sendToPlayer put image player getAvatar sendToPlayer put x player getLocation getLeft sendToPlayer put y player getLocation getTop sendToPlayer put z map getEntityZ sendToPlayer put direction player getLocation getDirection sendToPlayer put map mapId sendToPlayer put otherPlayers otherPlayersArray for String playerId map getPlayers Player otherPlayer PlayerManager getPlayer playerId PlayerManager pushJson otherPlayer sendToOthers JSONObject otherPlayerJson new JSONObject otherPlayerJson put name otherPlayer id otherPlayerJson put spriteheight 56 otherPlayerJson put spritewidth 42 otherPlayerJson put image otherPlayer getAvatar otherPlayerJson put x otherPlayer getLocation getLeft otherPlayerJson put y otherPlayer getLocation getTop otherPlayerJson put z map getEntityZ otherPlayerJson put direction otherPlayer getLocation getDirection otherPlayersArray put otherPlayerJson map addPlayer player id PlayerManager pushJson player sendToPlayer catch JSONException e e printStackTrace @Override
4 164 public void serve JSONObject request Player player throws ServiceException try String method request getString method if method equals move move player request else if look equals method look player request else if method equals interact interact player request catch JSONException e e printStackTrace
4 164 public void move Player player JSONObject request throws JSONException String direction request getString direction Location location player getLocation translate direction if location null return Map map getMap location getMap Entity entity map getEntity location if entity null if entity isSolid return for ActionSet actionSet entity getActionSets step try actionSet execute player catch ServiceException e PlayerManager pushMessage player new Message error e getMessage player setLocation location JSONObject json new JSONObject json put action overworld move json put name player id json put direction direction json put x location getLeft json put y location getTop for String playerId map getPlayers PlayerManager pushJson PlayerManager getPlayer playerId json
4 164 public void look Player player JSONObject request throws JSONException Map map getMap player getLocation getMap String direction request getString direction if left equals direction up equals direction right equals direction down equals direction player getLocation setDirection direction JSONObject json new JSONObject json put action overworld look json put name player id json put direction direction for String playerId map getPlayers PlayerManager pushJson PlayerManager getPlayer playerId json
4 164 public void interact Player player JSONObject request Location location player getLocation translate player getLocation getDirection Map map getMap location getMap Entity entity map getEntity location if entity null return for ActionSet actionSet entity getActionSets interact try actionSet execute player catch ServiceException e PlayerManager pushMessage player new Message error e getMessage @Override
4 164 public JSONObject load JSONObject request Player player return
4 165 public class TmxMapParser
4 165 public static String mappath static Myna configure TmxMapParser class org jpokemon server
4 165 protected Map map
4 165 protected int tileHeight tileWidth
4 165 public static Map parse String mapName TmxMapParser parser new TmxMapParser mapName parser parse return parser map
4 165 protected TmxMapParser String name map new Map name
4 165 private void parse try XmlNode data XmlParser parse new File mappath map getName tmx get 1 parseMapDimensions data for XmlNode objectLayer data getChildren objectgroup for XmlNode objectNode objectLayer getAllChildren parseEntity objectNode catch FileNotFoundException e System out println e
4 165 private void parseMapDimensions XmlNode mapRoot map setWidth mapRoot getIntAttribute width map setHeight mapRoot getIntAttribute height tileWidth mapRoot getIntAttribute tilewidth tileHeight mapRoot getIntAttribute tileheight int entityZ 1 for XmlNode layerNode mapRoot getAllChildren if objectgroup equals layerNode getName break else if layer equals layerNode getName entityZ map setEntityZ entityZ
4 165 private void parseEntity XmlNode objectNode Entity entity new Entity entity setLocation parseLocation objectNode String entityName null entityType null if objectNode hasAttribute type entityType objectNode getAttribute type if objectNode hasAttribute name entityName objectNode getAttribute name entity setName entityName if npc equals entityType else if door equals entityType entity setSolid false entity addActionSet step ActionSet withAction ActionFactoryRegistry get map entityName else if grass equals entityType entity setSolid false entity addActionSet step ActionSet withAction ActionFactoryRegistry get grass map getName else if entityType null entity addAllActionSets interact ActionSet get global entityName entity addAllActionSets interact ActionSet get map getName entityName map addEntity entity
4 165 private Location parseLocation XmlNode objectNode Location location new Location location setMap map getName location setLeft objectNode getIntAttribute x tileWidth location setTop objectNode getIntAttribute y tileHeight if objectNode hasAttribute width location setWidth objectNode getIntAttribute x objectNode getIntAttribute width tileWidth location getLeft 1 if objectNode hasAttribute height location setHeight objectNode getIntAttribute y objectNode getIntAttribute height tileHeight location getTop 1 return
4 166 public class WildPokemon
4 166 private String map
4 166 private int number levelmin levelmax flex
4 166 public Pokemon instantiate int level int levelmax levelmin 1 Math random levelmin return new Pokemon number level
4 166 public static List WildPokemon get String map DataConnectionManager init JPokemonServer databasepath try return SqlStatement select WildPokemon class where map eq map getList catch DataConnectionException e e printStackTrace return new ArrayList WildPokemon
4 166 public String getMap return map
4 166 public void setMap String m map m
4 166 public int getNumber return number
4 166 public void setNumber int n number n
4 166 public int getLevelmin return levelmin
4 166 public void setLevelmin int l levelmin l
4 166 public int getLevelmax return levelmax
4 166 public void setLevelmax int l levelmax l
4 166 public int getFlex return flex
4 166 public void setFlex int f flex
4 167 public class Pokedex
4 167 public static final String XML_NODE_NAME pokedex
4 167 public void saw int num if num 1 throw new IllegalArgumentException num out of range if _data get num PokedexStatus OWN return _data put num PokedexStatus SAW
4 167 public void own int num if num 1 throw new IllegalArgumentException num out of range _data put num PokedexStatus OWN
4 167 public PokedexStatus status int num if num 1 throw new IllegalArgumentException num out of range PokedexStatus status _data get num if status null status PokedexStatus NONE return status
4 167 public int count return _data size
4 167 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME List Integer seen new ArrayList Integer owned new ArrayList Integer for Map Entry Integer PokedexStatus pokedexEntry _data entrySet if pokedexEntry getValue PokedexStatus OWN owned add pokedexEntry getKey else seen add pokedexEntry getKey XmlNode seenNode new XmlNode seen seenNode setValue seen toString node addChild seenNode XmlNode ownedNode new XmlNode owned ownedNode setValue owned toString node addChild ownedNode return node
4 167 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node String dataPieces String seenData ownedData XmlNode seen node getChildren seen get 0 XmlNode owned node getChildren owned get 0 seenData seen getValue replace replace trim if seenData isEmpty dataPieces seenData split for String item dataPieces _data put Integer parseInt item trim PokedexStatus SAW ownedData owned getValue replace replace trim if ownedData isEmpty dataPieces ownedData split for String item dataPieces _data put Integer parseInt item trim PokedexStatus OWN
4 167 private Map Integer PokedexStatus _data new HashMap Integer
4 168 public enum PokedexStatus NONE SAW OWN
4 168 public static PokedexStatus valueOf int p return values
4 169 public enum ConditionEffect BURN PARALYZE SLEEP POISON FREEZE CONFUSE WRAP FLINCH
4 169 public double persistanceChance switch this case BURN case PARALYZE case POISON return 1 case SLEEP return 333 case FREEZE return 8 case CONFUSE case WRAP return 667 default return 0
4 169 public boolean blocksAttack switch this case FREEZE case SLEEP case FLINCH case CONFUSE return true case PARALYZE return Math random 25 default return false
4 169 public double damagePercentage switch this case BURN case POISON case WRAP return 1 case CONFUSE return 0 default return 0
4 169 public double catchBonus switch this case FREEZE case SLEEP return 2 case BURN case POISON case PARALYZE return 1 5 default return 1
4 169 public String getPersistanceMessage switch this case BURN return was injured by it s burn case SLEEP return is still sleeping case POISON return was injured by the poison case FREEZE return is still frozen case CONFUSE return hurt itself in it s confusion case WRAP return was injured by the binding case PARALYZE return is paralyzed default return null
4 169 public String getDissipationMessage switch this case SLEEP return woke up case FREEZE return broke out of the ice case WRAP return freed itself case CONFUSE return is no longer confused default return
4 170 public class EffortValue
4 170 private int pokemon stat amount
4 170 public int getPokemon return pokemon
4 170 public void setPokemon int val pokemon val
4 170 public int getStat return stat
4 170 public void setStat int val stat val
4 170 public int getAmount return amount
4 170 public void setAmount int val amount
4 171 public enum GrowthRate SLOW MED_SLOW MED_FAST FAST
4 171 public static GrowthRate valueOf int index return GrowthRate values index
4 171 public int xp int n double xp 0 switch this case SLOW xp 5 0 n n n 4 break case MED_SLOW xp 6 0 n n n 5 15 n n 100 n 140 break case MED_FAST xp n n n break case FAST xp 4 0 n n n 5 return Math max 1 int
4 172 public class Pokemon
4 172 public static final String XML_NODE_NAME pokemon
4 172 public Pokemon int num _number num _moves new MoveBlock _number _species PokemonInfo get _number _stats new StatBlock _species
4 172 public Pokemon int num int lvl this num _level lvl _stats level lvl _moves randomize lvl
4 172 public int number return _number
4 172 public String name if _name null return species return _name
4 172 public void name String s _name s
4 172 public String species return _species getName
4 172 public int level return _level
4 172 public int evolutionLevel return _species getEvolutionlevel
4 172 public int catchRate return _species getCatchrate
4 172 public void level int l _level l _stats level l checkNewMoves conditionEffects new ArrayList ConditionEffect
4 172 public void incLevel int thisLevelIncrement int level StatBlock bonuslevelrate int nextLevelIncrement int level 1 StatBlock bonuslevelrate while nextLevelIncrement thisLevelIncrement _stats points _stats points 1 nextLevelIncrement level level 1
4 172 public Type type1 return Type valueOf _species getType1
4 172 public Type type2 return Type valueOf _species getType2
4 172 public String getTrainerName return _ot
4 172 public void setTrainerName String s if _ot null _hasOriginalTrainer false else _hasOriginalTrainer true _ot s
4 172 public boolean hasOriginalTrainer return _hasOriginalTrainer
4 172 public int xp return _xp
4 172 public void xp int amount int xpNeededAtLevel xpNeededAtLevel _xp amount while _xp xpNeededAtLevel _xp xpNeededAtLevel incLevel
4 172 public int xpNeeded return xpNeededAtLevel xp
4 172 public int xpYield return _species getXpyield
4 172 public Stat getStat StatType s return _stats get s
4 172 public int availableStatPoints return _stats points
4 172 public void statPoints StatType s int amount _stats usePoints s amount
4 172 public int health int val getStat StatType HEALTH cur return val
4 172 public int maxHealth return getStat StatType HEALTH max
4 172 public int attack return getStat StatType ATTACK cur
4 172 public int specattack return getStat StatType SPECATTACK cur
4 172 public int defense return getStat StatType DEFENSE cur
4 172 public int specdefense return getStat StatType SPECDEFENSE cur
4 172 public int speed return getStat StatType SPEED cur
4 172 public List EffortValue effortValues return _species getEffortValues
4 172 public void addEV List EffortValue evs _stats addEV evs
4 172 public Move move int index return _moves get index
4 172 public void addMove int number _moves add number
4 172 public int moveCount return _moves count
4 172 public void removeAllMoves _moves removeAll
4 172 public void takeDamage int damage getStat StatType HEALTH effect damage
4 172 public void healDamage int heal getStat StatType HEALTH effect heal
4 172 public boolean awake return health 0
4 172 public void addConditionEffect ConditionEffect e _stats addConditionEffect e if conditionEffects contains e conditionEffects remove e conditionEffects add e
4 172 public boolean hasConditionEffect ConditionEffect e return conditionEffects contains e
4 172 public List ConditionEffect getConditionEffects return conditionEffects
4 172 public boolean removeConditionEffect ConditionEffect e _stats removeConditionEffect e return conditionEffects remove e
4 172 public double catchBonus double best 1 for ConditionEffect e conditionEffects best e catchBonus return Math min best 2 0
4 172 public void evolve int num if num length 0 _number num 0 else _number _moves setPokemonNumber _number _species PokemonInfo get _number _stats rebase _species checkNewMoves
4 172 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME if _name null node setAttribute name _name node setAttribute number _number node setAttribute level _level node setAttribute xp _xp node setAttribute ot _ot node setAttribute has_original_trainer _hasOriginalTrainer XmlNode conditionNode new XmlNode condition conditionNode setValue conditionEffects toString node addChild conditionNode node addChild _stats toXml node addChild _moves toXml return node
4 172 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node _name node getAttribute name _number node getIntAttribute number _moves setPokemonNumber _number _species PokemonInfo get _number _stats rebase _species _level node getIntAttribute level _stats level _level _xp node getIntAttribute xp _ot node getAttribute ot _hasOriginalTrainer node getBoolAttribute has_original_trainer _moves loadXml node getChildren MoveBlock XML_NODE_NAME get 0 _stats loadXml node getChildren StatBlock XML_NODE_NAME get 0 String conditionString node getChildren condition get 0 getValue if conditionString null for String ce conditionString replace replace trim split if ce isEmpty continue addConditionEffect ConditionEffect valueOf ce trim
4 172 private void checkNewMoves if _moves newMoves level isEmpty
4 172 private int xpNeededAtLevel GrowthRate rate GrowthRate valueOf _species getGrowthrate return rate xp level @Override
4 172 public boolean equals Object o if o instanceof Pokemon return false Pokemon p Pokemon o if number p number return false if level p level return false if xp p xp return false if name equals p name return false return true @Override
4 172 public int hashCode return name hashCode 255 _number _level
4 172 private MoveBlock _moves
4 172 private StatBlock _stats
4 172 private String _name _ot
4 172 private PokemonInfo _species
4 172 private int _number _level _xp
4 172 private boolean _hasOriginalTrainer
4 172 private List ConditionEffect conditionEffects new ArrayList
4 173 public class PokemonInfo @PrimaryKey
4 173 private int number
4 173 private String name
4 173 private int type1 type2 attack specattack defense specdefense speed health evolutionlevel xpyield growthrate catchrate @OneToMany pokemon
4 173 private List EffortValue effortValues
4 173 private static Map Integer PokemonInfo cache new HashMap Integer PokemonInfo
4 173 public static PokemonInfo get int num DataConnectionManager init JPokemonServer databasepath if cache get num null try List PokemonInfo pokemonbase SqlStatement select PokemonInfo class where number eq num getList if pokemonbase isEmpty cache put num pokemonbase get 0 catch DataConnectionException e e printStackTrace return cache get num
4 173 public String toString return Pokemon getNumber getName
4 173 public String getName return name
4 173 public void setName String val name val
4 173 public int getNumber return number
4 173 public void setNumber int val number val
4 173 public int getType1 return type1
4 173 public void setType1 int val type1 val
4 173 public int getType2 return type2
4 173 public void setType2 int val type2 val
4 173 public int getAttack return attack
4 173 public void setAttack int val attack val
4 173 public int getSpecattack return specattack
4 173 public void setSpecattack int val specattack val
4 173 public int getDefense return defense
4 173 public void setDefense int val defense val
4 173 public int getSpecdefense return specdefense
4 173 public void setSpecdefense int val specdefense val
4 173 public int getSpeed return speed
4 173 public void setSpeed int val speed val
4 173 public int getHealth return health
4 173 public void setHealth int val health val
4 173 public int getEvolutionlevel return evolutionlevel
4 173 public void setEvolutionlevel int val evolutionlevel val
4 173 public int getXpyield return xpyield
4 173 public void setXpyield int val xpyield val
4 173 public int getGrowthrate return growthrate
4 173 public void setGrowthrate int val growthrate val
4 173 public int getCatchrate return catchrate
4 173 public void setCatchrate int val catchrate val
4 173 public List EffortValue getEffortValues return effortValues
4 173 public void setEffortValues List EffortValue val effortValues
4 174 public enum Type NORMAL FIRE WATER ELECTRIC GRASS ICE FIGHTING POISON GROUND FLYING PSYCHIC BUG ROCK GHOST DRAGON
4 174 public static Type valueOf int r if r 0 r Type values length return null return Type values r @SuppressWarnings incomplete switch
4 174 public Effectiveness effectiveness Type t switch this case NORMAL switch t case ROCK return Effectiveness NOT_VERY case GHOST return Effectiveness IMMUNE break case FIRE switch t case GRASS case ICE case BUG return Effectiveness SUPER case FIRE case WATER case ROCK case DRAGON return Effectiveness NOT_VERY break case WATER switch t case FIRE case GROUND case ROCK return Effectiveness SUPER case WATER case GRASS case DRAGON return Effectiveness NOT_VERY break case ELECTRIC switch t case WATER case FLYING return Effectiveness SUPER case ELECTRIC case GRASS case DRAGON return Effectiveness NOT_VERY case GROUND return Effectiveness IMMUNE break case GRASS switch t case WATER case GROUND case ROCK return Effectiveness SUPER case FIRE case GRASS case POISON case FLYING case BUG case DRAGON return Effectiveness NOT_VERY break case ICE switch t case GRASS case GROUND case FLYING case DRAGON return Effectiveness SUPER case FIRE case WATER case ICE return Effectiveness NOT_VERY break case FIGHTING switch t case NORMAL case ICE case ROCK return Effectiveness SUPER case POISON case FLYING case PSYCHIC case BUG return Effectiveness NOT_VERY case GHOST return Effectiveness IMMUNE break case POISON switch t case GRASS return Effectiveness SUPER case POISON case GROUND case ROCK case GHOST return Effectiveness NOT_VERY break case GROUND switch t case FIRE case ELECTRIC case POISON case ROCK return Effectiveness SUPER case GRASS case BUG return Effectiveness NOT_VERY case FLYING return Effectiveness IMMUNE break case FLYING switch t case GRASS case FIGHTING case BUG return Effectiveness SUPER case ELECTRIC case ROCK return Effectiveness NOT_VERY break case PSYCHIC switch t case FIGHTING case POISON return Effectiveness SUPER case PSYCHIC return Effectiveness NOT_VERY break case BUG switch t case GRASS case PSYCHIC return Effectiveness SUPER case FIRE case FIGHTING case POISON case FLYING case GHOST return Effectiveness NOT_VERY break case ROCK switch t case FIRE case ICE case FLYING case BUG return Effectiveness SUPER case FIGHTING case GROUND return Effectiveness NOT_VERY break case GHOST switch t case PSYCHIC case GHOST return Effectiveness SUPER case NORMAL return Effectiveness IMMUNE break case DRAGON if t DRAGON return Effectiveness SUPER break return Effectiveness NORMAL
4 174 public enum Effectiveness IMMUNE NOT_VERY NORMAL
4 175 public class UpgradeActivity implements Activity @Override
4 175 public void onAdd Player player @Override
4 175 public void logout Player player @Override
4 175 public void onReturn Activity activity Player player @Override
4 175 public void serve JSONObject request Player player throws ServiceException Pokemon pokemon getPokemon player request try JSONArray stats request getJSONArray stats for int i 0 i stats length i StatType s StatType valueOf stats getJSONObject i getString stat pokemon statPoints s stats getJSONObject i getInt amount catch JSONException e
4 175 private static Pokemon getPokemon Player player JSONObject request throws ServiceException int pokemonIndex 1 Pokemon pokemon null try pokemonIndex request getInt pokemon catch JSONException e throw new ServiceException Pokemon index not provided try pokemon player party get pokemonIndex catch IllegalArgumentException e throw new ServiceException Pokemon index pokemonIndex not found return
4 176 public class Move
4 176 public static final String XML_NODE_NAME move
4 176 public Move int number setNumber number
4 176 public int number return _info getNumber
4 176 public String name return _info getName
4 176 public int power return _info getPower
4 176 public int pp return _pp
4 176 public int ppMax return _ppMax
4 176 public double accuracy return _info getAccuracy
4 176 public MoveStyle style return _style
4 176 public Type type return _type
4 176 public int turns if style MoveStyle DELAYNEXT style MoveStyle DELAYBEFORE return 2 return 1
4 176 public boolean enabled return _enabled _pp 0
4 176 public void enable boolean b _enabled b
4 176 public void setNumber int number if number 1 _info null else _info MoveInfo get number _pp _ppMax _info getPp _type Type valueOf _info getType _style MoveStyle valueOf _info getStyle _enabled number 0
4 176 public void restore _pp _ppMax _enabled true
4 176 public boolean use boolean success enabled accuracy Math random if success _pp return success
4 176 public double STAB Pokemon p return STAB p type1 p type2
4 176 public double STAB Type t1 Type t2 Type type type return type t1 type t2 1 5 1 0
4 176 public int reps if style MoveStyle REPEAT return 1 double chance Math random if chance 0 9947916667 return 5 else if chance 0 9583333333 return 4 else if chance 0 6666666667 return 3 else return 2
4 176 public void applyEffects Slot user Slot target int damage for MoveEffect effect _info getEffects effect effect user target damage
4 176 public boolean hurtUserOnMiss return number 60 number 69
4 176 public boolean doesDamage return style MoveStyle STATUS
4 176 public boolean damageIsAbsolute return false
4 176 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute number number node setAttribute pp _pp node setAttribute ppmax _ppMax node setAttribute enabled _enabled node setSelfClosing true return node
4 176 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node setNumber Integer parseInt node getAttribute number _ppMax node getIntAttribute ppmax _pp node getIntAttribute pp @Override
4 176 public boolean equals Object o if o instanceof Move return false Move m Move o return _info m _info _ppMax m _ppMax
4 176 public int hashCode return _type ordinal 1375 _style ordinal 71
4 176 private Type _type
4 176 private MoveInfo _info
4 176 private int _pp _ppMax
4 176 private boolean _enabled
4 176 private MoveStyle
4 177 public class MoveBlock implements Iterable Move
4 177 public static final String XML_NODE_NAME moves
4 177 public static int movecount 4 static Myna configure MoveBlock class org jpokemon pokemon move
4 177 public MoveBlock int pokemonNumber _pokemon pokemonNumber _data new Move movecount for int i 0 i movecount i _data i new Move 1 try for MoveMap map MoveMap get _pokemon 1 add map getMove_number catch IllegalStateException e e printStackTrace catch IllegalArgumentException e e printStackTrace
4 177 public void setPokemonNumber int number _pokemon number
4 177 public int count return _count
4 177 public Move get int i if i 0 i _count throw new IllegalArgumentException Index out of bounds return _data i
4 177 public void add int number if number 0 throw new IllegalArgumentException Move number out of bounds if _count movecount throw new IllegalStateException MoveBlock is full add number _count
4 177 public void add int number int position if number 0 throw new IllegalArgumentException Move number out of bounds if position 0 position _count throw new IllegalArgumentException Position out of bounds position if contains number throw new IllegalArgumentException Duplicate move number _data position setNumber number _count
4 177 public void restoreAll for Move move this move restore
4 177 public void removeAll for Move m _data m setNumber 1 _count 0
4 177 public List String newMoves int level List MoveMap maps MoveMap get _pokemon level List String names new ArrayList String for MoveMap map maps names add MoveInfo get map getMove_number getName return names
4 177 public void randomize int level ArrayList Integer possible new ArrayList Integer for int currentLevel 1 currentLevel level currentLevel for MoveMap map MoveMap get _pokemon currentLevel if possible contains map getMove_number possible add map getMove_number if possible isEmpty return removeAll while possible isEmpty _count movecount add possible remove int Math random possible size
4 177 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME for Move m this node addChild m toXml return node
4 177 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node removeAll for XmlNode childNode node getChildren Move XML_NODE_NAME _data _count loadXml childNode _count @Override
4 177 public Iterator Move iterator return new MoveBlockIterator
4 177 private boolean contains int number for Move m this if m number number return true return false
4 177 private class MoveBlockIterator implements Iterator Move
4 177 public MoveBlockIterator _index 0 @Override
4 177 public boolean hasNext return _index MoveBlock this _count @Override
4 177 public Move next return MoveBlock this get _index @Override
4 177 public void remove
4 177 private int _index
4 177 private Move _data
4 177 private int _count
4 178 public class MoveInfo @PrimaryKey
4 178 private int number
4 178 private String name
4 178 private double accuracy
4 178 private int type power pp style @OneToMany move_number
4 178 private List MoveEffect effects new ArrayList MoveEffect
4 178 private static Map Integer MoveInfo cache new HashMap Integer MoveInfo
4 178 public static MoveInfo get int number DataConnectionManager init JPokemonServer databasepath if cache get number null try List MoveInfo moves SqlStatement select MoveInfo class where number eq number getList if moves isEmpty cache put number moves get 0 catch DataConnectionException e e printStackTrace return cache get number
4 178 public String toString return Move getNumber getName
4 178 public int getNumber return number
4 178 public void setNumber int n number n
4 178 public String getName return name
4 178 public void setName String s name s
4 178 public double getAccuracy return accuracy
4 178 public void setAccuracy double d accuracy d
4 178 public int getType return type
4 178 public void setType int t type t
4 178 public int getPower return power
4 178 public void setPower int p power p
4 178 public int getPp return pp
4 178 public void setPp int p pp p
4 178 public int getStyle return style
4 178 public void setStyle int s style s
4 178 public List MoveEffect getEffects return effects
4 178 public void setEffects List MoveEffect l effects
4 179 public class MoveMap
4 179 private int pokemon_number pokemon_level move_number
4 179 private static Map Integer Map Integer List MoveMap cache new HashMap Integer Map Integer List MoveMap
4 179 public static List MoveMap get int number int level DataConnectionManager init JPokemonServer databasepath ensureCacheExists number if cache get number get level null try List MoveMap maps SqlStatement select MoveMap class where pokemon_number eq number and pokemon_level eq level getList cache get number put level maps catch DataConnectionException e e printStackTrace return cache get number get level
4 179 public static List MoveMap get int number DataConnectionManager init JPokemonServer databasepath try List MoveMap maps SqlStatement select MoveMap class where pokemon_number eq number getList return maps catch DataConnectionException e e printStackTrace return new ArrayList MoveMap
4 179 private static void ensureCacheExists int number if cache get number null cache put number new HashMap Integer List MoveMap
4 179 public int getPokemon_number return pokemon_number
4 179 public void setPokemon_number int val pokemon_number val
4 179 public int getPokemon_level return pokemon_level
4 179 public void setPokemon_level int val pokemon_level val
4 179 public int getMove_number return move_number
4 179 public void setMove_number int val move_number
4 180 public enum MoveStyle PHYSICAL SPECIAL OHKO STATUS REPEAT DELAYNEXT DELAYBEFORE MISC
4 180 public static MoveStyle valueOf int style return values
4 181 public class MoveEffect
4 181 public void effect Slot user Slot enemy int damage if chance Math random return MoveEffectType type MoveEffectType valueOf this type Target target Target valueOf this target Pokemon pokemon target Target SELF user leader enemy leader if type isStatModifier pokemon getStat StatType valueOf type toString effect power else if type isConditionModifier pokemon addConditionEffect ConditionEffect valueOf type toString else if type isFieldModifier user addSlotEffect new SlotEffect SlotEffectType valueOf type toString user enemy else if type MoveEffectType HEALTH_MOD pokemon healDamage int pokemon maxHealth power 1000 0
4 181 private double chance
4 181 private int move_number type target power
4 181 public int getMove_number return move_number
4 181 public void setMove_number int val move_number val
4 181 public int getType return type
4 181 public void setType int val type val
4 181 public int getTarget return target
4 181 public void setTarget int val target val
4 181 public int getPower return power
4 181 public void setPower int val power val
4 181 public double getChance return chance
4 181 public void setChance double val chance
4 182 public enum MoveEffectType ATTACK DEFENSE SPECATTACK SPECDEFENSE SPEED BURN PARALYZE SLEEP POISON FREEZE CONFUSE WRAP FLINCH SEED PHYSICAL_SHIELD SPECIAL_SHIELD INVULERNABLE HEALTH_MOD
4 182 public static MoveEffectType valueOf int style return values style
4 182 public boolean isStatModifier return ordinal SPEED ordinal
4 182 public boolean isConditionModifier return ordinal SPEED ordinal ordinal FLINCH ordinal
4 182 public boolean isFieldModifier return ordinal FLINCH ordinal ordinal INVULERNABLE
4 183 public class Health extends Stat @Override
4 183 public void effect int power _cur power if _cur _max _cur _max else if _cur 0 _cur
4 184 public class Stat
4 184 public static final String XML_NODE_NAME stat
4 184 public static int ivmax 32
4 184 public static int delta 6
4 184 public static double baseweight 2 0
4 184 public static double evweight 0 25
4 184 public static double ivweight 1 0
4 184 public static double bonusweight 1 0 static Myna configure Stat class org jpokemon pokemon stat
4 184 public Stat _level 1 _modifier 1 _iv int Math random ivmax
4 184 public int cur return _cur
4 184 public int max return _max
4 184 public int ev return _ev
4 184 public void ev int val _ev val computeMax computeCur
4 184 public int iv return _iv
4 184 public void iv int val _iv val computeMax computeCur
4 184 public int points return _pts
4 184 public void points int p _pts p reset
4 184 public void level int l _level l reset
4 184 public void base int b _base b reset
4 184 public void modify double m _modifier m computeCur
4 184 public void effect int power _delta power if Math abs _delta delta _delta int Math copySign delta _delta computeCur
4 184 public void reset _delta 0 computeMax computeCur
4 184 public XmlNode toXml XmlNode myNode new XmlNode XML_NODE_NAME myNode setAttribute cur _cur myNode setAttribute max _max myNode setAttribute points _pts myNode setAttribute ev _ev myNode setAttribute iv _iv myNode setSelfClosing true return myNode
4 184 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node _cur node getIntAttribute cur _max node getIntAttribute max _pts node getIntAttribute points _ev node getIntAttribute ev _iv node getIntAttribute iv
4 184 private void computeMax double val baseweight _base val ivweight _iv val evweight _ev val bonusweight _pts val 100 val 100 val _level val 10 _max int val
4 184 private void computeCur if _delta 0 _cur int _max 2 0 _delta 2 else if _delta 0 _cur int _max 2 0 2 _delta else _cur _max _cur int Math max _cur _modifier 1
4 184 protected double _modifier
4 184 protected int _delta _cur _max _base _pts _level _ev
4 185 public class StatBlock
4 185 public static final String XML_NODE_NAME stats
4 185 public static int evmax 255
4 185 public static int totalevmax 510
4 185 public static int bonusmax 15
4 185 public static double bonuslevelrate 1 0 static Myna configure StatBlock class org jpokemon pokemon stat
4 185 public StatBlock PokemonInfo info _data new Stat StatType values length _data 0 new Health for int i 1 i _data length i _data i new Stat rebase info
4 185 public Stat get StatType type return _data type ordinal
4 185 public void reset for Stat s _data s reset
4 185 public void level int level for Stat s _data s level level
4 185 public int points return _points
4 185 public void points int p _points p
4 185 public void usePoints StatType st int amount if points amount throw new IllegalStateException No points available Stat stat get st int consumable Math min bonusmax stat points amount if consumable 0 return points points amount stat points stat points amount
4 185 public void rebase PokemonInfo info _data StatType HEALTH ordinal base info getHealth _data StatType ATTACK ordinal base info getAttack _data StatType SPECATTACK ordinal base info getSpecattack _data StatType DEFENSE ordinal base info getDefense _data StatType SPECDEFENSE ordinal base info getSpecdefense _data StatType SPEED ordinal base info getSpeed
4 185 public void addEV List EffortValue evs for EffortValue ev evs Stat stat get StatType valueOf ev getStat int consumable ev getAmount if _evTotal ev getAmount totalevmax consumable totalevmax _evTotal if stat ev consumable evmax consumable evmax stat ev _evTotal consumable stat ev consumable
4 185 public void addConditionEffect ConditionEffect i if i ConditionEffect BURN _burn true _data StatType ATTACK ordinal modify 1 0 2 0 else if i ConditionEffect PARALYZE _paralyze true _data StatType SPEED ordinal modify 1 0 4 0
4 185 public void removeConditionEffect ConditionEffect i if i ConditionEffect BURN _burn _burn false _data StatType ATTACK ordinal modify 1 else if i ConditionEffect PARALYZE _paralyze _paralyze false _data StatType SPEED ordinal modify 1
4 185 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute points _points node setAttribute evtotal _evTotal for StatType st StatType values XmlNode child get st toXml child setAttribute type st toString node addChild child return node
4 185 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node _points node getIntAttribute points _evTotal node getIntAttribute evtotal for XmlNode childNode node getChildren Stat XML_NODE_NAME Stat s get StatType valueOf childNode getAttribute type s loadXml childNode
4 185 private Stat _data
4 185 private int _points _evTotal
4 185 private boolean _burn
4 186 public enum StatType HEALTH ATTACK SPECATTACK DEFENSE SPECDEFENSE SPEED
4 186 public static StatType valueOf int s return StatType values
4 187 public class PokemonStorageBlock implements Iterable PokemonStorageUnit
4 187 public static final String XML_NODE_NAME pokemonstorage
4 187 public static int boxsize 20
4 187 public static int boxcount 8 static Myna configure PokemonStorageBlock class org jpokemon player
4 187 public PokemonStorageBlock _data new PokemonStorageUnit boxcount 1 _data 0 new PokemonStorageUnit for int i 1 i boxcount i _data i new PokemonStorageUnit boxsize
4 187 public PokemonStorageUnit get int box if box 0 box boxcount throw new IllegalArgumentException Invalid box number box return _data box
4 187 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME for PokemonStorageUnit psu _data node addChild psu toXml return node
4 187 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node int i 0 for XmlNode child node getChildren PokemonStorageUnit XML_NODE_NAME get i loadXml child @Override
4 187 public Iterator PokemonStorageUnit iterator return new PokemonStorageBlockIterator
4 187 private class PokemonStorageBlockIterator implements Iterator PokemonStorageUnit @Override
4 187 public boolean hasNext return index boxcount @Override
4 187 public PokemonStorageUnit next return _data index @Override
4 187 public void remove
4 187 private int index 0
4 187 private PokemonStorageUnit
4 188 public class PokemonStorageUnit implements Iterable Pokemon
4 188 public static final String XML_NODE_NAME pokemonbox
4 188 public static int partysize 6 static Myna configure PokemonStorageUnit class org jpokemon player
4 188 public PokemonStorageUnit this partysize
4 188 public PokemonStorageUnit int size _size size _amount 0 _version 0 _data new Pokemon _size
4 188 public int size return _amount
4 188 public Pokemon get int i if i 0 i _amount throw new IllegalArgumentException Index out of bounds i return _data i
4 188 public boolean add Pokemon p if p null _amount _size contains p return false _data _amount p _version return true
4 188 public boolean remove Pokemon p int index indexOf p if index 0 throw new IllegalArgumentException Not in this unit p _version return remove index
4 188 public boolean slide int indexOld int indexNew if indexOld 0 indexNew 0 indexOld _amount indexNew _amount throw new IllegalArgumentException Index out of bounds if indexOld indexNew throw new IllegalArgumentException Arguments are equal Pokemon swap _data indexOld int loopUpdateDirection indexOld indexNew 1 1 for int i indexOld i indexNew i i loopUpdateDirection _data i _data i loopUpdateDirection _data indexNew swap return true
4 188 public boolean swap int p1 int p2 if p1 0 p2 0 p1 _amount p2 _amount throw new IllegalArgumentException Index out of bounds if p1 p2 throw new IllegalArgumentException Arguments are equal Pokemon swap _data p1 _data p1 _data p2 _data p2 swap _version return true
4 188 public int indexOf Pokemon p for int i 0 i _amount i if _data i equals p return i return 1
4 188 public boolean contains Pokemon p return indexOf p 1
4 188 public int awake int answer 0 for Pokemon pokemon this if pokemon awake answer return answer
4 188 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME for Pokemon p this node addChild p toXml return node
4 188 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node while _amount 0 remove 0 for XmlNode child node getChildren Pokemon XML_NODE_NAME Pokemon p new Pokemon 1 p loadXml child add p
4 188 public Iterator Pokemon iterator return new PokemonStorageUnitIterator
4 188 private boolean remove int index if index 0 index _amount throw new IllegalArgumentException Index out of bounds for int i index i _amount 1 i _data i _data i 1 _data _amount null return true
4 188 private class PokemonStorageUnitIterator implements Iterator Pokemon
4 188 public PokemonStorageUnitIterator _index 0 _version PokemonStorageUnit this _version @Override
4 188 public boolean hasNext checkVersion return _index PokemonStorageUnit this _amount @Override
4 188 public Pokemon next checkVersion return PokemonStorageUnit this get _index @Override
4 188 public void remove
4 188 private void checkVersion if _version PokemonStorageUnit this _version throw new ConcurrentModificationException
4 188 private int _index _version
4 188 private Pokemon _data
4 188 private int _size _amount
4 189 public class FileServlet extends HttpServlet
4 189 public static String webdir web
4 189 public static String cache static Myna configure FileServlet class org jpokemon server
4 189 public FileServlet resourceHandler new ResourceHandler resourceHandler setWelcomeFiles new String index html resourceHandler setDirectoriesListed false resourceHandler setCacheControl cache resourceHandler setResourceBase webdir @Override
4 189 protected void doGet HttpServletRequest req HttpServletResponse resp throws ServletException IOException resourceHandler handle req getRequestURI Request req req resp if resp isCommitted resp setStatus HttpServletResponse SC_NOT_FOUND resp setContentType text html resp getWriter println h1 Resource Not Found h1 br Sorry the resource you ve requested could not be located
4 189 private ResourceHandler resourceHandler
4 189 private static final long serialVersionUID
4 190 public class JPokemonServer
4 190 public static int port 9001
4 190 public static String savepath data save
4 190 public static String imagepath data image
4 190 public static String scriptedbattlepath data trainer
4 190 public static String databasepath data Pokemon db static Myna configure JPokemonServer class org jpokemon server
4 190 public static void main String args throws Exception BasicConfigurator configure PlayerManager bootstrapServices logger trace Spinning up servlets ServletContextHandler root new ServletContextHandler root setContextPath root addServlet new ServletHolder new FileServlet root addServlet new ServletHolder new JPokemonWebSocketServlet socket logger info Server starting on port port Server server new Server port server setHandler root server start server join
4 190 private static Logger logger Logger getLogger JPokemonServer
4 191 public interface JPokemonService
4 191 public void login Player player
4 191 public void logout Player player
4 191 public void serve JSONObject request Player player throws ServiceException
4 191 public JSONObject load JSONObject request Player
4 192 public class JPokemonWebSocket implements WebSocket OnTextMessage
4 192 private Connection connection @Override
4 192 public void onClose int arg0 String arg1 PlayerManager close this @Override
4 192 public void onOpen Connection c connection c @Override
4 192 public void onMessage String arg0 try PlayerManager dispatch this new JSONObject arg0 catch JSONException e e printStackTrace catch ServiceException e e printStackTrace
4 192 public void sendJson JSONObject json try connection sendMessage json toString catch IOException e e
4 193 public class JPokemonWebSocketServlet extends WebSocketServlet
4 193 private static final long serialVersionUID 1L @Override
4 193 public WebSocket doWebSocketConnect HttpServletRequest arg0 String arg1 return new
4 194 public class Message
4 194 public Message String messageClass String text this messageClass messageClass this text text
4 194 public Message String text this update text
4 194 public JSONObject toJson try return getJson catch JSONException e return null
4 194 protected JSONObject getJson throws JSONException JSONObject json new JSONObject json put action notification messageClass json put text text return json
4 194 private String text
4 194 private String
4 195 public class PlayerManager
4 195 public static boolean playerIsLoggedIn String name boolean result synchronized players result players containsKey name return result
4 195 public static boolean playerExists String name if playerIsLoggedIn name return true String filename name jpkmn File file new File JPokemonServer savepath filename if file exists file getName equals filename return false return true
4 195 public static Player getPlayer String name Player player synchronized players player players get name return player
4 195 public static List String getOnlinePlayerNames List String playerNames null synchronized players playerNames Collections unmodifiableList new ArrayList String players keySet return playerNames
4 195 public static void bootstrapServices services new HashMap String JPokemonService services put overworld new OverworldService services put lobby new LobbyService services put friends new FriendsService services put party new PartyService
4 195 public static JPokemonService getService String name return services get name
4 195 public static boolean hasActivity Player player return activities get player id isEmpty
4 195 public static Activity getActivity Player player Stack Activity stack activities get player id return stack peek
4 195 public static void addActivity Player player Activity a try activities get player id add a a onAdd player catch ServiceException e e printStackTrace
4 195 public static void popActivity Player player Activity a if getActivity player a throw new IllegalStateException Popped activity is not most recent activities get player id pop if hasActivity player getActivity player onReturn a player
4 195 public static void pushMessage Player player Message message pushJson player message toJson
4 195 public static void pushJson Player player JSONObject json if json null return JPokemonWebSocket webSocket synchronized players webSocket sockets get player id webSocket sendJson json
4 195 public static void dispatch JPokemonWebSocket socket JSONObject request throws JSONException ServiceException String playerId synchronized players playerId sessions get socket if playerId null login socket request return Player player getPlayer playerId if request has load String serviceName request getString load JPokemonService service services get serviceName PlayerManager pushJson player service load request player else if hasActivity player Activity a getActivity player a serve request player else if request has service String serviceName request getString service JPokemonService service services get serviceName service serve request player
4 195 public static void close JPokemonWebSocket socket String playerId synchronized players playerId sessions get socket if playerId null return Player player getPlayer playerId System out println player session closed File file new File JPokemonServer savepath playerId jpkmn try Writer writer new BufferedWriter new PrintWriter file writer write player toXml printToString 0 t writer close catch IOException e e printStackTrace for JPokemonService service services values service logout player while hasActivity player activities get player id pop logout player activities remove playerId synchronized players sessions remove socket sockets remove playerId players remove playerId
4 195 private static void login JPokemonWebSocket socket JSONObject request throws JSONException ServiceException if request has login throw new ServiceException No credentials found String name request getString login if playerIsLoggedIn name Message message new Message error Player name is already logged in socket sendJson message toJson return if playerExists name Message message new Message error Player name save not found socket sendJson message toJson return Player player new Player name System out println player session opened String filename name jpkmn File file new File JPokemonServer savepath filename try player loadXML XmlParser parse file get 0 catch FileNotFoundException e synchronized players players put name player sockets put name socket sessions put socket name for JPokemonService service services values service login player activities put name new Stack Activity JSONObject closeLoginJson new JSONObject try closeLoginJson put action login accept catch JSONException e pushJson player closeLoginJson
4 195 private static Map String JPokemonService services
4 195 private static volatile Map String Player players new HashMap String Player
4 195 private static volatile Map String JPokemonWebSocket sockets new HashMap String JPokemonWebSocket
4 195 private static volatile Map JPokemonWebSocket String sessions new HashMap JPokemonWebSocket String
4 195 private static Map String Stack Activity activities new HashMap String Stack
4 196 public class ServiceException extends Exception
4 196 public ServiceException String message _message message
4 196 public String getMessage return _message
4 196 private String _message
4 196 private static final long serialVersionUID
4 197 public class Event @PrimaryKey @AutoIncrement
4 197 private int number
4 197 private String description
4 197 public static Event createNew Event event new Event event setDescription undefined try SqlStatement insert event execute catch DataConnectionException e event null e printStackTrace return event
4 197 public static Event get int number DataConnectionManager init JPokemonServer databasepath Event event null try List Event query SqlStatement select Event class where number eq number getList if query isEmpty event query get 0 catch DataConnectionException e e printStackTrace return event
4 197 public void commit try SqlStatement update this execute catch DataConnectionException e e printStackTrace
4 197 public String toString return Event getNumber getDescription
4 197 public int getNumber return number
4 197 public void setNumber int n number n
4 197 public String getDescription return description
4 197 public void setDescription String s description
4 198 public class Player implements PokemonTrainer
4 198 public static final String XML_NODE_NAME player
4 198 private String _id _avatar
4 198 private Bag _bag new Bag
4 198 private Pokedex _pokedex new Pokedex
4 198 private Record _record new Record this
4 198 private Location location new Location
4 198 private int _badge _cash _xp _level
4 198 private Map String List String _friends new HashMap String List String
4 198 private List String _unlockedAvatars new ArrayList String
4 198 private PokemonStorageBlock _storage new PokemonStorageBlock
4 198 public Player String id _id id
4 198 public String id return _id
4 198 public int getCash return _cash
4 198 public void setCash int cash _cash cash
4 198 public int getExperience return _xp
4 198 public void setExperience int xp _xp xp
4 198 public String getAvatar return _avatar
4 198 public void setAvatar String name if _unlockedAvatars contains name return _avatar name
4 198 public List String getAvatars return Collections unmodifiableList _unlockedAvatars
4 198 public void addAvatar String name _unlockedAvatars add name
4 198 public void removeAvatar String name _unlockedAvatars remove name
4 198 public int getLevel return _level
4 198 public void setLevel int level _level level
4 198 public Location getLocation return location
4 198 public Player setLocation Location location this location location return this
4 198 public List String getFriends if _friends get friends null return new ArrayList String return Collections unmodifiableList _friends get friends
4 198 public void addFriend String name if _friends get friends null _friends put friends new ArrayList String _friends get friends add name removeBlocked name
4 198 public void removeFriend String name if _friends get friends null return _friends get friends remove name
4 198 public List String getBlocked if _friends get blocked null return new ArrayList String return Collections unmodifiableList _friends get blocked
4 198 public void addBlocked String name if _friends get blocked null _friends put blocked new ArrayList String _friends get blocked add name removeFriend name
4 198 public void removeBlocked String name if _friends get blocked null return _friends get blocked remove name
4 198 public int getBadgeCount return _badge
4 198 public void setBadgeCount int badge _badge badge
4 198 public Bag getBag return _bag
4 198 public Item item int itemID return _bag get itemID
4 198 public PokemonStorageUnit party return box 0
4 198 public PokemonStorageUnit box int box return _storage get box
4 198 public PokemonStorageBlock getAllPokemon return _storage
4 198 public boolean add Pokemon p if _record getStarterPokemon null _record setStarterPokemon p name for PokemonStorageUnit unit _storage if unit add p _pokedex own p number p setTrainerName id return true return false
4 198 public Pokedex pokedex return _pokedex
4 198 public Record record return _record
4 198 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute cash _cash node setAttribute badge _badge if _avatar null node setAttribute avatar _avatar node addChild location toXml node addChild _bag toXml node addChild _record toXml node addChild _pokedex toXml node addChild _storage toXml XmlNode friends new XmlNode friends if _friends get friends null friends setValue _friends get friends toString node addChild friends XmlNode blocked new XmlNode blocked if _friends get blocked null blocked setValue _friends get blocked toString node addChild blocked XmlNode avatars new XmlNode avatars avatars setValue _unlockedAvatars toString node addChild avatars return node
4 198 public void loadXML XmlNode node _cash node getIntAttribute cash _badge node getIntAttribute badge location loadXml node getChildren Location XML_NODE_NAME get 0 _bag loadXml node getChildren Bag XML_NODE_NAME get 0 _record loadXml node getChildren Record XML_NODE_NAME get 0 _pokedex loadXml node getChildren Pokedex XML_NODE_NAME get 0 _storage loadXml node getChildren PokemonStorageBlock XML_NODE_NAME get 0 String friendsString node getChildren friends get 0 getValue if friendsString null for String f friendsString replace replace trim split if f isEmpty continue addFriend f String blockedString node getChildren blocked get 0 getValue if blockedString null for String f blockedString replace replace trim split if f isEmpty continue addBlocked f try String avatarsString node getChildren avatars get 0 getValue for String avatar avatarsString replace replace split addAvatar avatar trim if node hasAttribute avatar _avatar node getAttribute avatar else _avatar male hero 1 catch Exception e _unlockedAvatars new ArrayList String _unlockedAvatars add male hero 1 setAvatar male hero 1 @Override
4 198 public boolean equals Object o if o instanceof Player return false return Player o _id equals _id @Override
4 198 public int hashCode return _id hashCode @Override
4 198 public String toString return Player@ hashCode
4 199 public interface PokemonTrainer
4 199 public String id
4 199 public PokemonStorageUnit party
4 199 public boolean add Pokemon
4 200 public class Progress
4 200 public static final String XML_NODE_NAME progress
4 200 public Progress _events new ArrayList Integer
4 200 public void put int id if id 1 throw new IllegalArgumentException Out of bounds event id if _events contains id throw new IllegalArgumentException Duplicate put for event id _events add id
4 200 public boolean get int id if id 1 throw new IllegalArgumentException Out of bounds event id return _events contains id
4 200 public JSONArray toJSON JSONArray data new JSONArray for Integer i _events data put i intValue return data
4 200 public XmlNode toXML XmlNode node new XmlNode XML_NODE_NAME node setValue _events toString return node
4 200 public void loadXML XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node for String value node getValue replace replace trim split if value isEmpty continue put Integer parseInt value
4 200 private List Integer
4 201 public class Record
4 201 public static final String XML_NODE_NAME record
4 201 public Record Player p player p
4 201 public void setRivalName String rivalName _rivalName rivalName
4 201 public String getRivalName return _rivalName
4 201 public void setStarterPokemon String p _pokemon p
4 201 public String getStarterPokemon return _pokemon
4 201 public void putEvent int id if id 1 throw new IllegalArgumentException Out of bounds event id if _events contains id throw new IllegalArgumentException Duplicate put for event id _events add id
4 201 public boolean getEvent int id if id 1 throw new IllegalArgumentException Out of bounds event id return _events contains id
4 201 public void putTrainer String id if _trainers contains id throw new IllegalArgumentException Duplicate put for trainer id _trainers add id
4 201 public boolean getTrainer String id return _trainers contains id
4 201 public String replaceMacros String s if _rivalName null s s replaceAll rival _rivalName if player null s s replaceAll player player id if _pokemon null s s replaceAll starter _pokemon return s
4 201 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME if _rivalName null node setAttribute rival _rivalName if _pokemon null node setAttribute starter _pokemon XmlNode eventNode new XmlNode events eventNode setValue _events toString node addChild eventNode XmlNode trainerNode new XmlNode trainers trainerNode setValue _trainers toString node addChild trainerNode return node
4 201 public void loadXml XmlNode node if XML_NODE_NAME equals node getName throw new XmlException Cannot read node if node hasAttribute rival _rivalName node getAttribute rival if node hasAttribute starter _pokemon node getAttribute starter for String value node getChildren events get 0 getValue replace replace trim split if value isEmpty continue putEvent Integer parseInt value for String value node getChildren trainers get 0 getValue replace replace trim split if value isEmpty continue putTrainer value
4 201 private Player player
4 201 private String _rivalName _pokemon
4 201 private List Integer _events new ArrayList Integer
4 201 private List String _trainers new ArrayList
4 202 public class Trainer implements PokemonTrainer
4 202 public static String XML_NODE_NAME trainer
4 202 public Trainer String id _id id
4 202 public String id return _id
4 202 public String getName return _name
4 202 public void setName String name _name name
4 202 public boolean isGym return _isGym
4 202 public void setGym boolean isGym _isGym isGym
4 202 public PokemonStorageUnit party return _party
4 202 public boolean add Pokemon p p setTrainerName getName return party add p
4 202 public XmlNode toXml XmlNode node new XmlNode XML_NODE_NAME node setAttribute name _name node setAttribute gym _isGym node addChild _party toXml return node
4 202 public void loadXml XmlNode node _name node getAttribute name _isGym node getBoolAttribute gym _party loadXml node getChildren PokemonStorageUnit XML_NODE_NAME get 0
4 202 public boolean equals Object o if o instanceof Trainer return false return Trainer o _id _id
4 202 public int hashCode return _id hashCode
4 202 private boolean _isGym false
4 202 private String _name null _id null
4 202 private PokemonStorageUnit _party new
4 203 public class WildTrainer implements PokemonTrainer
4 203 public String id return wild_pokemon
4 203 public String getName return Wild Pokemon
4 203 public void setName String s
4 203 public PokemonStorageUnit party return _party
4 203 public boolean add Pokemon p return party add p
4 203 public void notify String message
4 203 private PokemonStorageUnit _party new
4 204 public class PokedexTest extends TestCase
4 204 public static int power 5 range 20 Pokedex dex
4 204 protected void setUp dex new Pokedex
4 204 public void testSaw int cur for int i 0 i power i cur int Math random range 1 dex saw cur assertTrue PokedexStatus SAW dex status cur
4 204 public void testOwn int cur for int i 0 i power i cur int Math random range 1 dex own cur assertTrue PokedexStatus OWN dex status cur
4 204 public void testNoValue int n int Math random range 1 assertEquals PokedexStatus NONE dex status n
4 204 public void testCount assertEquals 0 dex count int n int Math random range 1 dex saw n assertEquals 1 dex count
4 204 public void testOwnOverridesSaw int n int Math random range 1 dex saw n dex own n assertTrue PokedexStatus OWN dex status n
4 204 public void testSawDoesNotOverrideOwn int n int Math random range 1 dex own n dex saw n assertTrue PokedexStatus OWN dex status n
4 204 public void testMinimumValue try dex status 0 fail catch Exception e assertTrue e instanceof IllegalArgumentException try dex saw 0 fail catch Exception e assertTrue e instanceof IllegalArgumentException try dex own 0 fail catch Exception e assertTrue e instanceof
4 205 public class PokemonTest extends TestCase static int number level static Pokemon pokemon static int randomPokemon 1 4 7 10 13
4 205 public void setUp number randomPokemon int Math random randomPokemon length level 5 int Math random 5 pokemon new Pokemon number level
4 205 public void testNumber assertEquals number pokemon number
4 205 public void testName String nickname foo assertEquals pokemon species pokemon name pokemon name nickname assertEquals nickname pokemon name pokemon name null assertEquals pokemon species pokemon name
4 205 public void testXp assertEquals 0 pokemon xp assertEquals level pokemon level pokemon xp 1 assertEquals 1 pokemon xp assertEquals level pokemon level pokemon xp pokemon xpNeeded assertEquals 0 pokemon xp assertEquals level 1 pokemon level
4 205 public void testStatLookup assertEquals pokemon attack pokemon getStat StatType ATTACK cur assertEquals pokemon specattack pokemon getStat StatType SPECATTACK cur assertEquals pokemon defense pokemon getStat StatType DEFENSE cur assertEquals pokemon specdefense pokemon getStat StatType SPECDEFENSE cur assertEquals pokemon speed pokemon getStat StatType SPEED cur
4 205 public void testStatPoints try pokemon statPoints StatType ATTACK 1 fail Cannot spend when have no stat points to spend catch Exception e assertTrue e instanceof IllegalStateException assertEquals 0 pokemon getStat StatType ATTACK points StatBlock bonuslevelrate 1 0 level pokemon level level pokemon statPoints StatType ATTACK 1 assertEquals 1 0 pokemon getStat StatType ATTACK points try pokemon statPoints StatType ATTACK 1 fail Cannot spend when have no stat points to spend catch Exception e assertTrue e instanceof IllegalStateException assertEquals int StatBlock bonuslevelrate pokemon getStat StatType ATTACK points
4 205 public void testDamageAndHealth int maxhealth pokemon maxHealth int damage pokemon health 1 assertTrue pokemon awake pokemon takeDamage damage assertEquals 1 pokemon health assertEquals maxhealth pokemon maxHealth assertTrue pokemon awake pokemon takeDamage 1 assertEquals 0 pokemon health assertEquals maxhealth pokemon maxHealth assertFalse pokemon awake pokemon healDamage 5 assertEquals 5 pokemon health assertEquals maxhealth pokemon maxHealth assertTrue pokemon awake
4 205 public void testOriginalTrainer assertFalse pokemon hasOriginalTrainer assertEquals null pokemon getTrainerName pokemon setTrainerName foo assertTrue pokemon hasOriginalTrainer assertEquals foo pokemon getTrainerName pokemon setTrainerName bar assertTrue pokemon hasOriginalTrainer assertEquals foo pokemon
4 206 public class MoveBlockTest extends TestCase MoveBlock block int pokemonNumber moveRange 40 pokemonRange 25
4 206 public void setUp pokemonNumber 1 int Math random pokemonRange 1 block new MoveBlock pokemonNumber @Test
4 206 public void testEveryPokemonHasDefaultMoves for int i 1 i pokemonRange i pokemonNumber i block new MoveBlock pokemonNumber assertTrue block count 0
4 206 public void testAdd while block count MoveBlock movecount setUp int count block count try block add 0 fail You cannot add Move 0 catch Exception e assertTrue e instanceof IllegalArgumentException assertEquals count block count block add 3 assertEquals count 1 block count int number for number 14 block count MoveBlock movecount number try block add number catch IllegalArgumentException e try for block count MoveBlock movecount number try block add number catch IllegalArgumentException e block add number fail Should die when overadding things catch Exception e assertTrue e instanceof IllegalStateException
4 206 public void testAddOverwrite try block add 3 1 fail Cannot add to position 1 catch Exception e assertTrue e instanceof IllegalArgumentException int moveNumber do moveNumber int Math random moveRange while moveNumber block get 0 number block add moveNumber 0 assertEquals new Move moveNumber block get 0 while block count MoveBlock movecount 1 setUp int count block count try block add 0 count fail You cannot add Move 0 catch Exception e assertTrue e instanceof IllegalArgumentException assertEquals count block count try block add count count 1 catch Exception e assertTrue e instanceof IllegalArgumentException
4 206 public void testRemoveAll block removeAll assertEquals 0 block count
4 206 public void testRestoreAll while block count 2 setUp while block get 0 pp 0 block get 0 use while block get 1 pp 0 block get 1 use assertTrue block get 0 enabled assertTrue block get 1 enabled block restoreAll assertTrue block get 0 enabled assertTrue block get 1 enabled
4 206 public void testRandomizeNoMoves block randomize 0 assertTrue block count 0
4 206 public void testPreventDuplicateMoves int moveNumber int Math random moveRange block removeAll block add moveNumber try block add moveNumber fail Duplicate move allowed catch Exception e assertTrue e instanceof
4 207 public class MoveTest extends TestCase static int moveRange 40 Move move int number MoveInfo answers
4 207 public void setUp number 1 int Math random moveRange move new Move number answers MoveInfo get number @Test
4 207 public void testNumber assertEquals number move number
4 207 public void testName assertEquals answers getName move name
4 207 public void testPpMax assertEquals answers getPp move pp
4 207 public void testType Type type Type valueOf answers getType assertEquals type move type
4 207 public void testDisable assertTrue move enabled move enable false assertFalse move enabled
4 207 public void testPpCount number 141 move new Move number answers MoveInfo get number int random int Math random answers getPp for int i 0 i random i move use assertEquals random answers getPp move pp
4 207 public void testPpExhaustion number 141 move new Move number answers MoveInfo get number assertTrue move enabled for int i answers getPp i 0 i move use assertFalse move enabled
4 207 public void testRestore number 141 move new Move number answers MoveInfo get number assertTrue move enabled for int i answers getPp i 0 i move use assertFalse move enabled move restore assertEquals answers getPp move pp
4 207 public void testReps MoveStyle style MoveStyle valueOf answers getStyle while style MoveStyle REPEAT number 1 int Math random moveRange move new Move number answers MoveInfo get number style MoveStyle valueOf answers getStyle assertTrue move reps 1 while style MoveStyle REPEAT number 1 int Math random moveRange move new Move number answers MoveInfo get number style MoveStyle valueOf answers getStyle assertTrue move reps 1
4 207 public void testSTAB Type type Type valueOf answers getType assertEquals 1 5 move STAB type null while type Type valueOf answers getType type Type valueOf int Math random Type values length assertEquals 1 0 move STAB type null
4 207 public void testRepsDistribution int sampleSize 128 result Map Integer Integer results new HashMap Integer Integer MoveStyle style MoveStyle valueOf answers getStyle while style MoveStyle REPEAT number 1 int Math random moveRange move new Move number answers MoveInfo get number style MoveStyle valueOf answers getStyle for int i 0 i sampleSize i result move reps if results get result null results put result 0 results put result results get result 1 System out println nDistribution of Reps for Map Entry Integer Integer entry results entrySet System out print entry getKey System out println entry getValue 1 0 sampleSize System out
4 208 public class StatBlockTest extends TestCase static int range 25 StatBlock block PokemonInfo pokemon
4 208 public void setUp int pokemonNumber int Math random range 1 pokemon PokemonInfo get pokemonNumber block new StatBlock pokemon block level 100
4 208 public void testGet Stat attackStat block get StatType ATTACK assertEquals pokemon getAttack attackStat _base
4 208 public void testReset Stat specDefenseStat block get StatType SPECDEFENSE Stat healthStat block get StatType HEALTH int specDefense specDefenseStat cur int health healthStat cur specDefenseStat effect 2 healthStat effect 10 assertNotSame specDefense specDefenseStat cur assertNotSame health healthStat cur block reset assertEquals specDefense specDefenseStat cur assertEquals health healthStat cur
4 208 public void testBurnEffectsAttack Stat attackStat block get StatType ATTACK int attack attackStat cur block addConditionEffect ConditionEffect BURN assertEquals Math max attack 2 1 attackStat cur
4 208 public void testBurnEffectRemoval Stat attackStat block get StatType ATTACK int attack attackStat cur block addConditionEffect ConditionEffect BURN assertEquals Math max attack 2 1 attackStat cur block removeConditionEffect ConditionEffect BURN assertEquals attack attackStat cur
4 208 public void testParalyzeEffectsSpeed Stat speedStat block get StatType SPEED int speed speedStat cur block addConditionEffect ConditionEffect PARALYZE assertEquals Math max speed 4 1 speedStat cur
4 208 public void testRemoveMissingConditionIssue Stat attackStat block get StatType ATTACK int attack attackStat cur block removeConditionEffect ConditionEffect BURN assertEquals attack attackStat cur
4 208 public void testParalyzeEffectRemoval Stat speedStat block get StatType SPEED int speed speedStat cur block addConditionEffect ConditionEffect PARALYZE assertEquals Math max speed 4 1 speedStat cur block removeConditionEffect ConditionEffect PARALYZE assertEquals speed speedStat cur
4 208 public void testAddPoint Stat defenseStat block get StatType DEFENSE assertEquals 0 defenseStat points block points 1 block usePoints StatType DEFENSE 1 assertEquals 1 defenseStat points
4 208 public void testCannotAddPointWhenHaveNoPoints Stat defenseStat block get StatType DEFENSE assertEquals 0 defenseStat points block points 0 try block usePoints StatType DEFENSE 1 fail No points to spend catch Exception e assertTrue e instanceof IllegalStateException assertEquals 0 defenseStat
4 209 public class StatTest extends TestCase Stat stat
4 209 public void setUp stat new Stat stat iv 0 stat level 100 stat base 100
4 209 public void testBase assertEquals 310 stat max assertEquals stat max stat cur
4 209 public void testLevel stat level 10 assertEquals 40 stat max assertEquals stat max stat cur
4 209 public void testPoints stat points 100 assertEquals 100 stat points assertEquals 360 stat max assertEquals stat max stat cur
4 209 public void testModify stat modify 1 2 0 assertEquals 155 stat cur
4 209 public void testEffectUpOne stat effect 1 assertEquals 310 stat max assertEquals 465 stat cur
4 209 public void testEffectDownOne stat effect 1 assertEquals 310 stat max assertEquals 206 stat cur
4 209 public void testReset stat effect 6 assertEquals 310 stat max assertEquals 77 stat cur stat reset assertEquals 310 stat max assertEquals 310 stat cur
4 209 public void testResetDoesNotOverrideModify stat effect 6 assertEquals 77 stat cur stat modify 1 0 2 assertEquals 38 stat cur stat reset assertEquals 155 stat cur
4 209 public void testModifyDoesNotOverrideEffect stat effect 6 stat modify 1 0 2 assertEquals 38 stat cur stat modify 1 assertEquals 77 stat cur
4 209 public void testEffectMaximum stat effect 6 assertEquals 310 stat max assertEquals 1240 stat cur stat effect 2 assertEquals 310 stat max assertEquals 1240 stat cur
4 209 public void testEffectMinimum stat effect 6 assertEquals 310 stat max assertEquals 77 stat cur stat effect 2 assertEquals 310 stat max assertEquals 77 stat cur
4 209 public void testMinimumValue stat base 1 stat level 1 stat effect 6 assertEquals 2 stat cur
4 209 public void testModifyAndEffect stat modify 1 0 2 stat effect 2 assertEquals 310 stat cur
4 209 public void testEV assertEquals 310 stat max stat ev 100 stat level 100 assertEquals 100 stat ev assertEquals 335 stat max
4 209 public void testIV stat iv 100 assertEquals 100 stat iv assertEquals 410 stat
4 210 public class PokemonStorageUnitTest extends TestCase
4 210 private static int size 6
4 210 public static PokemonStorageUnit unit
4 210 public void setUp unit new PokemonStorageUnit size
4 210 public void testAdd unit add new Pokemon 1 assertEquals 1 unit size
4 210 public void testRemove Pokemon p new Pokemon 1 unit add p unit remove p assertEquals 0 unit size
4 210 public void testGet Pokemon p new Pokemon 1 unit add p assertEquals p unit get 0
4 210 public void testSwap Pokemon p1 new Pokemon 1 Pokemon p2 new Pokemon 2 unit add p1 unit add p2 unit swap 0 1 assertEquals p1 unit get 1 assertEquals p2 unit get 0
4 210 public void testAddLimit for int i 0 i size 1 i unit add new Pokemon i 1 assertEquals size unit size
4 210 public void testGetBounds try unit get 0 fail catch Exception e assertTrue e instanceof IllegalArgumentException
4 210 public void testSwapMany Pokemon p1 new Pokemon 1 Pokemon p2 new Pokemon 2 Pokemon p3 new Pokemon 3 Pokemon p4 new Pokemon 4 unit add p1 unit add p2 unit add p3 unit add p4 unit swap 0 3 assertEquals p4 unit get 0 assertEquals p2 unit get 1 assertEquals p3 unit get 2 assertEquals p1 unit get 3
4 210 public void testSwapBounds try unit swap 0 1 fail catch Exception e assertTrue e instanceof IllegalArgumentException
4 210 public void testSwapSame Pokemon p1 new Pokemon 1 unit add p1 try unit swap 0 0 fail catch Exception e assertTrue e instanceof IllegalArgumentException
4 210 public void testRemoveNotInPartyException PokemonStorageUnit unit1 new PokemonStorageUnit 6 Pokemon p1 new Pokemon 1 Pokemon p2 new Pokemon 2 unit1 add p1 unit add p2 try unit remove p1 fail catch Exception e assertTrue e instanceof
4 211 public class PlayerTest extends TestCase static int range 25 Player player
4 211 public void setUp player new Player id
4 211 public void testBadge int badge 2 player setBadgeCount badge assertEquals badge player getBadgeCount
4 211 public void testCash int cash 200 player setCash cash assertEquals cash player getCash
4 211 public void testAddUsesStorage int i 1 while player party add new Pokemon i i assertEquals PokemonStorageUnit partysize player party size assertFalse player party add new Pokemon i assertTrue player add new Pokemon i
4 211 public void testAddPokemonUpdatesPokedex int number int Math random range 1 Pokemon p new Pokemon number assertEquals PokedexStatus NONE player pokedex status number player add p assertEquals PokedexStatus OWN player pokedex status
4 212 public class RecordTest extends TestCase
4 212 private Record record
4 212 public void setUp record new Record null
4 212 public void testGetPutEvent assertFalse record getEvent 7 record putEvent 7 assertTrue record getEvent 7
4 212 public void testGetPutTrainer assertFalse record getTrainer foo record putTrainer foo assertTrue record getTrainer foo
4 212 public void testEventBounds try record getEvent 0 fail Out of bounds event catch Exception e assertTrue e instanceof IllegalArgumentException try record putEvent 0 fail Out of bounds event catch Exception e assertTrue e instanceof IllegalArgumentException
4 212 public void testRepeatPutEvent record putEvent 7 try record putEvent 7 fail Duplicate put should fail catch Exception e assertTrue e instanceof IllegalArgumentException
4 212 public void testRepeatPutTrainer record putTrainer gary try record putTrainer gary fail Duplicate put should fail catch Exception e assertTrue e instanceof
